import{e as j,aV as w,bV as I,bW as S,bH as s,aN as B,r as E,aR as H,bX as F,b2 as x,v as M,aQ as V,bY as h,P as A,bZ as T,b_ as P,b$ as W,c0 as q,c1 as z,c2 as G,c3 as Q,a7 as U,G as X}from"#entry";const L=(o="RouteProvider")=>j({name:o,props:{route:{type:Object,required:!0},vnode:Object,vnodeRef:Object,renderKey:String,trackRootNodes:Boolean},setup(n){const a=n.renderKey,r=n.route,t={};for(const i in n.route)Object.defineProperty(t,i,{get:()=>a===n.renderKey?n.route[i]:r[i],enumerable:!0});return w(S,I(t)),()=>n.vnode?s(n.vnode,{ref:n.vnodeRef}):n.vnode}}),Y=L(),O=new WeakMap,ne=j({name:"NuxtPage",inheritAttrs:!1,props:{name:{type:String},transition:{type:[Boolean,Object],default:void 0},keepalive:{type:[Boolean,Object],default:void 0},route:{type:Object},pageKey:{type:[Function,String],default:null}},setup(o,{attrs:n,slots:a,expose:r}){const t=B(),i=E(),d=H(S,null);let b;r({pageRef:i});const l=H(F,null);let u;const m=t.deferHydration();if(t.isHydrating){const e=t.hooks.hookOnce("app:error",m);x().beforeEach(e)}o.pageKey&&M(()=>o.pageKey,(e,y)=>{e!==y&&t.callHook("page:loading:start")});let c=!1;{const e=x().beforeResolve(()=>{c=!1});V(()=>{e()})}return()=>s(G,{name:o.name,route:o.route,...n},{default:e=>{const y=$(d,e.route,e.Component),R=d&&d.matched.length===e.route.matched.length;if(!e.Component){if(u&&!R)return u;m();return}if(u&&l&&!l.isCurrent(e.route))return u;if(y&&d&&(!l||l?.isCurrent(d)))return R?u:null;const f=h(e,o.pageKey),k=D(d,e.route,e.Component);!t.isHydrating&&b===f&&!k&&A(()=>{c=!0,t.callHook("page:loading:end")}),b=f;const g=!!(o.transition??e.route.meta.pageTransition??T),N=g&&Z([o.transition,e.route.meta.pageTransition,T,{onAfterLeave(){delete t._runningTransition,t.callHook("page:transition:finish",e.Component)}}]),_=o.keepalive??e.route.meta.keepalive??P;return u=W(g&&N,q(_,s(z,{suspensible:!0,onPending:()=>{g&&(t._runningTransition=!0),t.callHook("page:start",e.Component)},onResolve:()=>{A(()=>t.callHook("page:finish",e.Component).then(()=>{if(delete t._runningTransition,!c&&!k)return c=!0,t.callHook("page:loading:end")}).finally(m))}},{default:()=>{const C={key:f||void 0,vnode:a.default?J(a.default,e):e.Component,route:e.route,renderKey:f||void 0,trackRootNodes:g,vnodeRef:i};if(!_)return s(Y,C);const p=e.Component.type,K=p;let v=O.get(K);return v||(v=L(p.name||p.__name),O.set(K,v)),s(v,C)}}))).default(),u}})}});function Z(o){const n=[];for(const a of o)a&&n.push({...a,onAfterLeave:a.onAfterLeave?Q(a.onAfterLeave):void 0});return U(...n)}function $(o,n,a){if(!o)return!1;const r=n.matched.findIndex(t=>t.components?.default===a?.type);return!r||r===-1?!1:n.matched.slice(0,r).some((t,i)=>t.components?.default!==o.matched[i]?.components?.default)||a&&h({route:n,Component:a})!==h({route:o,Component:a})}function D(o,n,a){return o?n.matched.findIndex(t=>t.components?.default===a?.type)<n.matched.length-1:!1}function J(o,n){const a=o(n);return a.length===1?s(a[0]):s(X,void 0,a)}export{ne as _};
