import{_ as w}from"./CrUhTerV.js";import{j as b,v as R,q as d,c as y,o as h,a as s,b as l,k as S,M as O,i as n,x as P,w as c,d as u,t as T,l as k,_ as I,m as A,y as F}from"#entry";import{_ as j}from"./CBf3hF8c.js";import{a as q}from"./COW2jRet.js";import"./DGycg10u.js";const B={class:"max-h-screen w-full flex overflow-hidden bg-background text-base"},C={class:"flex-1 flex items-center justify-center"},E={class:"flex flex-col gap-10 box-border px-[10%] pb-[10%] max-w-2xl w-full"},N={class:"mr-auto"},V={class:"flex gap-3"},D={class:"space-y-2"},G={class:"flex gap-1 justify-center"},$={class:"flex-1"},J=b({__name:"forgot-password",setup(L){const i=R(),a=d(!1),r=d(""),m=async()=>{if(a.value)return;if(!r.value){i.add({title:"Email Required",description:"Please enter your email address.",color:"error"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.value)){i.add({title:"Invalid Email",description:"Please enter a valid email address.",color:"error"});return}a.value=!0;try{console.log("[FORGOT PASSWORD] Requesting password reset for:",r.value);const e=await q(r.value);console.log("[FORGOT PASSWORD] Response:",e),i.add({title:e.messageTitle||"Reset Code Sent!",description:e.message||"Please check your email for the reset code.",color:"success"});const o=e.userId;if(!o){console.warn("[FORGOT PASSWORD] No userId returned - email might not exist"),await new Promise(t=>setTimeout(t,1500));return}await new Promise(t=>setTimeout(t,1500)),F(`/reset-password-code?userId=${o}`)}catch(e){console.error("[FORGOT PASSWORD] Error:",e);let o="An unexpected error occurred.",t="Request Failed";e.data?.error?(o=e.data.error,o.includes("Google")&&(t="Cannot Reset Password")):e.message&&(o=e.message),i.add({title:t,description:o,color:"error"})}finally{a.value=!1}};return(f,e)=>{const o=w,t=S,p=j,_=k,x=I,g=A;return h(),y("div",B,[s("div",C,[s("div",E,[s("div",N,[l(o)]),s("div",V,[l(t,{name:"icons:logo",class:"w-12 h-12"}),e[1]||(e[1]=s("h1",{class:"text-5xl font-extrabold"},"Libris",-1))]),e[5]||(e[5]=s("div",{class:"flex flex-col gap-1"},[s("h2",{class:"text-3xl font-bold"},"Find your account"),s("h3",null,"Enter your email address to receive a password reset code.")],-1)),s("form",{onSubmit:O(m,["prevent"]),class:"w-100 flex flex-col gap-5"},[s("div",D,[e[2]||(e[2]=s("label",{for:"email",class:"block text-sm font-medium"}," Email Address ",-1)),l(p,{id:"email",modelValue:n(r),"onUpdate:modelValue":e[0]||(e[0]=v=>P(r)?r.value=v:null),type:"email",placeholder:"your.email@example.com",class:"w-100",disabled:n(a),required:""},null,8,["modelValue","disabled"])]),l(_,{type:"submit",class:"w-100 h-9 cursor-pointer justify-center text-lg font-bold",disabled:n(a),loading:n(a)},{default:c(()=>[u(T(n(a)?"Sending...":"Send Reset Code"),1)]),_:1},8,["disabled","loading"]),s("div",G,[e[4]||(e[4]=s("p",{class:"text-sm"},"Remember your password?",-1)),l(x,{to:"/login",class:"text-sm text-violet-700 dark:text-violet-500 cursor-pointer hover:text-violet-800 dark:hover:text-violet-400 transition-colors"},{default:c(()=>[...e[3]||(e[3]=[u(" Back to Login ",-1)])]),_:1})])],32)])]),s("div",$,[l(g,{src:"/images/authImage1.jpg",class:"w-full h-full object-cover",alt:"Auth image"})])])}}});export{J as default};
