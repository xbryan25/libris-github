import{j as ye,q as S,f as z,C as re,h as y,o as c,i as d,x as ct,w as _,a as r,b as p,B as T,H as ht,e as pt,aT as mt,aQ as ft,g as Me,n as K,l as de,L as fe,r as ce,d as q,t as v,c as L,F as E,J as Y,v as Ve,ai as _e,S as ue,aB as gt,O as A,M as D,aU as bt,aN as Oe,k as Ce,A as be,Q as Ee,az as yt,aA as vt,_ as xt}from"#entry";import{_ as Ue}from"./5MqpBYnd.js";import{_ as kt}from"./58jaPDDO.js";import{_ as Pe}from"./CoCDlcmg.js";import{_ as wt}from"./v6G9p9WY.js";import{_ as Tt}from"./CBf3hF8c.js";import{i as _t,v as Ct,u as Lt,e as St}from"./BCnsrY_Q.js";import{_ as Le}from"./B7NIlbhz.js";import{a as l,L as It}from"./Dn4QYBea.js";import{R as Rt,C as Dt,$ as He,a as $e,b as Te,_ as Ne}from"./Cfw6G_CD.js";import{u as Bt}from"./CJg1BRzH.js";import{u as At}from"./Qdc9UZxI.js";import"./DJUnOCSR.js";import"./DqPfgwhY.js";import"./BX4pJY_y.js";import"./B4JnBqUr.js";import"./BDYeLtO0.js";import"./DNBF-Q6I.js";import"./QkSgYxCE.js";import"./DGycg10u.js";import"./kRIii9yh.js";import"./B8ufzAAH.js";function Q(t,e){return Object.assign(e,t.geocodingQueryParams)}function X(t,e){return Object.assign(e,t.reverseQueryParams)}const Mt=/[&<>"'`]/g,Vt=/[&<>"'`]/,Ot={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};function Et(t){return Ot[t]}function Ut(t){return t==null?"":t?(t=""+t,Vt.test(t)?t.replace(Mt,Et):t):t+""}function M(t,e){const s={Accept:"application/json"},n=new URL(t);return Object.entries(e).forEach(([o,i])=>{(Array.isArray(i)?i:[i]).forEach(u=>{n.searchParams.append(o,u)})}),fetch(n.toString(),{headers:s}).then(o=>o.json())}function Pt(t,e){return t.replace(/\{ *([\w_]+) *\}/g,(s,n)=>{let o=e[n];return o===void 0?o="":typeof o=="function"&&(o=o(e)),Ut(o)})}class Fe{options={serviceUrl:"https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer",apiKey:""};constructor(e){l.Util.setOptions(this,e)}async geocode(e){const s=Q(this.options,{token:this.options.apiKey,SingleLine:e,outFields:"Addr_Type",forStorage:!1,maxLocations:10,f:"json"});return(await M(this.options.serviceUrl+"/findAddressCandidates",s)).candidates.map(n=>{const o=new l.LatLng(n.location.y,n.location.x),i=new l.LatLngBounds(new l.LatLng(n.extent.ymax,n.extent.xmax),new l.LatLng(n.extent.ymin,n.extent.xmin));return{name:n.address,bbox:i,center:o}})}suggest(e){return this.geocode(e)}async reverse(e,s){const n=X(this.options,{location:e.lng+","+e.lat,distance:100,f:"json"}),o=await M(this.options.serviceUrl+"/reverseGeocode",n);if(!o||o.error)return[];const i=new l.LatLng(o.location.y,o.location.x),u=new l.LatLngBounds(i,i);return[{name:o.address.Match_addr,center:i,bbox:u}]}}function Ht(t){return new Fe(t)}class je{options={serviceUrl:"https://dev.virtualearth.net/REST/v1/Locations/"};constructor(e){l.Util.setOptions(this,e)}async geocode(e){const s=Q(this.options,{query:e,key:this.options.apiKey}),n=await M(this.options.serviceUrl,s);return this._parseResults(n)}async reverse(e,s){const n=X(this.options,{key:this.options.apiKey}),o=await M(this.options.serviceUrl+e.lat+","+e.lng,n);return this._parseResults(o)}_parseResults(e){return e.resourceSets[0].resources.map(s=>{const n=s.bbox;return{name:s.name,bbox:new l.LatLngBounds([n[0],n[1]],[n[2],n[3]]),center:new l.LatLng(...s.point.coordinates)}})}}function $t(t){return new je(t)}class Ke{options={apiKey:"",serviceUrl:"https://atlas.microsoft.com/search"};constructor(e){if(l.Util.setOptions(this,e),!this.options.apiKey)throw new Error("Azure Maps Geocoder requires an API key.")}async geocode(e){const s={"api-version":"1.0",query:e,"subscription-key":this.options.apiKey},n=this.options.serviceUrl+"/address/json";return((await M(n,s)).results||[]).map(o=>({name:o.address.freeformAddress,bbox:new l.LatLngBounds([o.viewport.topLeftPoint.lat,o.viewport.topLeftPoint.lon],[o.viewport.btmRightPoint.lat,o.viewport.btmRightPoint.lon]),center:new l.LatLng(o.position.lat,o.position.lon)}))}async reverse(e,s){const n={"api-version":"1.0",query:e.lat+","+e.lng,"subscription-key":this.options.apiKey},o=this.options.serviceUrl+"/address/reverse/json";return((await M(o,n)).addresses||[]).map(i=>({name:i.address.freeformAddress,bbox:new l.LatLngBounds([i.viewport.topLeftPoint.lat,i.viewport.topLeftPoint.lon],[i.viewport.btmRightPoint.lat,i.viewport.btmRightPoint.lon]),center:new l.LatLng(e.lat,e.lng)}))}}function Nt(t){return new Ke(t)}class qe{options={serviceUrl:"https://maps.googleapis.com/maps/api/geocode/json"};constructor(e){l.Util.setOptions(this,e)}async geocode(e){const s=Q(this.options,{key:this.options.apiKey,address:e}),n=await M(this.options.serviceUrl,s);return this._parseResults(n)}async reverse(e,s){const n=X(this.options,{key:this.options.apiKey,latlng:e.lat+","+e.lng}),o=await M(this.options.serviceUrl,n);return this._parseResults(o)}_parseResults(e){return(e.results||[])?.map(s=>{const n=new l.LatLng(s.geometry.location.lat,s.geometry.location.lng),o=new l.LatLngBounds(new l.LatLng(s.geometry.viewport.northeast.lat,s.geometry.viewport.northeast.lng),new l.LatLng(s.geometry.viewport.southwest.lat,s.geometry.viewport.southwest.lng));return{name:s.formatted_address,bbox:o,center:n,properties:s.address_components}})}}function Ft(t){return new qe(t)}class ze{options={serviceUrl:"https://geocoder.api.here.com/6.2/",app_id:"",app_code:"",apiKey:"",maxResults:5};constructor(e){if(l.Util.setOptions(this,e),e?.apiKey)throw Error("apiKey is not supported, use app_id/app_code instead!")}geocode(e){const s=Q(this.options,{searchtext:e,gen:9,app_id:this.options.app_id,app_code:this.options.app_code,jsonattributes:1,maxresults:this.options.maxResults});return this.getJSON(this.options.serviceUrl+"geocode.json",s)}reverse(e,s){let n=e.lat+","+e.lng;this.options.reverseGeocodeProxRadius&&(n+=","+this.options.reverseGeocodeProxRadius);const o=X(this.options,{prox:n,mode:"retrieveAddresses",app_id:this.options.app_id,app_code:this.options.app_code,gen:9,jsonattributes:1,maxresults:this.options.maxResults});return this.getJSON(this.options.serviceUrl+"reversegeocode.json",o)}async getJSON(e,s){return((await M(e,s)).response.view?.[0]?.result||[]).map(n=>{const o=n.location,i=new l.LatLng(o.displayPosition.latitude,o.displayPosition.longitude),u=new l.LatLngBounds(new l.LatLng(o.mapView.topLeft.latitude,o.mapView.topLeft.longitude),new l.LatLng(o.mapView.bottomRight.latitude,o.mapView.bottomRight.longitude));return{name:o.address.label,properties:o.address,bbox:u,center:i}})}}class We{options={serviceUrl:"https://geocode.search.hereapi.com/v1",apiKey:"",app_id:"",app_code:"",maxResults:10};constructor(e){l.Util.setOptions(this,e)}geocode(e){const s=Q(this.options,{q:e,apiKey:this.options.apiKey,limit:this.options.maxResults});if(!s.at&&!s.in)throw Error("at / in parameters not found. Please define coordinates (at=latitude,longitude) or other (in) in your geocodingQueryParams.");return this.getJSON(this.options.serviceUrl+"/discover",s)}reverse(e,s){const n=X(this.options,{at:e.lat+","+e.lng,limit:this.options.reverseGeocodeProxRadius,apiKey:this.options.apiKey});return this.getJSON(this.options.serviceUrl+"/revgeocode",n)}async getJSON(e,s){return((await M(e,s)).items||[]).map(n=>{const o=new l.LatLng(n.position.lat,n.position.lng);let i;return n.mapView?i=new l.LatLngBounds(new l.LatLng(n.mapView.south,n.mapView.west),new l.LatLng(n.mapView.north,n.mapView.east)):i=new l.LatLngBounds(new l.LatLng(n.position.lat,n.position.lng),new l.LatLng(n.position.lat,n.position.lng)),{name:n.address.label,properties:n.address,bbox:i,center:o}})}}function jt(t){return t?.apiKey?new We(t):new ze(t)}function Je(t){let e;if(e=t.match(/^([NS])\s*(\d{1,3}(?:\.\d*)?)\W*([EW])\s*(\d{1,3}(?:\.\d*)?)$/))return new l.LatLng((/N/i.test(e[1])?1:-1)*+e[2],(/E/i.test(e[3])?1:-1)*+e[4]);if(e=t.match(/^(\d{1,3}(?:\.\d*)?)\s*([NS])\W*(\d{1,3}(?:\.\d*)?)\s*([EW])$/))return new l.LatLng((/N/i.test(e[2])?1:-1)*+e[1],(/E/i.test(e[4])?1:-1)*+e[3]);if(e=t.match(/^([NS])\s*(\d{1,3})°?\s*(\d{1,3}(?:\.\d*)?)?['′]?\W*([EW])\s*(\d{1,3})°?\s*(\d{1,3}(?:\.\d*)?)?['′]?$/))return new l.LatLng((/N/i.test(e[1])?1:-1)*(+e[2]+ +e[3]/60),(/E/i.test(e[4])?1:-1)*(+e[5]+ +e[6]/60));if(e=t.match(/^(\d{1,3})°?\s*(\d{1,3}(?:\.\d*)?)?['′]?\s*([NS])\W*(\d{1,3})°?\s*(\d{1,3}(?:\.\d*)?)?['′]?\s*([EW])$/))return new l.LatLng((/N/i.test(e[3])?1:-1)*(+e[1]+ +e[2]/60),(/E/i.test(e[6])?1:-1)*(+e[4]+ +e[5]/60));if(e=t.match(/^([NS])\s*(\d{1,3})°?\s*(\d{1,2})['′]?\s*(\d{1,3}(?:\.\d*)?)?["″]?\W*([EW])\s*(\d{1,3})°?\s*(\d{1,2})['′]?\s*(\d{1,3}(?:\.\d*)?)?["″]?$/))return new l.LatLng((/N/i.test(e[1])?1:-1)*(+e[2]+ +e[3]/60+ +e[4]/3600),(/E/i.test(e[5])?1:-1)*(+e[6]+ +e[7]/60+ +e[8]/3600));if(e=t.match(/^(\d{1,3})°?\s*(\d{1,2})['′]?\s*(\d{1,3}(?:\.\d*)?)?["″]\s*([NS])\W*(\d{1,3})°?\s*(\d{1,2})['′]?\s*(\d{1,3}(?:\.\d*)?)?["″]?\s*([EW])$/))return new l.LatLng((/N/i.test(e[4])?1:-1)*(+e[1]+ +e[2]/60+ +e[3]/3600),(/E/i.test(e[8])?1:-1)*(+e[5]+ +e[6]/60+ +e[7]/3600));if(e=t.match(/^\s*([+-]?\d+(?:\.\d*)?)\s*[\s,]\s*([+-]?\d+(?:\.\d*)?)\s*$/))return new l.LatLng(+e[1],+e[2])}class Ge{options={next:void 0,sizeInMeters:1e4};constructor(e){l.Util.setOptions(this,e)}async geocode(e){const s=Je(e);return s?[{name:e,center:s,bbox:s.toBounds(this.options.sizeInMeters)}]:this.options.next?this.options.next.geocode(e):[]}}function Kt(t){return new Ge(t)}class Ye{options={serviceUrl:"https://api.mapbox.com/geocoding/v5/mapbox.places/"};constructor(e){l.Util.setOptions(this,e)}_getProperties(e){const s={text:e.text,address:e.address};return(e.context||[]).forEach(n=>{const o=n.id.split(".")[0];s[o]=n.text,n.short_code&&(s.countryShortCode=n.short_code)}),s}async geocode(e){const s=this.options.serviceUrl+encodeURIComponent(e)+".json",n=Q(this.options,{access_token:this.options.apiKey});n.proximity!==void 0&&n.proximity.lat!==void 0&&n.proximity.lng!==void 0&&(n.proximity=n.proximity.lng+","+n.proximity.lat);const o=await M(s,n);return this._parseResults(o)}suggest(e){return this.geocode(e)}async reverse(e,s){const n=this.options.serviceUrl+e.lng+","+e.lat+".json",o=X(this.options,{access_token:this.options.apiKey}),i=await M(n,o);return this._parseResults(i)}_parseResults(e){return e.features?.length?e.features.map(s=>{const n=new l.LatLng(...s.center.reverse());let o;return s.bbox?o=new l.LatLngBounds(new l.LatLng(...s.bbox.slice(0,2).reverse()),new l.LatLng(...s.bbox.slice(2,4).reverse())):o=new l.LatLngBounds(n,n),{name:s.place_name,bbox:o,center:n,properties:this._getProperties(s)}}):[]}}function qt(t){return new Ye(t)}class Qe{options={serviceUrl:"https://www.mapquestapi.com/geocoding/v1"};constructor(e){l.Util.setOptions(this,e),this.options.apiKey=decodeURIComponent(this.options.apiKey)}_formatName(...e){return e.filter(s=>!!s).join(", ")}async geocode(e){const s=Q(this.options,{key:this.options.apiKey,location:e,limit:5,outFormat:"json"}),n=await M(this.options.serviceUrl+"/address",s);return this._parseResults(n)}async reverse(e,s){const n=X(this.options,{key:this.options.apiKey,location:e.lat+","+e.lng,outputFormat:"json"}),o=await M(this.options.serviceUrl+"/reverse",n);return this._parseResults(o)}_parseResults(e){return(e.results?.[0]?.locations||[]).map(s=>{const n=new l.LatLng(s.latLng.lat,s.latLng.lng);return{name:this._formatName(s.street,s.adminArea4,s.adminArea3,s.adminArea1),bbox:new l.LatLngBounds(n,n),center:n}})}}function zt(t){return new Qe(t)}class Ze{options={userId:"",apiKey:"",serviceUrl:"https://neutrinoapi.com/"};constructor(e){l.Util.setOptions(this,e)}async geocode(e){const s=Q(this.options,{apiKey:this.options.apiKey,userId:this.options.userId,address:e.split(/\s+/).join(".")}),n=await M(this.options.serviceUrl+"geocode-address",s);if(!n.locations)return[];n.geometry=n.locations[0];const o=new l.LatLng(n.geometry.latitude,n.geometry.longitude),i=new l.LatLngBounds(o,o);return[{name:n.geometry.address,bbox:i,center:o}]}suggest(e){return this.geocode(e)}async reverse(e,s){const n=X(this.options,{apiKey:this.options.apiKey,userId:this.options.userId,latitude:e.lat,longitude:e.lng}),o=await M(this.options.serviceUrl+"geocode-reverse",n);if(o.status.status!==200||!o.found)return[];const i=new l.LatLng(e.lat,e.lng),u=new l.LatLngBounds(i,i);return[{name:o.address,bbox:u,center:i}]}}function Wt(t){return new Ze(t)}class Se{options={serviceUrl:"https://nominatim.openstreetmap.org/",htmlTemplate(e){const s=e.address;let n;const o=[];return(s.road||s.building)&&o.push("{building} {road} {house_number}"),(s.city||s.town||s.village||s.hamlet)&&(n=o.length>0?"leaflet-control-geocoder-address-detail":"",o.push('<span class="'+n+'">{postcode} {city} {town} {village} {hamlet}</span>')),(s.state||s.country)&&(n=o.length>0?"leaflet-control-geocoder-address-context":"",o.push('<span class="'+n+'">{state} {country}</span>')),Pt(o.join("<br/>"),s)}};constructor(e){l.Util.setOptions(this,e||{})}async geocode(e){const s=Q(this.options,{q:e,limit:5,format:"json",addressdetails:1});return(await M(this.options.serviceUrl+"search",s)).map(n=>{const o=n.boundingbox;return{icon:n.icon,name:n.display_name,html:this.options.htmlTemplate?this.options.htmlTemplate(n):void 0,bbox:new l.LatLngBounds([+o[0],+o[2]],[+o[1],+o[3]]),center:new l.LatLng(+n.lat,+n.lon),properties:n}})}async reverse(e,s){const n=X(this.options,{lat:e.lat,lon:e.lng,zoom:Math.round(Math.log(s/256)/Math.log(2)),addressdetails:1,format:"json"}),o=await M(this.options.serviceUrl+"reverse",n);if(!o?.lat||!o?.lon)return[];const i=new l.LatLng(+o.lat,+o.lon),u=new l.LatLngBounds(i,i);return[{name:o.display_name,html:this.options.htmlTemplate?this.options.htmlTemplate(o):void 0,center:i,bbox:u,properties:o}]}}function Jt(t){return new Se(t)}class Xe{options={};constructor(e){l.Util.setOptions(this,e)}async geocode(e){try{const s=this.options.OpenLocationCode.decode(e);return[{name:e,center:new l.LatLng(s.latitudeCenter,s.longitudeCenter),bbox:new l.LatLngBounds(new l.LatLng(s.latitudeLo,s.longitudeLo),new l.LatLng(s.latitudeHi,s.longitudeHi))}]}catch(s){return console.warn(s),[]}}async reverse(e,s){try{return[{name:this.options.OpenLocationCode.encode(e.lat,e.lng,this.options.codeLength),center:new l.LatLng(e.lat,e.lng),bbox:new l.LatLngBounds(new l.LatLng(e.lat,e.lng),new l.LatLng(e.lat,e.lng))}]}catch(n){return console.warn(n),[]}}}function Gt(t){return new Xe(t)}class et{options={serviceUrl:"https://api.opencagedata.com/geocode/v1/json"};constructor(e){l.Util.setOptions(this,e)}async geocode(e){const s=Q(this.options,{key:this.options.apiKey,q:e}),n=await M(this.options.serviceUrl,s);return this._parseResults(n)}suggest(e){return this.geocode(e)}async reverse(e,s){const n=X(this.options,{key:this.options.apiKey,q:[e.lat,e.lng].join(",")}),o=await M(this.options.serviceUrl,n);return this._parseResults(o)}_parseResults(e){return(e.results||[]).map(s=>{const n=new l.LatLng(s.geometry.lat,s.geometry.lng),o=s.annotations&&s.annotations.bounds?new l.LatLngBounds(new l.LatLng(s.annotations.bounds.northeast.lat,s.annotations.bounds.northeast.lng),new l.LatLng(s.annotations.bounds.southwest.lat,s.annotations.bounds.southwest.lng)):new l.LatLngBounds(n,n);return{name:s.formatted,bbox:o,center:n,properties:s}})}}function Yt(t){return new et(t)}class ve{options={serviceUrl:"https://api.geocode.earth/v1"};constructor(e){l.Util.setOptions(this,e)}async geocode(e){const s=Q(this.options,{api_key:this.options.apiKey,text:e}),n=await M(this.options.serviceUrl+"/search",s);return this._parseResults(n)}async suggest(e){const s=Q(this.options,{api_key:this.options.apiKey,text:e}),n=await M(this.options.serviceUrl+"/autocomplete",s);return this._parseResults(n)}async reverse(e,s){const n=X(this.options,{api_key:this.options.apiKey,"point.lat":e.lat,"point.lon":e.lng}),o=await M(this.options.serviceUrl+"/reverse",n);return this._parseResults(o)}_parseResults(e){return(e.features||[]).map(s=>{const n=s.geometry.coordinates,o=new l.LatLng(n[1],n[0]),i=Array.isArray(s.bbox)&&s.bbox.length===4?new l.LatLngBounds([s.bbox[1],s.bbox[0]],[s.bbox[3],s.bbox[2]]):new l.LatLngBounds(o,o);return{name:s.properties.label,center:o,bbox:i,properties:s.properties}})}}function Ie(t){return new ve(t)}const Qt=ve,Zt=Ie,Xt=ve,es=Ie;class tt extends ve{constructor(e){super(Object.assign({serviceUrl:"https://api.openrouteservice.org/geocode"},e))}}function ts(t){return new tt(t)}class st{options={serviceUrl:"https://photon.komoot.io/api/",reverseUrl:"https://photon.komoot.io/reverse/",nameProperties:["name","street","suburb","hamlet","town","city","state","country"]};constructor(e){l.Util.setOptions(this,e)}async geocode(e,s){const n=Q(this.options,{q:e}),o=s?.map?.getCenter?.();o&&(n.lat=o.lat,n.lon=o.lng);const i=s?.map?.getZoom?.();i&&(n.zoom=i);const u=await M(this.options.serviceUrl,n);return this._parseResults(u)}suggest(e){return this.geocode(e)}async reverse(e,s){const n=X(this.options,{lat:e.lat,lon:e.lng}),o=await M(this.options.reverseUrl,n);return this._parseResults(o)}_parseResults(e){return(e.features||[]).map(s=>{const n=s.geometry.coordinates,o=new l.LatLng(n[1],n[0]),i=s.properties?.extent,u=i?new l.LatLngBounds([i[1],i[0]],[i[3],i[2]]):new l.LatLngBounds(o,o);return{name:this._decodeFeatureName(s),html:this.options.htmlTemplate?this.options.htmlTemplate(s):void 0,center:o,bbox:u,properties:s.properties}})}_decodeFeatureName(e){return(this.options.nameProperties||[]).map(s=>e.properties?.[s]).filter(s=>!!s).join(", ")}}function ss(t){return new st(t)}class nt{options={serviceUrl:"https://api.what3words.com/v2/"};constructor(e){l.Util.setOptions(this,e)}async geocode(e){const s=await M(this.options.serviceUrl+"forward",Q(this.options,{key:this.options.apiKey,addr:e.split(/\s+/).join(".")}));if(!s.geometry)return[];const n=new l.LatLng(s.geometry.lat,s.geometry.lng),o=new l.LatLngBounds(n,n);return[{name:s.words,bbox:o,center:n}]}suggest(e){return this.geocode(e)}async reverse(e,s){const n=await M(this.options.serviceUrl+"reverse",X(this.options,{key:this.options.apiKey,coords:[e.lat,e.lng].join(",")}));if(n.status.status!=200)return[];const o=new l.LatLng(n.geometry.lat,n.geometry.lng),i=new l.LatLngBounds(o,o);return[{name:n.words,bbox:i,center:o}]}}function ns(t){return new nt(t)}const is=Object.freeze(Object.defineProperty({__proto__:null,ArcGis:Fe,AzureMaps:Ke,Bing:je,GeocodeEarth:Qt,Google:qe,HERE:ze,HEREv2:We,LatLng:Ge,MapQuest:Qe,Mapbox:Ye,Mapzen:Xt,Neutrino:Ze,Nominatim:Se,OpenCage:et,OpenLocationCode:Xe,Openrouteservice:tt,Pelias:ve,Photon:st,What3Words:nt,arcgis:Ht,azure:Nt,bing:$t,geocodeEarth:Zt,geocodingParams:Q,google:Ft,here:jt,latLng:Kt,mapQuest:zt,mapbox:qt,mapzen:es,neutrino:Wt,nominatim:Jt,openLocationCode:Gt,opencage:Yt,openrouteservice:ts,parseLatLng:Je,pelias:Ie,photon:ss,reverseParams:X,what3words:ns},Symbol.toStringTag,{value:"Module"}));class Re{constructor(...e){}}Object.getOwnPropertyNames(l.Control.prototype).forEach(t=>Re.prototype[t]=l.Control.prototype[t]);Object.getOwnPropertyNames(l.Evented.prototype).forEach(t=>Re.prototype[t]=l.Evented.prototype[t]);class De extends Re{options={showUniqueResult:!0,showResultIcons:!1,collapsed:!0,expand:"touch",position:"topright",placeholder:"Search...",errorMessage:"Nothing found.",iconLabel:"Initiate a new search",query:"",queryMinLength:1,suggestMinLength:3,suggestTimeout:250,defaultMarkGeocode:!0};_alts;_container;_errorElement;_geocodeMarker;_input;_lastGeocode;_map;_preventBlurCollapse;_requestCount=0;_results;_selection;_suggestTimeout;constructor(e){super(e),l.Util.setOptions(this,e),this.options.geocoder||(this.options.geocoder=new Se)}addThrobberClass(){this._container.classList.add("leaflet-control-geocoder-throbber")}removeThrobberClass(){this._container.classList.remove("leaflet-control-geocoder-throbber")}onAdd(e){const s="leaflet-control-geocoder",n=l.DomUtil.create("div",s+" leaflet-bar"),o=l.DomUtil.create("button",s+"-icon",n),i=l.DomUtil.create("div",s+"-form",n);this._map=e,this._container=n,o.innerHTML="&nbsp;",o.type="button",o.setAttribute("aria-label",this.options.iconLabel);const u=this._input=l.DomUtil.create("input","",i);return u.type="search",u.value=this.options.query,u.placeholder=this.options.placeholder,l.DomEvent.disableClickPropagation(u),this._errorElement=l.DomUtil.create("div",s+"-form-no-error",n),this._errorElement.innerHTML=this.options.errorMessage,this._alts=l.DomUtil.create("ul",s+"-alternatives leaflet-control-geocoder-alternatives-minimized",n),l.DomEvent.disableClickPropagation(this._alts),l.DomEvent.on(u,"keydown",this._keydown,this),this.options.geocoder?.suggest&&l.DomEvent.on(u,"input",this._change,this),l.DomEvent.on(u,"blur",()=>{this.options.collapsed&&!this._preventBlurCollapse&&this._collapse(),this._preventBlurCollapse=!1}),this.options.collapsed?this.options.expand==="click"?l.DomEvent.on(n,"click",a=>{a.button===0&&a.detail!==2&&this._toggle()}):this.options.expand==="touch"?l.DomEvent.on(n,l.Browser.touch?"touchstart mousedown":"mousedown",a=>{this._toggle(),a.preventDefault(),a.stopPropagation()},this):(l.DomEvent.on(n,"mouseover",this._expand,this),l.DomEvent.on(n,"mouseout",this._collapse,this),this._map.on("movestart",this._collapse,this)):(this._expand(),l.Browser.touch?l.DomEvent.on(n,"touchstart",()=>this._geocode()):l.DomEvent.on(n,"click",()=>this._geocode())),this.options.defaultMarkGeocode&&this.on("markgeocode",this.markGeocode,this),this.on("startgeocode",this.addThrobberClass,this),this.on("finishgeocode",this.removeThrobberClass,this),this.on("startsuggest",this.addThrobberClass,this),this.on("finishsuggest",this.removeThrobberClass,this),l.DomEvent.disableClickPropagation(n),n}setQuery(e){return this._input.value=e,this}_geocodeResult(e,s){!s&&this.options.showUniqueResult&&e.length===1?this._geocodeResultSelected(e[0]):e.length>0?(this._alts.innerHTML="",this._results=e,this._alts.classList.remove("leaflet-control-geocoder-alternatives-minimized"),this._container.classList.add("leaflet-control-geocoder-options-open"),this._results.forEach((n,o)=>this._alts.appendChild(this._createAlt(n,o)))):(this._container.classList.add("leaflet-control-geocoder-options-error"),this._errorElement.classList.add("leaflet-control-geocoder-error"))}markGeocode(e){const s=e.geocode;return this._map.fitBounds(s.bbox),this._geocodeMarker&&this._map.removeLayer(this._geocodeMarker),this._geocodeMarker=new l.Marker(s.center).bindPopup(s.html||s.name).addTo(this._map).openPopup(),this}async _geocode(e=!1){const s=this._input.value;if(!e&&s.length<this.options.queryMinLength)return;const n=++this._requestCount;this._lastGeocode=s,e||this._clearResults();const o={input:s};this.fire(e?"startsuggest":"startgeocode",o);const i={map:this._map},u=e?await this.options.geocoder.suggest(s,i):await this.options.geocoder.geocode(s,i);if(n===this._requestCount){const a={input:s,results:u};this.fire(e?"finishsuggest":"finishgeocode",a),this._geocodeResult(u,e)}}_geocodeResultSelected(e){const s={geocode:e};this.fire("markgeocode",s)}_toggle(){this._container.classList.contains("leaflet-control-geocoder-expanded")?this._collapse():this._expand()}_expand(){this._container.classList.add("leaflet-control-geocoder-expanded"),this._input.select(),this.fire("expand")}_collapse(){this._container.classList.remove("leaflet-control-geocoder-expanded"),this._alts.classList.add("leaflet-control-geocoder-alternatives-minimized"),this._errorElement.classList.remove("leaflet-control-geocoder-error"),this._container.classList.remove("leaflet-control-geocoder-options-open"),this._container.classList.remove("leaflet-control-geocoder-options-error"),this._input.blur(),this.fire("collapse")}_clearResults(){this._alts.classList.add("leaflet-control-geocoder-alternatives-minimized"),this._selection=null,this._errorElement.classList.remove("leaflet-control-geocoder-error"),this._container.classList.remove("leaflet-control-geocoder-options-open"),this._container.classList.remove("leaflet-control-geocoder-options-error")}_createAlt(e,s){const n=l.DomUtil.create("li",""),o=l.DomUtil.create("a","",n),i=this.options.showResultIcons&&e.icon?l.DomUtil.create("img","",o):null,u=e.html?void 0:document.createTextNode(e.name),a=m=>{this._preventBlurCollapse=!0,l.DomEvent.stop(m),this._geocodeResultSelected(e),l.DomEvent.on(n,"click touchend",()=>{this.options.collapsed?this._collapse():this._clearResults()})};return i&&(i.src=e.icon),n.setAttribute("data-result-index",String(s)),e.html?o.innerHTML=o.innerHTML+e.html:u&&o.appendChild(u),l.DomEvent.on(n,"mousedown touchstart",a,this),n}_keydown(e){const s=n=>{this._selection&&(this._selection.classList.remove("leaflet-control-geocoder-selected"),this._selection=this._selection[n>0?"nextSibling":"previousSibling"]),this._selection||(this._selection=this._alts[n>0?"firstChild":"lastChild"]),this._selection&&this._selection.classList.add("leaflet-control-geocoder-selected")};switch(e.key){case"Escape":this.options.collapsed?this._collapse():this._clearResults();break;case"ArrowUp":s(-1);break;case"ArrowDown":s(1);break;case"Enter":if(this._selection){const n=parseInt(this._selection.getAttribute("data-result-index"),10);this._geocodeResultSelected(this._results[n]),this._clearResults()}else this._geocode();break;default:return}l.DomEvent.preventDefault(e)}_change(){const e=this._input.value;e!==this._lastGeocode&&(clearTimeout(this._suggestTimeout),e.length>=this.options.suggestMinLength?this._suggestTimeout=setTimeout(()=>this._geocode(!0),this.options.suggestTimeout):this._clearResults())}}function os(t){return new De(t)}Object.assign(De,is);Object.assign(l.Control,{Geocoder:De,geocoder:os});const as={class:"flex"},rs=ye({__name:"ViewMapForTransaction",props:{isOpenViewMapForTransaction:{type:Boolean},removeMapMarker:{}},emits:["update:openViewMapForTransaction","update:selectedAddress","update:latitudeAndLongitude"],setup(t,{emit:e}){const s=S(null),n=S(null),o=S(""),i=t,u=e,a=async b=>{s.value=b.latlng.lat,n.value=b.latlng.lng;const I=await $fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s.value}&lon=${n.value}`);o.value=I.display_name,u("update:selectedAddress",o.value),u("update:latitudeAndLongitude",s.value,n.value),u("update:openViewMapForTransaction",!1)},m=z({get:()=>i.isOpenViewMapForTransaction,set:b=>{u("update:openViewMapForTransaction",b)}});function h(b){It.Control.geocoder({placeholder:"Search location...",defaultMarkGeocode:!1}).addTo(b).on("markgeocode",async V=>{const R=V.geocode.center;s.value=R.lat,n.value=R.lng;const P=await $fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s.value}&lon=${n.value}`);o.value=P.display_name,b.setView(R,b.getZoom()),u("update:selectedAddress",o.value),u("update:latitudeAndLongitude",s.value,n.value),u("update:openViewMapForTransaction",!1)})}return re(()=>i.removeMapMarker,()=>{s.value=null,n.value=null}),(b,I)=>{const V=Ct,R=Lt,P=St,B=_t,O=Le;return c(),y(O,{open:d(m),"onUpdate:open":I[0]||(I[0]=k=>ct(m)?m.value=k:null),ui:{content:"max-w-[90vw]"}},{content:_(()=>[r("div",as,[p(B,{ref:"map",zoom:12,center:[d(s)?d(s):14.599512,d(n)?d(n):120.984222],"use-global-leaflet":!1,style:{height:"90vh"},onClick:a,onReady:h},{default:_(()=>[p(V,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',"layer-type":"base",name:"OpenStreetMap"}),d(s)!==null&&d(n)!==null?(c(),y(R,{key:0,"lat-lng":[d(s),d(n)]},null,8,["lat-lng"])):T("",!0),p(P,{position:"bottomright",imperial:!1,metric:!0})]),_:1},8,["center"])])]),_:1},8,["open"])}}}),it=Object.assign(rs,{__name:"ViewMapForTransaction"}),ls={slots:{root:"",header:"flex items-center justify-between",body:"flex flex-col space-y-4 pt-4 sm:flex-row sm:space-x-4 sm:space-y-0",heading:"text-center font-medium truncate mx-auto",grid:"w-full border-collapse select-none space-y-1 focus:outline-none",gridRow:"grid grid-cols-7 place-items-center",gridWeekDaysRow:"mb-1 grid w-full grid-cols-7",gridBody:"grid",headCell:"rounded-md",cell:"relative text-center",cellTrigger:["m-0.5 relative flex items-center justify-center rounded-full whitespace-nowrap focus-visible:ring-2 focus:outline-none data-disabled:text-muted data-unavailable:line-through data-unavailable:text-muted data-unavailable:pointer-events-none data-[selected]:text-inverted data-today:font-semibold data-[outside-view]:text-muted","transition"]},variants:{color:{primary:{headCell:"text-primary",cellTrigger:"focus-visible:ring-primary data-[selected]:bg-primary data-today:not-data-[selected]:text-primary data-[highlighted]:bg-primary/20 hover:not-data-[selected]:bg-primary/20"},secondary:{headCell:"text-secondary",cellTrigger:"focus-visible:ring-secondary data-[selected]:bg-secondary data-today:not-data-[selected]:text-secondary data-[highlighted]:bg-secondary/20 hover:not-data-[selected]:bg-secondary/20"},success:{headCell:"text-success",cellTrigger:"focus-visible:ring-success data-[selected]:bg-success data-today:not-data-[selected]:text-success data-[highlighted]:bg-success/20 hover:not-data-[selected]:bg-success/20"},info:{headCell:"text-info",cellTrigger:"focus-visible:ring-info data-[selected]:bg-info data-today:not-data-[selected]:text-info data-[highlighted]:bg-info/20 hover:not-data-[selected]:bg-info/20"},warning:{headCell:"text-warning",cellTrigger:"focus-visible:ring-warning data-[selected]:bg-warning data-today:not-data-[selected]:text-warning data-[highlighted]:bg-warning/20 hover:not-data-[selected]:bg-warning/20"},error:{headCell:"text-error",cellTrigger:"focus-visible:ring-error data-[selected]:bg-error data-today:not-data-[selected]:text-error data-[highlighted]:bg-error/20 hover:not-data-[selected]:bg-error/20"},neutral:{headCell:"text-highlighted",cellTrigger:"focus-visible:ring-inverted data-[selected]:bg-inverted data-today:not-data-[selected]:text-highlighted data-[highlighted]:bg-inverted/20 hover:not-data-[selected]:bg-inverted/10"}},size:{xs:{heading:"text-xs",cell:"text-xs",headCell:"text-[10px]",cellTrigger:"size-7",body:"space-y-2 pt-2"},sm:{heading:"text-xs",headCell:"text-xs",cell:"text-xs",cellTrigger:"size-7"},md:{heading:"text-sm",headCell:"text-xs",cell:"text-sm",cellTrigger:"size-8"},lg:{heading:"text-md",headCell:"text-md",cellTrigger:"size-9 text-md"},xl:{heading:"text-lg",headCell:"text-lg",cellTrigger:"size-10 text-lg"}}},defaultVariants:{size:"md",color:"primary"}},ot={__name:"UCalendar",props:{as:{type:null,required:!1},nextYearIcon:{type:[String,Object],required:!1},nextYear:{type:Object,required:!1},nextMonthIcon:{type:[String,Object],required:!1},nextMonth:{type:Object,required:!1},prevYearIcon:{type:[String,Object],required:!1},prevYear:{type:Object,required:!1},prevMonthIcon:{type:[String,Object],required:!1},prevMonth:{type:Object,required:!1},color:{type:null,required:!1},size:{type:null,required:!1},range:{type:Boolean,required:!1},multiple:{type:Boolean,required:!1},monthControls:{type:Boolean,required:!1,default:!0},yearControls:{type:Boolean,required:!1,default:!0},defaultValue:{type:null,required:!1},modelValue:{type:null,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1},defaultPlaceholder:{type:null,required:!1},placeholder:{type:null,required:!1},allowNonContiguousRanges:{type:Boolean,required:!1},pagedNavigation:{type:Boolean,required:!1},preventDeselect:{type:Boolean,required:!1},maximumDays:{type:Number,required:!1},weekStartsOn:{type:Number,required:!1},weekdayFormat:{type:String,required:!1},fixedWeeks:{type:Boolean,required:!1,default:!0},maxValue:{type:null,required:!1},minValue:{type:null,required:!1},numberOfMonths:{type:Number,required:!1},disabled:{type:Boolean,required:!1},readonly:{type:Boolean,required:!1},initialFocus:{type:Boolean,required:!1},isDateDisabled:{type:Function,required:!1},isDateUnavailable:{type:Function,required:!1},isDateHighlightable:{type:Function,required:!1},nextPage:{type:Function,required:!1},prevPage:{type:Function,required:!1},disableDaysOutsideCurrentView:{type:Boolean,required:!1},fixedDate:{type:String,required:!1}},emits:["update:modelValue","update:placeholder","update:validModelValue","update:startValue"],setup(t,{emit:e}){const s=t,n=e,{code:o,dir:i,t:u}=ht(),a=pt(),m=mt(ft(s,"range","modelValue","defaultValue","color","size","monthControls","yearControls","class","ui"),n),h=z(()=>s.nextYearIcon||(i.value==="rtl"?a.ui.icons.chevronDoubleLeft:a.ui.icons.chevronDoubleRight)),b=z(()=>s.nextMonthIcon||(i.value==="rtl"?a.ui.icons.chevronLeft:a.ui.icons.chevronRight)),I=z(()=>s.prevYearIcon||(i.value==="rtl"?a.ui.icons.chevronDoubleRight:a.ui.icons.chevronDoubleLeft)),V=z(()=>s.prevMonthIcon||(i.value==="rtl"?a.ui.icons.chevronRight:a.ui.icons.chevronLeft)),R=z(()=>Me({extend:Me(ls),...a.ui?.calendar||{}})({color:s.color,size:s.size}));function P(O,k){return k===-1?O.subtract({years:1}):O.add({years:1})}const B=z(()=>s.range?Rt:Dt);return(O,k)=>(c(),y(d(B).Root,fe(d(m),{"model-value":t.modelValue,"default-value":t.defaultValue,locale:d(o),dir:d(i),class:R.value.root({class:[s.ui?.root,s.class]})}),{default:_(({weekDays:ee,grid:H})=>[p(d(B).Header,{class:K(R.value.header({class:s.ui?.header}))},{default:_(()=>[s.yearControls?(c(),y(d(B).Prev,{key:0,"prev-page":U=>P(U,-1),"aria-label":d(u)("calendar.prevYear"),"as-child":""},{default:_(()=>[p(de,fe({icon:I.value,size:s.size,color:"neutral",variant:"ghost"},s.prevYear),null,16,["icon","size"])]),_:1},8,["prev-page","aria-label"])):T("",!0),s.monthControls?(c(),y(d(B).Prev,{key:1,"aria-label":d(u)("calendar.prevMonth"),"as-child":""},{default:_(()=>[p(de,fe({icon:V.value,size:s.size,color:"neutral",variant:"ghost"},s.prevMonth),null,16,["icon","size"])]),_:1},8,["aria-label"])):T("",!0),p(d(B).Heading,{class:K(R.value.heading({class:s.ui?.heading}))},{default:_(({headingValue:U})=>[ce(O.$slots,"heading",{value:U},()=>[q(v(U),1)])]),_:3},8,["class"]),s.monthControls?(c(),y(d(B).Next,{key:2,"aria-label":d(u)("calendar.nextMonth"),"as-child":""},{default:_(()=>[p(de,fe({icon:b.value,size:s.size,color:"neutral",variant:"ghost"},s.nextMonth),null,16,["icon","size"])]),_:1},8,["aria-label"])):T("",!0),s.yearControls?(c(),y(d(B).Next,{key:3,"next-page":U=>P(U,1),"aria-label":d(u)("calendar.nextYear"),"as-child":""},{default:_(()=>[p(de,fe({icon:h.value,size:s.size,color:"neutral",variant:"ghost"},s.nextYear),null,16,["icon","size"])]),_:1},8,["next-page","aria-label"])):T("",!0)]),_:3},8,["class"]),r("div",{class:K(R.value.body({class:s.ui?.body}))},[(c(!0),L(E,null,Y(H,U=>(c(),y(d(B).Grid,{key:U.value.toString(),class:K(R.value.grid({class:s.ui?.grid}))},{default:_(()=>[p(d(B).GridHead,null,{default:_(()=>[p(d(B).GridRow,{class:K(R.value.gridWeekDaysRow({class:s.ui?.gridWeekDaysRow}))},{default:_(()=>[(c(!0),L(E,null,Y(ee,W=>(c(),y(d(B).HeadCell,{key:W,class:K(R.value.headCell({class:s.ui?.headCell}))},{default:_(()=>[ce(O.$slots,"week-day",{day:W},()=>[q(v(W),1)])]),_:2},1032,["class"]))),128))]),_:2},1032,["class"])]),_:2},1024),p(d(B).GridBody,{class:K(R.value.gridBody({class:s.ui?.gridBody}))},{default:_(()=>[(c(!0),L(E,null,Y(U.rows,(W,se)=>(c(),y(d(B).GridRow,{key:`weekDate-${se}`,class:K(R.value.gridRow({class:s.ui?.gridRow}))},{default:_(()=>[(c(!0),L(E,null,Y(W,N=>(c(),y(d(B).Cell,{key:N.toString(),date:N,class:K(R.value.cell({class:s.ui?.cell}))},{default:_(()=>[p(d(B).CellTrigger,{day:N,month:U.value,class:K(R.value.cellTrigger({class:s.ui?.cellTrigger}))},{default:_(()=>[ce(O.$slots,"day",{day:N},()=>[q(v(N.day),1)])]),_:2},1032,["day","month","class"])]),_:2},1032,["date","class"]))),128))]),_:2},1032,["class"]))),128))]),_:2},1032,["class"])]),_:2},1032,["class"]))),128))],2)]),_:3},16,["model-value","default-value","locale","dir","class"]))}},ke="http://127.0.0.1:8080",Be=()=>{const t=S(!1),e=S(!1),s=S(null),n=Ve(),{$apiFetch:o}=_e();return{loading:e,error:s,createRental:async a=>{e.value=!0,s.value=null;try{await o(`${ke}/api/wallets/update-reserved-amount`,{method:"PATCH",body:{amount_to_reserve:a.totalRentCost},credentials:"include"});const m=await o(`${ke}/api/rentals/create`,{method:"POST",body:a,credentials:"include"});return n.add({title:"Success",description:"Rental request sent successfully",color:"success"}),m}catch(m){throw s.value=m?.data?.message||m?.data?.error||m?.message||"Failed to process rental",n.add({title:"Error",description:s.value??"Failed to process rental",color:"error"}),m}finally{e.value=!1}},checkRentalExists:async a=>{try{const m=await o(`${ke}/api/rentals/check/${a}`,{method:"GET",credentials:"include"});t.value=m.exists}catch(m){console.error(m)}},rentalExists:t}},ae={HOUR_TOKENS:["HH","H","hh","h","kk","k"],MINUTE_TOKENS:["mm","m"],SECOND_TOKENS:["ss","s"],APM_TOKENS:["A","a"],BASIC_TYPES:["hour","minute","second","apm"]},ge={format:"HH:mm",minuteInterval:1,secondInterval:1,hourRange:null,minuteRange:null,secondRange:null,hideDisabledHours:!1,hideDisabledMinutes:!1,hideDisabledSeconds:!1,hideDisabledItems:!1,advancedKeyboard:!1,hideDropdown:!1,blurDelay:300,manualInputTimeout:1e3,dropOffsetHeight:160};var he={name:"VueTimepicker",props:{modelValue:{type:[Object,String]},format:{type:String},minuteInterval:{type:[Number,String]},secondInterval:{type:[Number,String]},hourRange:{type:Array},minuteRange:{type:Array},secondRange:{type:Array},hideDisabledHours:{type:Boolean,default:!1},hideDisabledMinutes:{type:Boolean,default:!1},hideDisabledSeconds:{type:Boolean,default:!1},hideDisabledItems:{type:Boolean,default:!1},hideClearButton:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},closeOnComplete:{type:Boolean,default:!1},id:{type:String},name:{type:String},inputClass:{type:[String,Object,Array]},placeholder:{type:String},tabindex:{type:[Number,String],default:0},inputWidth:{type:String},autocomplete:{type:String,default:"off"},hourLabel:{type:String},minuteLabel:{type:String},secondLabel:{type:String},apmLabel:{type:String},amText:{type:String},pmText:{type:String},blurDelay:{type:[Number,String]},advancedKeyboard:{type:Boolean,default:!1},lazy:{type:Boolean,default:!1},autoScroll:{type:Boolean,default:!1},dropDirection:{type:String,default:"down"},dropOffsetHeight:{type:[Number,String]},containerId:{type:String},manualInput:{type:Boolean,default:!1},manualInputTimeout:{type:[Number,String]},hideDropdown:{type:Boolean,default:!1},fixedDropdownButton:{type:Boolean,default:!1},debugMode:{type:Boolean,default:!1}},data(){return{timeValue:{},hours:[],minutes:[],seconds:[],apms:[],isActive:!1,showDropdown:!1,isFocusing:!1,debounceTimer:void 0,hourType:"HH",minuteType:"mm",secondType:"",apmType:"",hour:"",minute:"",second:"",apm:"",fullValues:void 0,bakDisplayTime:void 0,doClearApmChecking:!1,selectionTimer:void 0,kbInputTimer:void 0,kbInputLog:"",bakCurrentPos:void 0,forceDropOnTop:!1}},emits:["update:modelValue","change","open","close","focus","blur","error"],computed:{opts(){const t=Object.assign({},ge);return this.format&&this.format.length&&(t.format=String(this.format)),this.isNumber(this.minuteInterval)&&(t.minuteInterval=+this.minuteInterval),(!t.minuteInterval||t.minuteInterval<1||t.minuteInterval>60)&&(this.debugMode&&(t.minuteInterval>60?this.debugLog(`"minute-interval" should be less than 60. Current value is ${this.minuteInterval}`):(t.minuteInterval===0||t.minuteInterval<1)&&this.debugLog(`"minute-interval" should be NO less than 1. Current value is ${this.minuteInterval}`)),t.minuteInterval===0?t.minuteInterval=60:t.minuteInterval=1),this.isNumber(this.secondInterval)&&(t.secondInterval=+this.secondInterval),(!t.secondInterval||t.secondInterval<1||t.secondInterval>60)&&(this.debugMode&&(t.secondInterval>60?this.debugLog(`"second-interval" should be less than 60. Current value is ${this.secondInterval}`):(t.secondInterval===0||t.secondInterval<1)&&this.debugLog(`"second-interval" should be NO less than 1. Current value is ${this.secondInterval}`)),t.secondInterval===0?t.secondInterval=60:t.secondInterval=1),this.hourRange&&Array.isArray(this.hourRange)&&(t.hourRange=JSON.parse(JSON.stringify(this.hourRange)),!this.hourRange.length&&this.debugMode&&this.debugLog('The "hour-range" array is empty (length === 0)')),this.minuteRange&&Array.isArray(this.minuteRange)&&(t.minuteRange=JSON.parse(JSON.stringify(this.minuteRange)),!this.minuteRange.length&&this.debugMode&&this.debugLog('The "minute-range" array is empty (length === 0)')),this.secondRange&&Array.isArray(this.secondRange)&&(t.secondRange=JSON.parse(JSON.stringify(this.secondRange)),!this.secondRange.length&&this.debugMode&&this.debugLog('The "second-range" array is empty (length === 0)')),this.hideDisabledItems&&(t.hideDisabledItems=!0),(this.hideDisabledHours||this.hideDisabledItems)&&(t.hideDisabledHours=!0),(this.hideDisabledMinutes||this.hideDisabledItems)&&(t.hideDisabledMinutes=!0),(this.hideDisabledSeconds||this.hideDisabledItems)&&(t.hideDisabledSeconds=!0),this.hideDropdown&&(this.manualInput?t.hideDropdown=!0:this.debugMode&&this.debugLog('"hide-dropdown" only works with "manual-input" mode')),this.blurDelay&&+this.blurDelay>0&&(t.blurDelay=+this.blurDelay),this.manualInputTimeout&&+this.manualInputTimeout>0&&(t.manualInputTimeout=+this.manualInputTimeout),this.dropOffsetHeight&&+this.dropOffsetHeight>0&&(t.dropOffsetHeight=+this.dropOffsetHeight),t},useStringValue(){return typeof this.modelValue=="string"},formatString(){return this.opts.format||ge.format},inUse(){const t=ae.BASIC_TYPES.filter(s=>this.getTokenByType(s));t.sort((s,n)=>this.formatString.indexOf(this.getTokenByType(s)||null)-this.formatString.indexOf(this.getTokenByType(n)||null));const e=t.map(s=>this.getTokenByType(s));return{hour:!!this.hourType,minute:!!this.minuteType,second:!!this.secondType,apm:!!this.apmType,types:t||[],tokens:e||[]}},displayTime(){let t=String(this.formatString);return this.hour&&(t=t.replace(new RegExp(this.hourType,"g"),this.hour)),this.minute&&(t=t.replace(new RegExp(this.minuteType,"g"),this.minute)),this.second&&this.secondType&&(t=t.replace(new RegExp(this.secondType,"g"),this.second)),this.apm&&this.apmType&&(t=t.replace(new RegExp(this.apmType,"g"),this.apm)),t},customDisplayTime(){return!this.amText&&!this.pmText?this.displayTime:this.displayTime.replace(new RegExp(this.apm,"g"),this.apmDisplayText(this.apm))},inputIsEmpty(){return this.formatString===this.displayTime},allValueSelected(){return!(this.inUse.hour&&!this.hour||this.inUse.minute&&!this.minute||this.inUse.second&&!this.second||this.inUse.apm&&!this.apm)},columnsSequence(){return this.inUse.types.map(t=>t)||[]},showClearBtn(){return this.hideClearButton||this.disabled?!1:!this.inputIsEmpty},showDropdownBtn(){return!!(this.fixedDropdownButton||this.opts.hideDropdown&&this.isActive&&!this.showDropdown)},baseOn12Hours(){return this.hourType==="h"||this.hourType==="hh"},hourRangeIn24HrFormat(){if(!this.hourType||!this.opts.hourRange)return!1;if(!this.opts.hourRange.length)return[];const t=[];return this.opts.hourRange.forEach(e=>{if(e instanceof Array){e.length>2&&this.debugMode&&this.debugLog(`Nested array within "hour-range" must contain no more than two items. Only the first two items of ${JSON.stringify(e)} will be taken into account.`);let s=e[0],n=e[1]||e[0];this.is12hRange(s)&&(s=this.translate12hRange(s)),this.is12hRange(n)&&(n=this.translate12hRange(n));for(let o=+s;o<=+n;o++)o<0||o>24||t.includes(o)||t.push(o)}else{if(this.is12hRange(e)?e=this.translate12hRange(e):e=+e,e<0||e>24)return;t.includes(e)||t.push(e)}}),t.sort((e,s)=>e-s),t},restrictedHourRange(){return this.hourRangeIn24HrFormat?this.baseOn12Hours?this.hourRangeIn24HrFormat.map(e=>e===12?"12p":e===24||e===0?"12a":e>12?`${e%12}p`:`${e}a`):this.hourRangeIn24HrFormat:!1},validHoursList(){if(!this.manualInput)return!1;if(this.restrictedHourRange){let t=[];if(this.baseOn12Hours){t=this.restrictedHourRange.map(s=>{const n=s.substr(0,s.length-1),o=s.substr(-1);return`${this.formatValue(this.hourType,n)}${o}`});const e=t.indexOf("12a");return e>0&&t.unshift(t.splice(e,1)[0]),t}return t=this.restrictedHourRange.map(e=>this.formatValue(this.hourType,e)),t.length>1&&t[0]&&t[0]==="24"&&t.push(t.shift()),t}return this.baseOn12Hours?[].concat([],this.hours.map(t=>`${t}a`),this.hours.map(t=>`${t}p`)):this.hours},has(){const t={customApmText:!1},e=!!this.apmType;if(e&&this.hourRangeIn24HrFormat&&this.hourRangeIn24HrFormat.length){const s=[].concat([],this.hourRangeIn24HrFormat);t.am=s.some(n=>n<12||n===24),t.pm=s.some(n=>n>=12&&n<24)}else t.am=e,t.pm=e;return(this.amText&&this.amText.length||this.pmText&&this.pmText.length)&&(t.customApmText=!0),t},minuteRangeList(){return!this.minuteType||!this.opts.minuteRange?!1:this.opts.minuteRange.length?this.renderRangeList(this.opts.minuteRange,"minute"):[]},secondRangeList(){return!this.secondType||!this.opts.secondRange?!1:this.opts.secondRange.length?this.renderRangeList(this.opts.secondRange,"second"):[]},hourLabelText(){return this.hourLabel||this.hourType},minuteLabelText(){return this.minuteLabel||this.minuteType},secondLabelText(){return this.secondLabel||this.secondType},apmLabelText(){return this.apmLabel||this.apmType},inputWidthStyle(){if(!(!this.inputWidth||!this.inputWidth.length))return{width:this.inputWidth}},tokenRegexBase(){return this.inUse.tokens.join("|")},tokenChunks(){if(!this.manualInput&&!this.useStringValue)return!1;const t=String(this.formatString),e=`(${this.tokenRegexBase})+?`,s=this.getMatchAllByRegex(t,e),n=[];for(let o of s){const i=o[0],u={index:o.index,token:i,type:this.getTokenType(i),needsCalibrate:i.length<2,len:(i||"").length};n.push(u)}return n},needsPosCalibrate(){return this.manualInput?this.tokenChunks.some(t=>t.needsCalibrate):!1},tokenChunksPos(){if(!this.manualInput)return!1;if(!this.needsPosCalibrate)return this.tokenChunks.map(s=>({token:s.token,type:s.type,start:s.index,end:s.index+s.len}));const t=[];let e=0;return this.tokenChunks.forEach(s=>{let n;if(s.type==="apm"&&this.has.customApmText)if(this.apm&&this.apm.length){const o=this.apm.toLowerCase()==="am"?this.amText:this.pmText;n=o&&o.length?o.length:s.len}else n=s.len;else n=this[s.type]&&this[s.type].length?this[s.type].length:s.len;t.push({token:s.token,type:s.type,start:s.index+e,end:s.index+e+n}),s.needsCalibrate&&n>s.len&&(e+=n-s.len)}),t},invalidValues(){if(this.inputIsEmpty)return[];if(!this.restrictedHourRange&&!this.minuteRangeList&&!this.secondRangeList&&this.opts.minuteInterval===1&&this.opts.secondInterval===1)return[];const t=[];return this.inUse.hour&&!this.isEmptyValue(this.hourType,this.hour)&&(!this.isValidValue(this.hourType,this.hour)||this.isDisabled("hour",this.hour))&&t.push("hour"),this.inUse.minute&&!this.isEmptyValue(this.minuteType,this.minute)&&(!this.isValidValue(this.minuteType,this.minute)||this.isDisabled("minute",this.minute)||this.notInInterval("minute",this.minute))&&t.push("minute"),this.inUse.second&&!this.isEmptyValue(this.secondType,this.second)&&(!this.isValidValue(this.secondType,this.second)||this.isDisabled("second",this.second)||this.notInInterval("second",this.second))&&t.push("second"),this.inUse.apm&&!this.isEmptyValue(this.apmType,this.apm)&&(!this.isValidValue(this.apmType,this.apm)||this.isDisabled("apm",this.apm))&&t.push("apm"),t.length?t:[]},hasInvalidInput(){return!!(this.invalidValues&&this.invalidValues.length)},autoDirectionEnabled(){return this.dropDirection==="auto"},dropdownDirClass(){return this.autoDirectionEnabled?this.forceDropOnTop?"drop-up":"drop-down":this.dropDirection==="up"?"drop-up":"drop-down"}},watch:{"opts.format"(t){this.renderFormat(t)},"opts.minuteInterval"(t){this.renderList("minute",t)},"opts.secondInterval"(t){this.renderList("second",t)},value:{deep:!0,handler(){this.readValues()}},displayTime(){this.fillValues()},disabled(t){t&&(this.isActive&&(this.isActive=!1),this.showDropdown&&(this.showDropdown=!1))},"invalidValues.length"(t,e){t&&t>=1?this.$emit("error",this.invalidValues):e&&e>=1&&this.$emit("error",[])}},methods:{formatValue(t,e){if(!this.isNumber(e))return"";switch(e=+e,t){case"H":case"h":case"k":case"m":case"s":return["h","k"].includes(t)&&e===0?t==="k"?"24":"12":String(e);case"HH":case"mm":case"ss":case"hh":case"kk":return["hh","kk"].includes(t)&&e===0?t==="kk"?"24":"12":e<10?`0${e}`:String(e);default:return""}},checkAcceptingType(t,e){if(!t||!e||!e.length)return"";for(let s=0;s<t.length;s++)if(e.indexOf(t[s])>-1)return t[s];return""},renderFormat(t){t=t||this.opts.format||ge.format;let e=this.checkAcceptingType(ae.HOUR_TOKENS,t),s=this.checkAcceptingType(ae.MINUTE_TOKENS,t);this.secondType=this.checkAcceptingType(ae.SECOND_TOKENS,t),this.apmType=this.checkAcceptingType(ae.APM_TOKENS,t),!e&&!s&&!this.secondType&&!this.apmType&&(this.debugMode&&this.format&&this.debugLog(`No valid tokens found in your defined "format" string "${this.format}". Fallback to the default "HH:mm" format.`),e="HH",s="mm"),this.hourType=e,this.minuteType=s,this.hourType?this.renderHoursList():this.hours=[],this.minuteType?this.renderList("minute"):this.minutes=[],this.secondType?this.renderList("second"):this.seconds=[],this.apmType?this.renderApmList():this.apms=[],ue(()=>{this.readValues()})},renderHoursList(){const t=this.baseOn12Hours?12:24,e=[];for(let s=0;s<t;s++)this.hourType==="k"||this.hourType==="kk"?e.push(this.formatValue(this.hourType,s+1)):e.push(this.formatValue(this.hourType,s));this.hours=e},renderList(t,e){if(!this.isMinuteOrSecond(t))return;const s=t==="minute";e=e||(s?this.opts.minuteInterval||ge.minuteInterval:this.opts.secondInterval||ge.secondInterval);const n=[];for(let o=0;o<60;o+=e)n.push(this.formatValue(s?this.minuteType:this.secondType,o));s?this.minutes=n:this.seconds=n},renderApmList(){this.apms=this.apmType==="A"?["AM","PM"]:["am","pm"]},readValues(){this.useStringValue?(this.debugMode&&this.debugLog(`Received a string value: "${this.modelValue}"`),this.readStringValues(this.modelValue)):(this.debugMode&&this.debugLog(`Received an object value: "${JSON.stringify(this.modelValue||{})}"`),this.readObjectValues(this.modelValue))},readObjectValues(t){const e=JSON.parse(JSON.stringify(t||{})),s=Object.keys(e);if(s.length===0){this.addFallbackValues();return}ae.BASIC_TYPES.forEach(n=>{const o=this.getTokenByType(n);if(s.indexOf(o)>-1){const i=this.sanitizedValue(o,e[o]);this[n]=i,e[o]=i}else this[n]=""}),this.timeValue=e},getMatchAllByRegex(t,e){const s="polyfillTest";return!s.matchAll||typeof s.matchAll!="function"?this.polyfillMatchAll(t,e):t.matchAll(new RegExp(e,"g"))},readStringValues(t){if(!t||!t.length){this.addFallbackValues();return}const e=String(this.formatString),s=`(${this.tokenRegexBase})+?`,n=`[^(${this.tokenRegexBase})]+`,o=this.getMatchAllByRegex(e,s),i=this.getMatchAllByRegex(e,n),u=[],a=[];for(let b of o){const I={index:b.index,token:b[0],isValueToken:!0};u.push(I),a.push(I)}for(let b of i)u.push({index:b.index,token:b[0]});u.sort((b,I)=>b.index<I.index?-1:1);let m="";if(u.forEach(b=>{if(b.isValueToken){const I=this.getTokenRegex(b.token)||"";m+=I}else{const I=b.token.replace(/\\{0}(\*|\?|\.|\+)/g,"\\$1");m+=`(?:${I})`}}),new RegExp(m).test(t)){const I=t.match(new RegExp(m)).slice(1,a.length+1),V={};if(I.forEach((R,P)=>{if(a[P]){const B=a[P].token;V[B]=this.setValueFromString(R,B)}}),this.timeValue=V,this.debugMode){const R=a.map(P=>P&&P.token);this.debugLog(`Successfully parsed values ${JSON.stringify(I)}
for ${JSON.stringify(R)}
in format pattern '${this.formatString}'`)}}else this.debugMode&&this.debugLog(`The input string in "v-model" does NOT match the "format" pattern
format: ${this.formatString}
v-model: ${t}`)},polyfillMatchAll(t,e){const s=t.match(new RegExp(e,"g")),n=[],o=[];return s&&s.length&&s.forEach(i=>{const u=o.findIndex(m=>m.str===i);let a;if(u>=0)o[u]&&o[u].regex&&(a=o[u].regex.exec(t).index);else{const m=new RegExp(i,"g");a=m.exec(t).index,o.push({str:String(i),regex:m})}n.push({0:String(i),index:a})}),n},addFallbackValues(){const t={};this.inUse.types.forEach(e=>{t[this.getTokenByType(e)]=""}),this.timeValue=t},setValueFromString(t,e){if(!e||!t)return"";const s=this.getTokenType(e);if(!s||!s.length)return"";const n=t!==this.getTokenByType(s)?t:"";return this[s]=n,n},fillValues(t){const e={},s=this.hour,n=this.hourType;let o;if(!n||!this.isNumber(s))ae.HOUR_TOKENS.forEach(i=>e[i]=""),o=this.lowerCasedApm(this.apm||""),e.a=o,e.A=o.toUpperCase();else{const i=+s,u=this.baseOn12Hours&&this.apm?this.lowerCasedApm(this.apm):!1;ae.HOUR_TOKENS.forEach(a=>{if(a===n){e[a]=s;return}let m,h;switch(a){case"H":case"HH":case"k":case"kk":this.baseOn12Hours?u==="pm"?m=i<12?i+12:i:["k","kk"].includes(a)?m=i===12?24:i:m=i%12:["k","kk"].includes(a)?m=i===0?24:i:m=i%24,e[a]=this.formatValue(a,m);break;case"h":case"hh":this.baseOn12Hours?(m=i,h=u||""):i>11&&i<24?(h="pm",m=i===12?12:i%12):(h="am",m=i%12===0?12:i),e[a]=this.formatValue(a,m),e.a=h,e.A=h.toUpperCase();break}})}e.m=this.formatValue("m",this.minute),e.mm=this.formatValue("mm",this.minute),e.s=this.formatValue("s",this.second),e.ss=this.formatValue("ss",this.second),this.fullValues=e,(!this.lazy||t)&&this.emitTimeValue(),this.closeOnComplete&&this.allValueSelected&&this.showDropdown&&this.toggleActive()},emitTimeValue(){if(!this.fullValues)return;if(this.lazy&&this.bakDisplayTime===this.displayTime){this.debugMode&&this.debugLog("The value does not change on `lazy` mode. Skip the emitting `input` and `change` event.");return}const t=JSON.parse(JSON.stringify(this.fullValues));if(this.useStringValue)this.$emit("update:modelValue",this.inputIsEmpty?"":String(this.displayTime));else{const e=this.inUse.tokens||[],s={};e.forEach(n=>{s[n]=t[n]||""}),this.$emit("update:modelValue",JSON.parse(JSON.stringify(s)))}this.$emit("change",{data:t,displayTime:this.inputIsEmpty?"":String(this.displayTime)})},translate12hRange(t){const e=this.match12hRange(t);return+e[1]==12?+e[1]+(e[2].toLowerCase()==="p"?0:12):+e[1]+(e[2].toLowerCase()==="p"?12:0)},isDisabled(t,e){if(!this.isBasicType(t)||!this.inUse[t])return!0;switch(t){case"hour":return this.isDisabledHour(e);case"minute":case"second":return this[`${t}RangeList`]?!this[`${t}RangeList`].includes(e):!1;case"apm":return this.restrictedHourRange?!this.has[this.lowerCasedApm(e)]:!1;default:return!0}},isDisabledHour(t){if(!this.restrictedHourRange)return!1;if(this.baseOn12Hours){if(!this.apm||!this.apm.length)return!1;{const e=this.apm.toLowerCase()==="am"?"a":"p";return!this.restrictedHourRange.includes(`${+t}${e}`)}}return(this.hourType==="HH"||this.hourType==="H")&&+t==0&&this.restrictedHourRange.includes(24)?!1:!this.restrictedHourRange.includes(+t)},notInInterval(t,e){if(!(!t||!this.isMinuteOrSecond(t)))return this.opts[`${t}Interval`]===1?!1:+e%this.opts[`${t}Interval`]!==0},renderRangeList(t,e){if(!t||!e||!this.isMinuteOrSecond(e))return[];const s=[];let n;if(t.forEach(o=>{if(o instanceof Array){o.length>2&&this.debugMode&&this.debugLog(`Nested array within "${e}-range" must contain no more than two items. Only the first two items of ${JSON.stringify(o)} will be taken into account.`);const i=o[0],u=o[1]||o[0];for(let a=+i;a<=+u;a++)a<0||a>59||(n=this.formatValue(this.getTokenByType(e),a),s.includes(n)||s.push(n))}else{if(+o<0||+o>59)return;n=this.formatValue(this.getTokenByType(e),o),s.includes(n)||s.push(n)}}),s.sort((o,i)=>o-i),this.debugMode){const i=((e==="minute"?this.minutes:this.seconds)||[]).filter(u=>s.includes(u));(!i||!i.length)&&(e==="minute"?this.debugLog(`The minute list is empty due to the "minute-range" config
minute-range: ${JSON.stringify(this.minuteRange)}
minute-interval: ${this.opts.minuteInterval}`):this.debugLog(`The second list is empty due to the "second-range" config
second-range: ${JSON.stringify(this.secondRange)}
second-interval: ${this.opts.secondInterval}`))}return s},forceApmSelection(){if(!this.manualInput&&this.apmType&&!this.apm&&(this.has.am||this.has.pm)){this.doClearApmChecking=!0;const t=this.has.am?"am":"pm";this.apm=this.apmType==="A"?t.toUpperCase():t}},emptyApmSelection(){this.doClearApmChecking&&this.hour===""&&this.minute===""&&this.second===""&&(this.apm=""),this.doClearApmChecking=!1},apmDisplayText(t){return this.amText&&this.lowerCasedApm(t)==="am"?this.amText:this.pmText&&this.lowerCasedApm(t)==="pm"?this.pmText:t},toggleActive(){this.disabled||(this.isActive=!this.isActive,this.isActive?(this.isFocusing=!0,this.manualInput&&this.$emit("focus"),this.opts.hideDropdown||this.setDropdownState(!0),this.lazy&&(this.bakDisplayTime=String(this.displayTime||"")),this.manualInput&&!this.inputIsEmpty&&ue(()=>{this.$refs.input&&this.$refs.input.selectionStart===0&&this.$refs.input.selectionEnd===this.displayTime.length&&this.selectFirstSlot()})):(this.showDropdown?this.setDropdownState(!1):this.manualInput&&this.$emit("blur"),this.isFocusing=!1,this.lazy&&(this.fillValues(!0),this.bakDisplayTime=void 0)),this.restrictedHourRange&&this.baseOn12Hours&&(this.showDropdown?this.forceApmSelection():this.emptyApmSelection()),this.showDropdown&&this.checkForAutoScroll())},setDropdownState(t,e=!1){t?(this.keepFocusing(),this.autoDirectionEnabled&&this.checkDropDirection(),this.showDropdown=!0,this.$emit("open"),e&&(this.fixedDropdownButton&&(this.isActive=!0),this.$emit("blur"),this.checkForAutoScroll())):(this.showDropdown=!1,this.$emit("close"))},blurEvent(){this.manualInput&&!this.opts.hideDropdown&&this.$emit("blur")},select(t,e){this.isBasicType(t)&&!this.isDisabled(t,e)&&(this[t]=e,this.doClearApmChecking&&(this.doClearApmChecking=!1))},clearTime(){this.disabled||(this.hour="",this.minute="",this.second="",this.apm="",this.manualInput&&this.$refs&&this.$refs.input&&this.$refs.input.value.length&&(this.$refs.input.value=""),this.lazy&&this.fillValues(!0))},checkForAutoScroll(){this.inputIsEmpty||(this.autoScroll?ue(()=>{this.scrollToSelectedValues()}):this.advancedKeyboard&&ue(()=>{const t=this.inUse.types[0];this.scrollToSelected(t,!0)}))},scrollToSelected(t,e=!1){if(!this.timeValue||this.inputIsEmpty)return;const s=this.$el.querySelectorAll(`ul.${t}s`)[0];let n=this.activeItemInCol(t)[0];!n&&e&&(n=this.validItemsInCol(t)[0]),s&&n&&(s.scrollTop=n.offsetTop||0,this.advancedKeyboard&&n.focus())},scrollToSelectedValues(){!this.timeValue||this.inputIsEmpty||this.inUse.types.forEach(t=>{this.scrollToSelected(t)})},onFocus(){this.disabled||(this.isFocusing||(this.isFocusing=!0),this.isActive||this.toggleActive())},escBlur(){if(this.disabled)return;window.clearTimeout(this.debounceTimer),this.isFocusing=!1;const t=this.$el.querySelectorAll("input.vue__time-picker-input")[0];t&&t.blur()},debounceBlur(){this.disabled||(this.isFocusing=!1,window.clearTimeout(this.debounceTimer),this.debounceTimer=window.setTimeout(()=>{window.clearTimeout(this.debounceTimer),this.onBlur()},this.opts.blurDelay))},onBlur(){!this.disabled&&!this.isFocusing&&this.isActive&&this.toggleActive()},keepFocusing(){this.disabled||(window.clearTimeout(this.debounceTimer),this.isFocusing||(this.isFocusing=!0))},validItemsInCol(t){const e=`${t}s`;return this.$el.querySelectorAll(`ul.${e} > li:not(.hint):not([disabled])`)},activeItemInCol(t){const e=`${t}s`;return this.$el.querySelectorAll(`ul.${e} > li.active:not(.hint)`)},getClosestSibling(t,e,s=!1){const n=this.validItemsInCol(t),o=Array.prototype.findIndex.call(n,i=>i.getAttribute("data-key")===e);return s&&o===0?n[n.length-1]:!s&&o===n.length-1||o<0?n[0]:s?n[o-1]:n[o+1]},prevItem(t,e,s=!1){const n=this.getClosestSibling(t,e,!0);if(n)return s?n:n.focus()},nextItem(t,e,s=!1){const n=this.getClosestSibling(t,e,!1);if(n)return s?n:n.focus()},getSideColumnName(t,e=!1){const s=this.inUse.types.indexOf(t);if(e&&s<=0){this.debugMode&&this.debugLog("You're in the leftmost list already");return}else if(!e&&s===this.inUse.types.length-1){this.debugMode&&this.debugLog("You're in the rightmost list already");return}return this.inUse.types[e?s-1:s+1]},getFirstItemInSideColumn(t,e=!1){const s=this.getSideColumnName(t,e);if(!s)return;const n=this.validItemsInCol(s);if(n&&n[0])return n[0]},getActiveItemInSideColumn(t,e=!1){const s=this.getSideColumnName(t,e);if(!s)return;const n=this.activeItemInCol(s);if(n&&n[0])return n[0]},toLeftColumn(t){const e=this.getActiveItemInSideColumn(t,!0)||this.getFirstItemInSideColumn(t,!0);e&&e.focus()},toRightColumn(t){const e=this.getActiveItemInSideColumn(t,!1)||this.getFirstItemInSideColumn(t,!1);e&&e.focus()},onMouseDown(){this.manualInput&&(window.clearTimeout(this.selectionTimer),this.selectionTimer=window.setTimeout(()=>{if(window.clearTimeout(this.selectionTimer),this.$refs&&this.$refs.input){const t=this.getNearestChunkByPos(this.$refs.input.selectionStart||0);this.debounceSetInputSelection(t)}},50))},keyDownHandler(t){if(t.isComposing||t.keyCode===229)return t.preventDefault(),t.stopPropagation(),!1;t.keyCode>=48&&t.keyCode<=57||t.keyCode>=96&&t.keyCode<=105?(t.preventDefault(),this.keyboardInput(t.key)):[65,80,77].includes(t.keyCode)?(t.preventDefault(),this.keyboardInput(t.key,!0)):t.keyCode>=37&&t.keyCode<=40?(t.preventDefault(),this.clearKbInputLog(),this.arrowHandler(t)):t.keyCode===8||t.keyCode===46?(t.preventDefault(),this.clearKbInputLog(),this.clearTime()):t.keyCode===9?(this.clearKbInputLog(),this.tabHandler(t)):t.keyCode!==27&&!(t.metaKey||t.ctrlKey)&&t.preventDefault()},onCompostionStart(t){return t.preventDefault(),t.stopPropagation(),this.bakCurrentPos=this.getCurrentTokenChunk(),!1},onCompostionEnd(t){t.preventDefault(),t.stopPropagation();const e=t.data;let s=!1;return this.has.customApmText&&(s=this.isCustomApmText(e)),s&&this.setSanitizedValueToSection("apm",s),this.$refs.input.value=this.has.customApmText?this.customDisplayTime:this.displayTime,ue(()=>{if(this.bakCurrentPos){const n=JSON.parse(JSON.stringify(this.bakCurrentPos));s&&(n.end=n.start+e.length),this.debounceSetInputSelection(n),this.bakCurrentPos=null}}),!1},pasteHandler(t){t.preventDefault();let e=(t.clipboardData||window.clipboardData).getData("text");this.debugMode&&this.debugLog(`Pasting value "${e}" from clipboard`),!(!e||!e.length)&&(this.has.customApmText&&(e=this.replaceCustomApmText(e)),this.inputIsEmpty?this.readStringValues(e):(this.kbInputLog=e.substr(-2,2),this.setKbInput(),this.debounceClearKbLog()))},arrowHandler(t){const e={37:"L",38:"U",39:"R",40:"D"}[t.keyCode];if(e==="U"||e==="D")if(this.inputIsEmpty)this.selectFirstValidValue();else{const s=this.getCurrentTokenChunk();if(!s){this.selectFirstValidValue();return}const n=s.type;this.getClosestValidItemInCol(n,this[n],e);const o=this.getCurrentTokenChunk();this.debounceSetInputSelection(o)}else e==="R"?this.toLateralToken(!1):e==="L"&&this.toLateralToken(!0)},tabHandler(t){if(!this.inputIsEmpty&&this.tokenChunksPos&&this.tokenChunksPos.length){const e=this.getCurrentTokenChunk();if(!e)return;const s=this.tokenChunksPos[0],n=this.tokenChunksPos[this.tokenChunksPos.length-1];(t.shiftKey&&e.token!==s.token||!t.shiftKey&&e.token!==n.token)&&(t.preventDefault(),this.toLateralToken(t.shiftKey))}},keyboardInput(t,e=!1){const s=this.getCurrentTokenChunk();!s||s.type!=="apm"&&e||s.type==="apm"&&!e||(this.kbInputLog=`${this.kbInputLog.substr(-1)}${t}`,this.setKbInput(),this.debounceClearKbLog())},clearKbInputLog(){window.clearTimeout(this.kbInputTimer),this.kbInputLog=""},debounceClearKbLog(){window.clearTimeout(this.kbInputTimer),this.kbInputTimer=window.setTimeout(()=>{this.clearKbInputLog()},this.opts.manualInputTimeout)},setKbInput(t){t=t||this.kbInputLog;const e=this.getCurrentTokenChunk();if(!e||!t||!t.length)return;const s=e.type,n=e.token;let o;if(s==="apm")this.lowerCasedApm(t).includes("a")?o="am":this.lowerCasedApm(t).includes("p")&&(o="pm"),o&&(o=n==="A"?o.toUpperCase():o);else if(this.isValidValue(n,t))o=t;else{const i=this.formatValue(n,t.substr(-1));this.isValidValue(n,i)&&(o=i)}if(o){this.setSanitizedValueToSection(s,o);const i=this.getCurrentTokenChunk();this.debounceSetInputSelection(i)}this.debugMode&&(o?this.debugLog(`Successfully set value "${o}" from latest input "${t}" for the "${s}" slot`):this.debugLog(`Value "${t}" is invalid in the "${s}" slot`))},onChange(){if(!this.manualInput||!this.$refs||!this.$refs.input)return;const t=this.$refs.input.value||"";t&&t.length&&this.readStringValues(t)},getNearestChunkByPos(t){if(!this.tokenChunksPos||!this.tokenChunksPos.length)return;let e,s=-1;for(let n=0;n<this.tokenChunksPos.length;n++){const o=JSON.parse(JSON.stringify(this.tokenChunksPos[n]));if(o.start===t)return o;const i=Math.abs(o.start-t);if(s<0)e=o,s=i;else{if(s<=i)return e;s=i,e=o}}return e},selectFirstValidValue(){if(!this.tokenChunksPos||!this.tokenChunksPos.length)return;const t=this.tokenChunksPos[0].type;t==="hour"?this.getClosestHourItem():this.getClosestValidItemInCol(t,this[t]),this.selectFirstSlot()},getClosestHourItem(t,e="U"){if(!this.validHoursList||!this.validHoursList.length){this.debugMode&&this.debugLog(`No valid hour values found, please check your "hour-range" config
hour-range: ${JSON.stringify(this.hourRange)}`);return}if(!t){this.setManualHour(this.validHoursList[0]);return}const s=this.validHoursList.findIndex(i=>{if(this.baseOn12Hours){const u=`${t}${this.lowerCasedApm(this.apm)==="pm"?"p":"a"}`;return i===u}else return i===t});let n;s===-1?n=0:e==="D"?n=s===0?this.validHoursList.length-1:s-1:n=(s+1)%this.validHoursList.length;const o=this.validHoursList[n];this.setManualHour(o)},getClosestValidItemInCol(t,e,s="U"){if(t==="hour")this.getClosestHourItem(e,s);else{const n=s==="D"?this.prevItem(t,this[t],!0):this.nextItem(t,this[t],!0);n&&this.select(t,n.getAttribute("data-key"))}},setSanitizedValueToSection(t,e){if(!t||!this.getTokenByType(t))return;const s=this.sanitizedValue(this.getTokenByType(t),e);this[t]=s},setManualHour(t){if(this.is12hRange(t)){const e=this.match12hRange(t),s=e[2]==="a"?"AM":"PM";this.setSanitizedValueToSection("apm",this.apmType==="a"?s.toLowerCase():s),this.setSanitizedValueToSection("hour",e[1])}else this.setSanitizedValueToSection("hour",t)},debounceSetInputSelection({start:t=0,end:e=0}){ue(()=>{this.setInputSelectionRange(t,e)}),window.clearTimeout(this.selectionTimer),this.selectionTimer=window.setTimeout(()=>{window.clearTimeout(this.selectionTimer),this.$refs.input&&(this.$refs.input.selectionStart!==t||this.$refs.input.selectionEnd!==e)&&this.setInputSelectionRange(t,e)},30)},setInputSelectionRange(t,e){this.$refs&&this.$refs.input&&this.$refs.input.setSelectionRange(t,e)},getCurrentTokenChunk(){return this.getNearestChunkByPos(this.$refs.input&&this.$refs.input.selectionStart||0)},selectFirstSlot(){const t=this.getNearestChunkByPos(0);this.debounceSetInputSelection(t)},toLateralToken(t){const e=this.getCurrentTokenChunk();if(!e){this.selectFirstValidValue();return}const s=this.tokenChunksPos.findIndex(o=>o.token===e.token);if(!t&&s>=this.tokenChunksPos.length-1||t&&s===0){this.debugMode&&(t?this.debugLog("You're in the leftmost slot already"):this.debugLog("You're in the rightmost slot already"));return}const n=t?this.tokenChunksPos[s-1]:this.tokenChunksPos[s+1];this.debounceSetInputSelection(n)},isCustomApmText(t){return!t||!t.length?!1:this.amText&&this.amText===t?this.apmType==="A"?"AM":"am":this.pmText&&this.pmText===t?this.apmType==="A"?"PM":"pm":!1},replaceCustomApmText(t){return this.amText&&this.amText.length&&t.includes(this.amText)?t.replace(new RegExp(this.amText,"g"),this.apmType==="A"?"AM":"am"):this.pmText&&this.pmText.length&&t.includes(this.pmText)?t.replace(new RegExp(this.pmText,"g"),this.apmType==="A"?"PM":"pm"):t},checkDropDirection(){if(!this.$el)return;let t;this.containerId&&this.containerId.length&&(t=document.getElementById(this.containerId),!t&&this.debugMode&&this.debugLog(`Container with id "${this.containerId}" not found. Fallback to document body.`));const e=this.$el;let s;t&&t.offsetHeight?s=t.offsetTop+t.offsetHeight-(e.offsetTop+e.offsetHeight):s=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)-(e.offsetTop+e.offsetHeight),this.forceDropOnTop=this.opts.dropOffsetHeight>s},is12hRange(t){return/^\d{1,2}(a|p|A|P)$/.test(t)},match12hRange(t){return t.match(/^(\d{1,2})(a|p|A|P)$/)},isNumber(t){return!isNaN(parseFloat(t))&&isFinite(t)},isBasicType(t){return ae.BASIC_TYPES.includes(t)},lowerCasedApm(t){return(t||"").toLowerCase()},getTokenRegex(t){switch(t){case"HH":return"([01][0-9]|2[0-3]|H{2})";case"H":return"([0-9]{1}|1[0-9]|2[0-3]|H{1})";case"hh":return"(0[1-9]|1[0-2]|h{2})";case"h":return"([1-9]{1}|1[0-2]|h{1})";case"kk":return"(0[1-9]|1[0-9]|2[0-4]|k{2})";case"k":return"([1-9]{1}|1[0-9]|2[0-4]|k{1})";case"mm":return"([0-5][0-9]|m{2})";case"ss":return"([0-5][0-9]|s{2})";case"m":return"([0-9]{1}|[1-5][0-9]|m{1})";case"s":return"([0-9]{1}|[1-5][0-9]|s{1})";case"A":return"(AM|PM|A{1})";case"a":return"(am|pm|a{1})";default:return""}},isEmptyValue(t,e){return!e||!e.length||e&&e===t},isValidValue(t,e){if(!t||this.isEmptyValue(t,e))return!1;const s=this.getTokenRegex(t);return!s||!s.length?!1:new RegExp(`^${s}$`).test(e)},sanitizedValue(t,e){return this.isValidValue(t,e)?e:""},getTokenType(t){return this.inUse.types[this.inUse.tokens.indexOf(t)]||""},getTokenByType(t){return this[`${t}Type`]||""},isMinuteOrSecond(t){return["minute","second"].includes(t)},booleanAttr(t=!1){return t?!0:null},debugLog(t){if(!t||!t.length)return;let e="";if(this.id&&(e+=`#${this.id}`),this.name&&(e+=`[name=${this.name}]`),this.inputClass){let n=[];typeof this.inputClass=="string"?n=this.inputClass.split(/\s/g):Array.isArray(this.inputClass)?n=[].concat([],this.inputClass):typeof this.inputClass=="object"&&Object.keys(this.inputClass).forEach(o=>{this.inputClass[o]&&n.push(o)});for(let o of n)o&&o.trim().length&&(e+=`.${o.trim()}`)}const s=`DEBUG: ${t}${e?`
	(${e})`:""}`;window.console.debug&&typeof window.console.debug=="function"?window.console.debug(s):window.console.log(s)}},mounted(){window.clearTimeout(this.debounceTimer),window.clearTimeout(this.selectionTimer),window.clearTimeout(this.kbInputTimer),this.renderFormat()},beforeUnmount(){window.clearTimeout(this.debounceTimer),window.clearTimeout(this.selectionTimer),window.clearTimeout(this.kbInputTimer)}};const us={key:0,class:"controls",tabindex:"-1"},ds=p("span",{class:"char"},"×",-1),cs=p("span",{class:"char"},"▾",-1),hs={key:1,class:"custom-icon"};function ps(t,e,s,n,o,i){return c(),y("span",{class:"vue__time-picker",style:i.inputWidthStyle},[p("input",{type:"text",class:["vue__time-picker-input",[s.inputClass,{"is-empty":i.inputIsEmpty,invalid:i.hasInvalidInput,"all-selected":i.allValueSelected,disabled:s.disabled,"has-custom-icon":t.$slots&&t.$slots.icon}]],ref:"input",style:i.inputWidthStyle,id:s.id,name:s.name,value:i.inputIsEmpty?null:i.customDisplayTime,placeholder:s.placeholder?s.placeholder:i.formatString,tabindex:s.disabled?-1:s.tabindex,disabled:i.booleanAttr(s.disabled),readonly:i.booleanAttr(!s.manualInput),autocomplete:s.autocomplete,onFocus:e[1]||(e[1]=(...u)=>i.onFocus(...u)),onChange:e[2]||(e[2]=(...u)=>i.onChange(...u)),onBlur:e[3]||(e[3]=u=>{i.debounceBlur(),i.blurEvent()}),onMousedown:e[4]||(e[4]=(...u)=>i.onMouseDown(...u)),onKeydown:[e[5]||(e[5]=(...u)=>i.keyDownHandler(...u)),e[9]||(e[9]=A(D((...u)=>i.escBlur(...u),["exact"]),["esc"]))],onCompositionstart:e[6]||(e[6]=(...u)=>i.onCompostionStart(...u)),onCompositionend:e[7]||(e[7]=(...u)=>i.onCompostionEnd(...u)),onPaste:e[8]||(e[8]=(...u)=>i.pasteHandler(...u))},null,46,["id","name","value","placeholder","tabindex","disabled","readonly","autocomplete"]),i.showClearBtn||i.showDropdownBtn?(c(),y("div",us,[!o.isActive&&i.showClearBtn?(c(),y("span",{key:0,class:["clear-btn",{"has-custom-btn":t.$slots&&t.$slots.clearButton}],tabindex:"-1",onClick:e[10]||(e[10]=(...u)=>i.clearTime(...u))},[ce(t.$slots,"clearButton",{},()=>[ds])],2)):T("v-if",!0),i.showDropdownBtn?(c(),y("span",{key:1,class:["dropdown-btn",{"has-custom-btn":t.$slots&&t.$slots.dropdownButton}],tabindex:"-1",onClick:e[11]||(e[11]=u=>i.setDropdownState(s.fixedDropdownButton?!o.showDropdown:!0,!0)),onMousedown:e[12]||(e[12]=(...u)=>i.keepFocusing(...u))},[ce(t.$slots,"dropdownButton",{},()=>[cs])],34)):T("v-if",!0)])):T("v-if",!0),t.$slots&&t.$slots.icon?(c(),y("div",hs,[ce(t.$slots,"icon")])):T("v-if",!0),o.showDropdown?(c(),y("div",{key:2,class:"time-picker-overlay",onClick:e[13]||(e[13]=(...u)=>i.toggleActive(...u)),tabindex:"-1"})):T("v-if",!0),gt(p("div",{class:["dropdown",[i.dropdownDirClass]],tabindex:"-1",style:i.inputWidthStyle,onMouseup:e[42]||(e[42]=(...u)=>i.keepFocusing(...u)),onClick:e[43]||(e[43]=D(()=>{},["stop"]))},[p("div",{class:"select-list",style:i.inputWidthStyle,tabindex:"-1"},[T(" Common Keyboard Support: less event listeners "),s.advancedKeyboard?T("v-if",!0):(c(!0),y(E,{key:0},Y(i.columnsSequence,u=>(c(),y(E,{key:u},[u==="hour"?(c(),y("ul",{key:0,class:"hours",onScroll:e[14]||(e[14]=(...a)=>i.keepFocusing(...a))},[p("li",{class:"hint",textContent:v(i.hourLabelText)},null,8,["textContent"]),(c(!0),y(E,null,Y(o.hours,(a,m)=>(c(),y(E,{key:m},[!i.opts.hideDisabledHours||i.opts.hideDisabledHours&&!i.isDisabled("hour",a)?(c(),y("li",{key:0,class:{active:o.hour===a},disabled:i.booleanAttr(i.isDisabled("hour",a)),"data-key":a,textContent:v(a),onClick:h=>i.select("hour",a)},null,10,["disabled","data-key","textContent","onClick"])):T("v-if",!0)],64))),128))],32)):T("v-if",!0),u==="minute"?(c(),y("ul",{key:1,class:"minutes",onScroll:e[15]||(e[15]=(...a)=>i.keepFocusing(...a))},[p("li",{class:"hint",textContent:v(i.minuteLabelText)},null,8,["textContent"]),(c(!0),y(E,null,Y(o.minutes,(a,m)=>(c(),y(E,{key:m},[!i.opts.hideDisabledMinutes||i.opts.hideDisabledMinutes&&!i.isDisabled("minute",a)?(c(),y("li",{key:0,class:{active:o.minute===a},disabled:i.booleanAttr(i.isDisabled("minute",a)),"data-key":a,textContent:v(a),onClick:h=>i.select("minute",a)},null,10,["disabled","data-key","textContent","onClick"])):T("v-if",!0)],64))),128))],32)):T("v-if",!0),u==="second"?(c(),y("ul",{key:2,class:"seconds",onScroll:e[16]||(e[16]=(...a)=>i.keepFocusing(...a))},[p("li",{class:"hint",textContent:v(i.secondLabelText)},null,8,["textContent"]),(c(!0),y(E,null,Y(o.seconds,(a,m)=>(c(),y(E,{key:m},[!i.opts.hideDisabledSeconds||i.opts.hideDisabledSeconds&&!i.isDisabled("second",a)?(c(),y("li",{key:0,class:{active:o.second===a},disabled:i.booleanAttr(i.isDisabled("second",a)),"data-key":a,textContent:v(a),onClick:h=>i.select("second",a)},null,10,["disabled","data-key","textContent","onClick"])):T("v-if",!0)],64))),128))],32)):T("v-if",!0),u==="apm"?(c(),y("ul",{key:3,class:"apms",onScroll:e[17]||(e[17]=(...a)=>i.keepFocusing(...a))},[p("li",{class:"hint",textContent:v(i.apmLabelText)},null,8,["textContent"]),(c(!0),y(E,null,Y(o.apms,(a,m)=>(c(),y(E,{key:m},[!i.opts.hideDisabledHours||i.opts.hideDisabledHours&&!i.isDisabled("apm",a)?(c(),y("li",{key:0,class:{active:o.apm===a},disabled:i.booleanAttr(i.isDisabled("apm",a)),"data-key":a,textContent:v(i.apmDisplayText(a)),onClick:h=>i.select("apm",a)},null,10,["disabled","data-key","textContent","onClick"])):T("v-if",!0)],64))),128))],32)):T("v-if",!0)],64))),128)),T(" / Common Keyboard Support "),T(`
        Advanced Keyboard Support
        Addeds hundreds of additional event lisenters
      `),s.advancedKeyboard?(c(!0),y(E,{key:1},Y(i.columnsSequence,u=>(c(),y(E,{key:u},[u==="hour"?(c(),y("ul",{key:0,class:"hours",tabindex:"-1",onScroll:e[23]||(e[23]=(...a)=>i.keepFocusing(...a))},[p("li",{class:"hint",textContent:v(i.hourLabelText),tabindex:"-1"},null,8,["textContent"]),(c(!0),y(E,null,Y(o.hours,(a,m)=>(c(),y(E,{key:m},[!i.opts.hideDisabledHours||i.opts.hideDisabledHours&&!i.isDisabled("hour",a)?(c(),y("li",{key:0,class:{active:o.hour===a},tabindex:i.isDisabled("hour",a)?-1:s.tabindex,"data-key":a,disabled:i.booleanAttr(i.isDisabled("hour",a)),textContent:v(a),onClick:h=>i.select("hour",a),onKeydown:[A(D(h=>i.select("hour",a),["prevent"]),["space"]),A(D(h=>i.select("hour",a),["prevent"]),["enter"]),A(D(h=>i.prevItem("hour",a),["prevent"]),["up"]),A(D(h=>i.nextItem("hour",a),["prevent"]),["down"]),e[18]||(e[18]=A(D(h=>i.toLeftColumn("hour"),["prevent"]),["left"])),e[19]||(e[19]=A(D(h=>i.toRightColumn("hour"),["prevent"]),["right"])),e[20]||(e[20]=A(D((...h)=>i.debounceBlur(...h),["exact"]),["esc"]))],onBlur:e[21]||(e[21]=(...h)=>i.debounceBlur(...h)),onFocus:e[22]||(e[22]=(...h)=>i.keepFocusing(...h))},null,42,["tabindex","data-key","disabled","textContent","onClick","onKeydown"])):T("v-if",!0)],64))),128))],32)):T("v-if",!0),u==="minute"?(c(),y("ul",{key:1,class:"minutes",tabindex:"-1",onScroll:e[29]||(e[29]=(...a)=>i.keepFocusing(...a))},[p("li",{class:"hint",textContent:v(i.minuteLabelText),tabindex:"-1"},null,8,["textContent"]),(c(!0),y(E,null,Y(o.minutes,(a,m)=>(c(),y(E,{key:m},[!i.opts.hideDisabledMinutes||i.opts.hideDisabledMinutes&&!i.isDisabled("minute",a)?(c(),y("li",{key:0,class:{active:o.minute===a},tabindex:i.isDisabled("minute",a)?-1:s.tabindex,"data-key":a,disabled:i.booleanAttr(i.isDisabled("minute",a)),textContent:v(a),onClick:h=>i.select("minute",a),onKeydown:[A(D(h=>i.select("minute",a),["prevent"]),["space"]),A(D(h=>i.select("minute",a),["prevent"]),["enter"]),A(D(h=>i.prevItem("minute",a),["prevent"]),["up"]),A(D(h=>i.nextItem("minute",a),["prevent"]),["down"]),e[24]||(e[24]=A(D(h=>i.toLeftColumn("minute"),["prevent"]),["left"])),e[25]||(e[25]=A(D(h=>i.toRightColumn("minute"),["prevent"]),["right"])),e[26]||(e[26]=A(D((...h)=>i.debounceBlur(...h),["exact"]),["esc"]))],onBlur:e[27]||(e[27]=(...h)=>i.debounceBlur(...h)),onFocus:e[28]||(e[28]=(...h)=>i.keepFocusing(...h))},null,42,["tabindex","data-key","disabled","textContent","onClick","onKeydown"])):T("v-if",!0)],64))),128))],32)):T("v-if",!0),u==="second"?(c(),y("ul",{key:2,class:"seconds",tabindex:"-1",onScroll:e[35]||(e[35]=(...a)=>i.keepFocusing(...a))},[p("li",{class:"hint",textContent:v(i.secondLabelText),tabindex:"-1"},null,8,["textContent"]),(c(!0),y(E,null,Y(o.seconds,(a,m)=>(c(),y(E,{key:m},[!i.opts.hideDisabledSeconds||i.opts.hideDisabledSeconds&&!i.isDisabled("second",a)?(c(),y("li",{key:0,class:{active:o.second===a},tabindex:i.isDisabled("second",a)?-1:s.tabindex,"data-key":a,disabled:i.booleanAttr(i.isDisabled("second",a)),textContent:v(a),onClick:h=>i.select("second",a),onKeydown:[A(D(h=>i.select("second",a),["prevent"]),["space"]),A(D(h=>i.select("second",a),["prevent"]),["enter"]),A(D(h=>i.prevItem("second",a),["prevent"]),["up"]),A(D(h=>i.nextItem("second",a),["prevent"]),["down"]),e[30]||(e[30]=A(D(h=>i.toLeftColumn("second"),["prevent"]),["left"])),e[31]||(e[31]=A(D(h=>i.toRightColumn("second"),["prevent"]),["right"])),e[32]||(e[32]=A(D((...h)=>i.debounceBlur(...h),["exact"]),["esc"]))],onBlur:e[33]||(e[33]=(...h)=>i.debounceBlur(...h)),onFocus:e[34]||(e[34]=(...h)=>i.keepFocusing(...h))},null,42,["tabindex","data-key","disabled","textContent","onClick","onKeydown"])):T("v-if",!0)],64))),128))],32)):T("v-if",!0),u==="apm"?(c(),y("ul",{key:3,class:"apms",tabindex:"-1",onScroll:e[41]||(e[41]=(...a)=>i.keepFocusing(...a))},[p("li",{class:"hint",textContent:v(i.apmLabelText),tabindex:"-1"},null,8,["textContent"]),(c(!0),y(E,null,Y(o.apms,(a,m)=>(c(),y(E,{key:m},[!i.opts.hideDisabledHours||i.opts.hideDisabledHours&&!i.isDisabled("apm",a)?(c(),y("li",{key:0,class:{active:o.apm===a},tabindex:i.isDisabled("apm",a)?-1:s.tabindex,"data-key":a,disabled:i.booleanAttr(i.isDisabled("apm",a)),textContent:v(i.apmDisplayText(a)),onClick:h=>i.select("apm",a),onKeydown:[A(D(h=>i.select("apm",a),["prevent"]),["space"]),A(D(h=>i.select("apm",a),["prevent"]),["enter"]),A(D(h=>i.prevItem("apm",a),["prevent"]),["up"]),A(D(h=>i.nextItem("apm",a),["prevent"]),["down"]),e[36]||(e[36]=A(D(h=>i.toLeftColumn("apm"),["prevent"]),["left"])),e[37]||(e[37]=A(D(h=>i.toRightColumn("apm"),["prevent"]),["right"])),e[38]||(e[38]=A(D((...h)=>i.debounceBlur(...h),["exact"]),["esc"]))],onBlur:e[39]||(e[39]=(...h)=>i.debounceBlur(...h)),onFocus:e[40]||(e[40]=(...h)=>i.keepFocusing(...h))},null,42,["tabindex","data-key","disabled","textContent","onClick","onKeydown"])):T("v-if",!0)],64))),128))],32)):T("v-if",!0)],64))),128)):T("v-if",!0),T(" / Advanced Keyboard Support ")],4)],38),[[bt,o.showDropdown]])],4)}he.render=ps;he.__file="src/VueTimepicker.vue";const ms={class:"text-2xl font-semibold"},fs={class:"p-4 bg-surface-hover space-y-3 rounded-sm"},gs={class:"flex items-center justify-between text-sm text-base"},bs={class:"flex items-center gap-1"},ys={class:"flex items-center justify-between text-sm text-base"},vs={class:"flex items-center gap-1"},xs={class:"flex items-center justify-between text-sm text-base"},ks={class:"flex items-center justify-between font-semibold text-base"},ws={class:"flex items-start justify-between font-semibold text-base mt-2"},Ts={class:"flex flex-col items-end"},_s={class:"flex items-center gap-1"},Cs={class:"text-xs text-gray-500 font-normal"},Ls={key:0,class:"flex items-center gap-2 mt-2 p-2 bg-red-50 dark:bg-red-900/20 rounded border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 text-sm"},Ss={key:0,class:"mt-2"},Is={class:"flex flex-col gap-2 mt-4"},Rs={class:"flex w-full items-center gap-2"},Ds={key:0,class:"text-justify"},Bs={class:"mt-4"},As={class:"mt-4"},Ms={class:"flex gap-2"},Vs={key:0,class:"text-red-500 text-sm mt-1"},Os={class:"flex justify-end gap-3 mt-6"},Es={key:0},Us={key:1},Ps=ye({__name:"RentBookModal",props:{isOpenRentBookModal:{type:Boolean},bookId:{},bookTitle:{},dailyRentPrice:{},securityDeposit:{},rentalExists:{type:Boolean},currentWalletBalance:{},reservedAmount:{},ownerUserId:{}},emits:["update:openRentBookModal","rental-success","update:rentalExists"],setup(t,{emit:e}){const{createRental:s,loading:n}=Be(),o=new He("en-US",{dateStyle:"medium"}),i=Oe(null),u=new Date,a=new Date(u.getTime()+1440*60*1e3),m=new $e(a.getFullYear(),a.getMonth()+1,a.getDate()),h=z(()=>i.value?o.format(i.value.toDate(Te())):""),b=t,I=e,V=z({get:()=>b.isOpenRentBookModal,set:w=>I("update:openRentBookModal",w)}),R=["1 day","3 days","5 days","7 days","14 days","Custom"],P=S(""),B=S(null),O=S(null),k=S(null),ee=S(null),H=S(null),U=S(""),W=S(!1),se=S(0),N=S(""),ne=S(null),oe=S(null);function ie(w){return w?typeof w=="string"?w:typeof w=="object"&&w.HH&&w.mm?`${w.HH}:${w.mm}`:"":""}function Z(){const w=ie(ee.value),g=ie(H.value);if(!w||!g)return;const G=new Date(`1970-01-01T${w}:00`);new Date(`1970-01-01T${g}:00`)<=G?U.value="End time must be later than start time":U.value=""}re([ee,H],()=>{Z()}),re(P,w=>{w!=="Custom"&&(B.value=null,O.value=Number(w.split(" ")[0]))});function pe(w){[".","e","-","+"].includes(w.key)&&w.preventDefault()}re(B,w=>{P.value==="Custom"&&w&&(O.value=Math.floor(w))}),re(i,w=>{w&&w<m&&(i.value=m),k.value=w?o.format(w.toDate(Te())):null});const x=z(()=>{if(!O.value)return 0;const w=b.dailyRentPrice??0,g=b.securityDeposit??0;return w*O.value+g}),f=z(()=>{const w=b.currentWalletBalance??0,g=b.reservedAmount??0;return w-g}),F=z(()=>x.value>f.value);function $(w){if(!w)return"";const[g,G]=w.split(":");if(!g||!G)return"";let C=parseInt(g);const te=parseInt(G),xe=C>=12?"PM":"AM";return C===0&&(C=12),C>12&&(C-=12),`${C}:${te.toString().padStart(2,"0")} ${xe}`}const J=S(!1);re(()=>b.isOpenRentBookModal,w=>{w&&(J.value=!1,U.value="")});async function le(){if(Z(),!(J.value||U.value||F.value)){J.value=!0;try{const w=ie(ee.value),g=ie(H.value),G=$(w),C=$(g);if(!G||!C){U.value="Please select valid start and end times",J.value=!1;return}await s({bookId:b.bookId,totalRentCost:x.value,rentalDurationDays:O.value,meetupTimeWindow:`${G} - ${C}`,meetupLocation:N.value,latitude:ne.value,longitude:oe.value,meetupDate:k.value,actualRate:b.dailyRentPrice??0,actualDeposit:b.securityDeposit??0,ownerUserId:b.ownerUserId}),I("update:rentalExists",!0),I("rental-success"),V.value=!1}catch(w){console.error(w),J.value=!1}}}return(w,g)=>{const G=Ce,C=Pe,te=wt,xe=Tt,me=de,at=it,rt=ot,lt=Ne,ut=Le;return c(),y(ut,{open:V.value,"onUpdate:open":g[11]||(g[11]=j=>V.value=j),ui:{content:"max-w-lg"},dismissible:!0},{header:_(()=>[r("h2",ms,"Rent "+v(b.bookTitle),1)]),body:_(()=>[r("div",fs,[g[18]||(g[18]=r("p",{class:"font-semibold text-base"},"Rental Details",-1)),r("div",gs,[g[12]||(g[12]=r("span",null,"Daily Rate:",-1)),r("div",bs,[p(G,{name:"fluent:book-coins-20-regular",class:"w-5 h-5 text-accent"}),r("span",null,v(b.dailyRentPrice)+"/day",1)])]),r("div",ys,[g[13]||(g[13]=r("span",null,"Security Deposit:",-1)),r("div",vs,[p(G,{name:"fluent:book-coins-20-regular",class:"w-5 h-5 text-accent"}),r("span",null,v(b.securityDeposit),1)])]),r("div",xs,[g[14]||(g[14]=r("span",null,"Rental Period:",-1)),r("span",null,v(O.value??"-"),1)]),p(C,{orientation:"horizontal",class:"my-2 bg-slate-400"}),r("div",ks,[g[15]||(g[15]=r("span",null,"Total Cost:",-1)),r("div",{class:K(["flex items-center gap-1",{"text-red-500":F.value}])},[p(G,{name:"fluent:book-coins-20-regular",class:K(["w-5 h-5 text-accent",F.value?"text-red-500":"text-accent"])},null,8,["class"]),r("span",null,v(x.value),1)],2)]),r("div",ws,[g[16]||(g[16]=r("span",{class:"mt-0.5"},"Available Balance:",-1)),r("div",Ts,[r("div",_s,[p(G,{name:"fluent:book-coins-20-regular",class:"w-5 h-5 text-accent"}),r("span",null,v(f.value),1)]),r("span",Cs," ("+v(b.currentWalletBalance)+" current balance - "+v(b.reservedAmount)+" reserved) ",1)])]),F.value?(c(),L("div",Ls,[p(G,{name:"i-heroicons-exclamation-circle",class:"w-5 h-5 shrink-0"}),g[17]||(g[17]=r("span",null,"Insufficient wallet balance for this rental duration.",-1))])):T("",!0)]),g[26]||(g[26]=r("p",{class:"font-semibold text-base mt-4"},"Rental Duration",-1)),p(te,{modelValue:P.value,"onUpdate:modelValue":g[0]||(g[0]=j=>P.value=j),items:R,class:"w-full mt-2"},null,8,["modelValue"]),P.value==="Custom"?(c(),L("div",Ss,[g[19]||(g[19]=r("p",{class:"text-sm text-gray-600"},"Enter custom number of days:",-1)),p(xe,{type:"number",modelValue:B.value,"onUpdate:modelValue":g[1]||(g[1]=j=>B.value=j),min:"1",placeholder:"e.g., 12",class:"mt-1 w-full",onKeydown:pe},null,8,["modelValue"])])):T("",!0),r("div",Is,[r("div",Rs,[g[22]||(g[22]=r("p",{class:"flex-1 font-semibold text-base"},"Meetup Location",-1)),p(me,{class:"cursor-pointer justify-center",onClick:g[2]||(g[2]=j=>W.value=!0)},{default:_(()=>[...g[20]||(g[20]=[q("Open Map",-1)])]),_:1}),p(me,{class:"cursor-pointer justify-center",onClick:g[3]||(g[3]=j=>(N.value="",se.value++))},{default:_(()=>[...g[21]||(g[21]=[q("Remove Location",-1)])]),_:1})]),p(at,{"is-open-view-map-for-transaction":W.value,"remove-map-marker":se.value,"onUpdate:openViewMapForTransaction":g[4]||(g[4]=j=>W.value=j),"onUpdate:selectedAddress":g[5]||(g[5]=j=>N.value=j),"onUpdate:latitudeAndLongitude":g[6]||(g[6]=(j,dt)=>(ne.value=j,oe.value=dt))},null,8,["is-open-view-map-for-transaction","remove-map-marker"]),N.value!==""?(c(),L("p",Ds," Selected Address: "+v(N.value),1)):T("",!0)]),r("div",Bs,[g[23]||(g[23]=r("p",{class:"font-semibold text-base"},"Meetup Date",-1)),p(lt,null,{content:_(()=>[p(rt,{modelValue:i.value,"onUpdate:modelValue":g[7]||(g[7]=j=>i.value=j),class:"p-2",minValue:d(m)},null,8,["modelValue","minValue"])]),default:_(()=>[p(me,{color:"neutral",variant:"subtle",icon:"i-lucide-calendar"},{default:_(()=>[q(v(h.value||"Select a date"),1)]),_:1})]),_:1})]),r("div",As,[g[24]||(g[24]=r("p",{class:"font-semibold text-base"},"Meetup Time Window",-1)),r("div",Ms,[p(d(he),{modelValue:ee.value,"onUpdate:modelValue":g[8]||(g[8]=j=>ee.value=j),onChange:Z,format:"HH:mm","use12-hour":!1,placeholder:"Start Time"},null,8,["modelValue"]),p(d(he),{modelValue:H.value,"onUpdate:modelValue":g[9]||(g[9]=j=>H.value=j),onChange:Z,format:"HH:mm","use12-hour":!1,placeholder:"End Time"},null,8,["modelValue"])]),U.value?(c(),L("p",Vs,v(U.value),1)):T("",!0)]),r("div",Os,[p(me,{onClick:g[10]||(g[10]=j=>V.value=!1),class:"bg-slate-300 hover:bg-slate-400 text-black dark:bg-slate-400 dark:hover:bg-slate-500 px-4 py-2 rounded"},{default:_(()=>[...g[25]||(g[25]=[r("p",null,"Cancel",-1)])]),_:1}),p(me,{disabled:!!U.value||!ee.value||!H.value||!O.value||!k.value||!N.value||d(n)||F.value||J.value,class:"bg-slate-800 hover:bg-slate-700 text-white dark:bg-slate-700 dark:hover:bg-slate-600 px-4 py-2 rounded disabled:bg-slate-600 disabled:dark:bg-slate-500 disabled:cursor-not-allowed",onClick:D(le,["stop","prevent"])},{default:_(()=>[!d(n)&&!J.value?(c(),L("p",Es,"Send Rental Request")):(c(),L("p",Us,"Sending..."))]),_:1},8,["disabled"])])]),_:1},8,["open"])}}}),Hs=Object.assign(Ps,{__name:"RentBookModal"}),we="http://127.0.0.1:8080",Ae=()=>{const t=S(!1),e=S(!1),s=S(null),n=Ve(),{$apiFetch:o}=_e();return{loading:e,error:s,createPurchase:async a=>{e.value=!0,s.value=null;try{await o(`${we}/api/wallets/update-reserved-amount`,{method:"PATCH",body:{amount_to_reserve:a.total_buy_cost},credentials:"include"});const m=await o(`${we}/api/purchases/create`,{method:"POST",body:a,credentials:"include"});return n.add({title:"Success",description:"Purchase request sent successfully",color:"success"}),m}catch(m){throw s.value=m?.data?.message||m?.data?.error||m?.message||"Failed to process purchase",n.add({title:"Error",description:s.value??"Failed to process purchase",color:"error"}),m}finally{e.value=!1}},checkPurchaseExists:async a=>{try{const m=await o(`${we}/api/purchases/check/${a}`,{method:"GET",credentials:"include"});t.value=m.exists}catch(m){console.error(m)}},purchaseExists:t}},$s={class:"text-2xl font-semibold"},Ns={class:"p-4 bg-surface-hover space-y-3 rounded-sm"},Fs={class:"flex items-center justify-between text-sm text-base"},js={class:"flex items-center justify-between text-sm text-base"},Ks={class:"flex items-center gap-1"},qs={class:"flex items-start justify-between font-semibold text-base mt-2"},zs={class:"flex flex-col items-end"},Ws={class:"flex items-center gap-1"},Js={class:"text-xs text-gray-500 font-normal"},Gs={key:0,class:"flex items-center gap-2 mt-2 p-2 bg-red-50 dark:bg-red-900/20 rounded border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 text-sm"},Ys={class:"flex flex-col gap-2 mt-4"},Qs={class:"flex w-full items-center gap-2"},Zs={key:0,class:"text-justify"},Xs={class:"mt-4"},en={class:"mt-4"},tn={class:"flex gap-2 mt-1"},sn={key:0,class:"text-red-500 text-sm mt-1"},nn={class:"flex justify-end gap-3 mt-6"},on={key:0},an={key:1},rn=ye({__name:"PurchaseBookModal",props:{isOpenPurchaseBookModal:{type:Boolean},bookId:{},bookTitle:{},bookAuthor:{},purchasePrice:{},currentWalletBalance:{},purchaseExists:{type:Boolean},reserved_amount:{}},emits:["update:openPurchaseBookModal","purchase-success","update:purchaseExists"],setup(t,{emit:e}){const{createPurchase:s,loading:n}=Ae(),o=new He("en-US",{dateStyle:"medium"}),i=Oe(null),u=new Date,a=new Date(u.getTime()+1440*60*1e3),m=new $e(a.getFullYear(),a.getMonth()+1,a.getDate()),h=z(()=>i.value?o.format(i.value.toDate(Te())):"");re(i,x=>{x&&x<m&&(i.value=m),b.value=x?x.toString():null});const b=S(null),I=S(null),V=S(null),R=S(""),P=S(!1),B=S(0),O=S(""),k=S(null),ee=S(null),H=t,U=e,W=z({get:()=>H.isOpenPurchaseBookModal,set:x=>U("update:openPurchaseBookModal",x)}),se=z(()=>{const x=H.currentWalletBalance??0,f=H.reserved_amount??0;return x-f}),N=z(()=>(H.purchasePrice??0)>se.value);function ne(x){return x?typeof x=="string"?x:typeof x=="object"&&x.HH&&x.mm?`${x.HH}:${x.mm}`:"":""}function oe(){const x=ne(I.value),f=ne(V.value);if(!x||!f){R.value="";return}const F=new Date(`1970-01-01T${x}:00`);new Date(`1970-01-01T${f}:00`)<=F?R.value="End time must be later than start time":R.value=""}function ie(x){if(!x)return"";const[f,F]=x.split(":");if(!f||!F)return"";let $=parseInt(f);const J=parseInt(F),le=$>=12?"PM":"AM";return $===0&&($=12),$>12&&($-=12),`${$}:${J.toString().padStart(2,"0")} ${le}`}re([I,V],oe),re(()=>H.isOpenPurchaseBookModal,x=>{x&&(Z.value=!1,R.value="")});const Z=S(!1);async function pe(){if(oe(),!(Z.value||R.value||N.value)&&!(!b.value||!O.value||!I.value||!V.value)){Z.value=!0;try{const x=ne(I.value),f=ne(V.value),F=ie(x),$=ie(f);if(!F||!$){R.value="Please select valid start and end times",Z.value=!1;return}await s({book_id:H.bookId,total_buy_cost:H.purchasePrice,meetup_location:O.value,latitude:k.value,longitude:ee.value,meetup_date:b.value,meetup_time_window:`${F} - ${$}`}),U("update:purchaseExists",!0),U("purchase-success"),W.value=!1}catch(x){console.error(x),Z.value=!1}}}return(x,f)=>{const F=Pe,$=Ce,J=de,le=it,w=ot,g=Ne,G=Le;return c(),y(G,{open:W.value,"onUpdate:open":f[9]||(f[9]=C=>W.value=C),ui:{content:"max-w-lg"},dismissible:!0},{header:_(()=>[r("h2",$s,"Buy "+v(H.bookTitle),1)]),body:_(()=>[r("div",Ns,[f[14]||(f[14]=r("p",{class:"font-semibold text-base"},"Purchase Details",-1)),r("div",Fs,[f[10]||(f[10]=r("span",null,"Book:",-1)),r("span",null,v(H.bookTitle),1)]),r("div",js,[f[11]||(f[11]=r("span",null,"Author:",-1)),r("span",null,v(H.bookAuthor),1)]),p(F,{orientation:"horizontal",class:"my-2 bg-slate-400"}),r("div",{class:K(["flex items-center justify-between font-semibold text-base",{"text-red-500":N.value}])},[f[12]||(f[12]=r("span",null,"Total Cost:",-1)),r("div",Ks,[p($,{name:"fluent:book-coins-20-regular",class:K(["w-5 h-5",N.value?"text-red-500":"text-accent"])},null,8,["class"]),r("span",null,v(H.purchasePrice),1)])],2),r("div",qs,[f[13]||(f[13]=r("span",{class:"mt-0.5"},"Available Balance:",-1)),r("div",zs,[r("div",Ws,[p($,{name:"fluent:book-coins-20-regular",class:"w-5 h-5 text-accent"}),r("span",null,v(se.value),1)]),r("span",Js," ("+v(H.currentWalletBalance)+" total - "+v(H.reserved_amount)+" reserved) ",1)])])]),N.value?(c(),L("div",Gs,[p($,{name:"i-heroicons-exclamation-circle",class:"w-5 h-5 shrink-0"}),f[15]||(f[15]=r("span",null," Insufficient available funds. ",-1))])):T("",!0),r("div",Ys,[r("div",Qs,[f[18]||(f[18]=r("p",{class:"flex-1 font-semibold text-base"},"Meetup Location",-1)),p(J,{class:"cursor-pointer justify-center",onClick:f[0]||(f[0]=C=>P.value=!0)},{default:_(()=>[...f[16]||(f[16]=[q("Open Map",-1)])]),_:1}),p(J,{class:"cursor-pointer justify-center",onClick:f[1]||(f[1]=C=>(O.value="",B.value++))},{default:_(()=>[...f[17]||(f[17]=[q("Remove Location",-1)])]),_:1})]),p(le,{"is-open-view-map-for-transaction":P.value,"remove-map-marker":B.value,"onUpdate:openViewMapForTransaction":f[2]||(f[2]=C=>P.value=C),"onUpdate:selectedAddress":f[3]||(f[3]=C=>O.value=C),"onUpdate:latitudeAndLongitude":f[4]||(f[4]=(C,te)=>(k.value=C,ee.value=te))},null,8,["is-open-view-map-for-transaction","remove-map-marker"]),O.value!==""?(c(),L("p",Zs," Selected Address: "+v(O.value),1)):T("",!0)]),r("div",Xs,[f[19]||(f[19]=r("p",{class:"font-semibold text-base"},"Meetup Date",-1)),p(g,null,{content:_(()=>[p(w,{modelValue:i.value,"onUpdate:modelValue":f[5]||(f[5]=C=>i.value=C),class:"p-2",minValue:d(m)},null,8,["modelValue","minValue"])]),default:_(()=>[p(J,{color:"neutral",variant:"subtle",icon:"i-lucide-calendar"},{default:_(()=>[q(v(h.value||"Select a date"),1)]),_:1})]),_:1})]),r("div",en,[f[20]||(f[20]=r("p",{class:"font-semibold text-base"},"Meetup Time Window",-1)),r("div",tn,[p(d(he),{modelValue:I.value,"onUpdate:modelValue":f[6]||(f[6]=C=>I.value=C),onChange:oe,format:"HH:mm","use12-hour":!1,placeholder:"Start Time"},null,8,["modelValue"]),p(d(he),{modelValue:V.value,"onUpdate:modelValue":f[7]||(f[7]=C=>V.value=C),onChange:oe,format:"HH:mm","use12-hour":!1,placeholder:"End Time"},null,8,["modelValue"])]),R.value?(c(),L("p",sn,v(R.value),1)):T("",!0)]),r("div",nn,[p(J,{onClick:f[8]||(f[8]=C=>W.value=!1),class:"bg-slate-300 hover:bg-slate-400 text-black dark:bg-slate-400 dark:hover:bg-slate-500 px-4 py-2 rounded"},{default:_(()=>[...f[21]||(f[21]=[r("p",null,"Cancel",-1)])]),_:1}),p(J,{class:"bg-slate-800 hover:bg-slate-700 text-white dark:bg-slate-700 dark:hover:bg-slate-600 px-4 py-2 rounded disabled:bg-slate-600 disabled:dark:bg-slate-500 disabled:cursor-not-allowed",disabled:!!R.value||!I.value||!V.value||!b.value||!O.value||d(n)||N.value||Z.value,onClick:D(pe,["stop","prevent"])},{default:_(()=>[!d(n)&&!Z.value?(c(),L("p",on,"Confirm Purchase")):(c(),L("p",an,"Processing..."))]),_:1},8,["disabled"])])]),_:1},8,["open"])}}}),ln=Object.assign(rn,{__name:"PurchaseBookModal"}),un={class:"font-semibold text-lg mb-4 flex items-center gap-2 text-base"},dn={key:0,class:"bg-blue-100 dark:bg-blue-900/30 rounded-lg p-4 border-2 border-blue-200 dark:border-blue-700"},cn={class:"text-blue-700 dark:text-blue-400 font-semibold mb-3 flex items-center gap-2"},hn={class:"space-y-2 text-sm mb-3"},pn={class:"flex justify-between items-center"},mn={class:"flex items-center gap-1 text-base"},fn={class:"flex font-bold text-accent items-center"},gn={class:"flex justify-between items-center"},bn={class:"flex items-center gap-1 text-base"},yn={class:"flex items-center font-bold text-accent"},vn={class:"text-xs text-muted bg-surface/50 rounded p-2 flex items-start gap-2"},xn={key:1,class:"bg-green-100 dark:bg-green-900/30 rounded-lg p-4 border-2 border-green-200 dark:border-green-700"},kn={class:"text-green-700 dark:text-green-400 font-semibold mb-3 flex items-center gap-2"},wn={class:"space-y-2 text-sm mb-3"},Tn={class:"flex justify-between items-center"},_n={class:"flex items-center gap-1 text-base"},Cn={class:"flex items-center font-bold text-accent"},Ln={class:"text-xs text-muted bg-surface/50 rounded p-2 flex items-start gap-2"},Sn=["disabled"],In={key:0},Rn={key:1},Dn=["disabled"],Bn={key:0},An={key:1},Mn=ye({__name:"BookPricing",props:{availability:{},dailyRentPrice:{},securityDeposit:{},purchasePrice:{},bookId:{},rentalExists:{type:Boolean},purchaseExists:{type:Boolean}},emits:["rent","purchase"],setup(t,{emit:e}){const s=t,n=e,{checkRentalExists:o}=Be(),{checkPurchaseExists:i}=Ae();be(async()=>{s.bookId&&(await o(s.bookId),await i(s.bookId))});const u=()=>{n("rent")},a=()=>{n("purchase")};return(m,h)=>{const b=Ee,I=Ue;return c(),y(I,{class:"bg-blue-50 dark:bg-blue-950/20 border-blue-200 dark:border-blue-800"},{default:_(()=>[r("h2",un,[p(b,{name:"fluent:book-coins-20-regular",class:"text-xl w-7 h-7"}),h[0]||(h[0]=q(" Pricing Options ",-1))]),r("div",{class:K(["grid gap-4",t.availability==="both"?"md:grid-cols-2":"grid-cols-1"])},[t.availability==="rent"||t.availability==="both"?(c(),L("div",dn,[r("h3",cn,[p(b,{name:"i-heroicons-book-open",class:"text-xl"}),h[1]||(h[1]=q(" Rental Option ",-1))]),r("div",hn,[r("div",pn,[r("span",mn,[p(b,{name:"i-heroicons-calendar",class:"text-base w-5 h-5"}),h[2]||(h[2]=q(" Daily Rate ",-1))]),r("span",fn,[p(b,{name:"fluent:book-coins-20-regular",class:"w-5 h-5"}),q(" "+v(t.dailyRentPrice),1)])]),r("div",gn,[r("span",bn,[p(b,{name:"i-heroicons-shield-check",class:"text-base w-5 h-5"}),h[3]||(h[3]=q(" Deposit ",-1))]),r("span",yn,[p(b,{name:"fluent:book-coins-20-regular",class:"w-5 h-5"}),q(" "+v(t.securityDeposit),1)])])]),r("div",vn,[p(b,{name:"i-heroicons-shield-check",class:"text-sm flex-shrink-0 mt-0.5 w-4 h-4"}),h[4]||(h[4]=r("span",null,"Deposit refunded upon safe return",-1))])])):T("",!0),t.availability==="purchase"||t.availability==="both"?(c(),L("div",xn,[r("h3",kn,[p(b,{name:"i-heroicons-shopping-cart",class:"text-xl"}),h[5]||(h[5]=q(" Purchase Option ",-1))]),r("div",wn,[r("div",Tn,[r("span",_n,[p(b,{name:"i-heroicons-currency-dollar",class:"text-base w-5 h-5"}),h[6]||(h[6]=q(" One-time Price ",-1))]),r("span",Cn,[p(b,{name:"fluent:book-coins-20-regular",class:"w-5 h-5"}),q(" "+v(t.purchasePrice),1)])]),h[7]||(h[7]=r("div",{class:"flex justify-between items-center"},[r("span",{class:"text-base"},"Ownership"),r("span",{class:"font-bold text-accent"},"Forever")],-1))]),r("div",Ln,[p(b,{name:"i-heroicons-shopping-cart",class:"text-sm flex-shrink-0 mt-0.5"}),h[8]||(h[8]=r("span",null,"Own the book permanently - no returns needed",-1))])])):T("",!0)],2),r("div",{class:K(["grid gap-3 mt-6",t.availability==="both"?"md:grid-cols-2":"grid-cols-1"])},[t.availability==="rent"||t.availability==="both"?(c(),L("button",{key:0,onClick:u,disabled:s.rentalExists,class:"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg transition flex items-center justify-center gap-2 cursor-pointer disabled:bg-blue-400 disabled:dark:bg-blue-600 disabled:text-white disabled:cursor-not-allowed"},[p(b,{name:"i-heroicons-book-open",class:"text-xl"}),s.rentalExists?(c(),L("span",In,"Request Already Sent")):(c(),L("span",Rn,"Rent This Book"))],8,Sn)):T("",!0),t.availability==="purchase"||t.availability==="both"?(c(),L("button",{key:1,onClick:a,disabled:s.purchaseExists,class:"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg transition flex items-center justify-center gap-2 cursor-pointer disabled:bg-blue-400 disabled:dark:bg-blue-600 disabled:text-white disabled:cursor-not-allowed"},[p(b,{name:"i-heroicons-shopping-cart",class:"text-xl"}),s.purchaseExists?(c(),L("span",Bn,"Request Already Sent")):(c(),L("span",An,"Buy This Book"))],8,Dn)):T("",!0)],2)]),_:1})}}}),Vn=Object.assign(Mn,{__name:"BookPricing"});function On(){const{$apiFetch:t}=_e();return t("/api/wallets/get-reserved-amount",{method:"GET",credentials:"include"})}const En={class:"min-h-screen w-full bg-background pt-4 pb-6 px-4 md:px-8 lg:px-15"},Un={key:0,class:"flex items-center justify-center h-screen"},Pn={class:"text-center"},Hn={key:1,class:"flex items-center justify-center h-screen"},$n={class:"text-center p-6"},Nn={key:0,class:"text-muted mb-4"},Fn={key:1,class:"text-muted mb-4"},jn={key:2,class:"max-w-7xl pt-3 mx-auto"},Kn={class:"font-medium"},qn={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},zn={class:"relative bg-zinc-200 dark:bg-zinc-800 rounded-lg overflow-hidden mb-4 aspect-[3/4]"},Wn=["src","alt"],Jn={key:1,class:"w-full h-full flex items-center justify-center text-muted"},Gn={key:0,class:"px-[9%] mb-6"},Yn=["onClick"],Qn=["src","alt"],Zn={class:"space-y-4"},Xn={class:"flex justify-between items-center py-3 px-3 border-y border-base"},ei={class:"font-bold text-base"},ti={class:"flex items-center justify-between"},si={class:"flex items-center gap-3"},ni={class:"relative"},ii=["src","alt"],oi={key:1,class:"w-10 h-10 rounded-full bg-surface flex items-center justify-center"},ai={class:"flex flex-col items-end"},ri={class:"text-2xl font-bold text-base"},li={class:"flex flex-col"},ui={class:"flex-grow"},di={class:"text-[42px] font-bold text-base mb-2"},ci={class:"text-muted mb-4"},hi={class:"flex flex-wrap gap-2 mb-6"},pi={class:"px-3 py-1 bg-yellow-400 text-zinc-900 rounded-full text-sm font-medium capitalize"},mi={class:"mb-6"},fi={class:"text-base text-justify leading-relaxed"},gi={class:"mt-auto"},Hi=ye({__name:"[bookId]",setup(t){const e=yt(),s=vt(),n=e.params.bookId,{rentalExists:o,checkRentalExists:i}=Be(),{purchaseExists:u,checkPurchaseExists:a}=Ae(),m=S(!1),h=S(!1),b=S(0),I=S(0),V=S(!0);be(async()=>{V.value=!0;const x=await At();b.value=x.currentWalletBalance??0,V.value=!1}),be(async()=>{V.value=!0;const x=await On();I.value=x.reserved_amount??0,V.value=!1});const R=()=>{m.value=!0},P=()=>{o.value=!0,m.value=!1},B=()=>{h.value=!0},O=()=>{u.value=!0,m.value=!1},{book:k,loading:ee,fetchBookDetails:H,availabilityBadges:U,ownerTrustBadge:W}=Bt(),se=S(0),N=z(()=>k.value?k.value.is_rented||k.value.is_purchased:!1),ne=z(()=>{if(!k.value)return!1;const x=e.query.from,f=e.query.collectionOwnerId;return x==="user-collection"&&f?k.value.owner_user_id!==f:!1});be(async()=>{try{await H(n)}catch(x){console.error("Failed to fetch book details:",x)}});const oe=x=>{se.value=x},ie=()=>{const x=e.query.from;x==="browse"?s.push("/browse"):x==="user-collection"?s.push(`/users/${k.value?.owner_user_id}/collection`):s.push("/browse")},Z=z(()=>{const x=e.query.from;return x==="browse"?"Back to Browse":x==="user-collection"?"Back to Collection":"Back to Browse"}),pe=x=>{const f={blue:"bg-blue-600 text-white dark:bg-blue-500",red:"bg-red-600 text-white dark:bg-red-500"};return f[x]||f.gray};return be(async()=>{n&&await Promise.all([i(n),a(n)])}),(x,f)=>{const F=Ee,$=Ue,J=kt,le=Ce,w=xt,g=Hs,G=ln;return c(),L("div",En,[d(ee)?(c(),L("div",Un,[r("div",Pn,[p(F,{name:"i-heroicons-arrow-path",class:"w-8 h-8 animate-spin text-accent"}),f[2]||(f[2]=r("p",{class:"text-muted mt-2"},"Loading book details...",-1))])])):d(N)||d(ne)?(c(),L("div",Hn,[p($,{class:"bg-surface border-base max-w-md"},{default:_(()=>[r("div",$n,[p(F,{name:"i-heroicons-exclamation-triangle",class:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),f[3]||(f[3]=r("h2",{class:"text-2xl font-bold text-base mb-2"},"Book Currently Unavailable",-1)),d(ne)?(c(),L("p",Nn," This book does not belong to this user's collection. ")):(c(),L("p",Fn," This book is "+v(d(k)?.is_rented?"currently rented":"purchased")+" and cannot be viewed at this time. ",1)),r("button",{onClick:ie,class:"px-6 py-2 bg-accent text-white rounded-lg hover:bg-accent/90 transition cursor-pointer"}," Go Back ")])]),_:1})])):d(k)?(c(),L("div",jn,[r("button",{class:"flex items-center gap-2 mb-6 text-base hover:text-accent transition cursor-pointer",onClick:ie},[p(F,{name:"i-heroicons-arrow-left",class:"text-xl"}),r("span",Kn,v(d(Z)),1)]),p($,{class:"bg-surface border-base"},{default:_(()=>[r("div",qn,[r("div",null,[r("div",zn,[d(k).images.length>0?(c(),L("img",{key:0,src:d(k).images[d(se)],alt:d(k).title,class:"w-full h-full object-cover"},null,8,Wn)):(c(),L("div",Jn,[p(F,{name:"i-heroicons-book-open",class:"text-8xl"})]))]),d(k).images.length>1?(c(),L("div",Gn,[p(J,{items:d(k).images,ui:{item:"basis-[85px]",container:"gap-2"},arrows:""},{default:_(({item:C,index:te})=>[r("button",{onClick:xe=>oe(te),class:K(["w-[85px] h-[115px] rounded-lg overflow-hidden border-2 transition",te===d(se)?"border-accent":"border-base hover:border-accent/50"])},[r("img",{src:C,alt:`${d(k).title} ${te+1}`,class:"w-full h-full object-cover"},null,8,Qn)],10,Yn)]),_:1},8,["items"])])):T("",!0),r("div",Zn,[r("div",Xn,[f[4]||(f[4]=r("span",{class:"font-semibold text-base"},"Times rented:",-1)),r("span",ei,v(d(k).times_rented||0),1)]),p($,{class:"bg-background border-base"},{default:_(()=>[f[5]||(f[5]=r("h3",{class:"font-semibold mb-3 text-base"},"Owner Information",-1)),r("div",ti,[r("div",si,[r("div",ni,[d(k).owner_profile_picture?(c(),L("img",{key:0,src:d(k).owner_profile_picture,alt:d(k).owner_username,class:"w-10 h-10 rounded-full object-cover"},null,8,ii)):(c(),L("div",oi,[p(le,{name:"heroicons:user-solid",class:"w-7 h-7 text-muted"})]))]),r("div",null,[p(w,{to:`/users/${d(k).owner_user_id}`,class:"font-medium text-base px-1 py-1 hover:text-accent rounded-md hover:bg-surface-hover transition cursor-pointer"},{default:_(()=>[q(v(d(k).owner_username),1)]),_:1},8,["to"])])]),r("div",ai,[r("span",ri,v(d(k).owner_trust_score),1),r("span",{class:K(["text-xs px-2 py-1 rounded-full font-medium text-white",[d(W).color,d(W).text==="Poor"?"border border-white":""]])},v(d(W).text),3)])])]),_:1})])]),r("div",li,[r("div",ui,[r("h1",di,v(d(k).title.length>130?d(k).title.substring(0,130)+"...":d(k).title),1),r("p",ci,"by "+v(d(k).author),1),r("div",hi,[(c(!0),L(E,null,Y(d(k).genres,(C,te)=>(c(),L("span",{key:te,class:"px-3 py-1 bg-surface border border-base rounded-full text-sm text-base"},v(C),1))),128)),r("span",pi,v(d(k).condition),1),(c(!0),L(E,null,Y(d(U),(C,te)=>(c(),L("span",{key:`avail-${te}`,class:K(["px-3 py-1 rounded-full text-sm font-medium",pe(C.color)])},v(C.label),3))),128))]),r("div",mi,[f[6]||(f[6]=r("h2",{class:"font-semibold text-lg mb-2 text-base"},"Description",-1)),r("p",fi,v(d(k).description),1)])]),r("div",gi,[p(Vn,{availability:d(k).availability,"daily-rent-price":d(k).daily_rent_price,"security-deposit":d(k).security_deposit,"purchase-price":d(k).purchase_price,"book-id":d(n)??"","rental-exists":d(o),"purchase-exists":d(u),onRent:R,onPurchase:B},null,8,["availability","daily-rent-price","security-deposit","purchase-price","book-id","rental-exists","purchase-exists"])])])])]),_:1})])):T("",!0),p(g,{"is-open-rent-book-modal":d(m),"book-id":d(n)??"","book-title":d(k)?.title,"daily-rent-price":d(k)?.daily_rent_price,"security-deposit":d(k)?.security_deposit,"rental-exists":d(o),"current-wallet-balance":d(b),"reserved-amount":d(I),"owner-user-id":d(k)?.owner_user_id,"onUpdate:openRentBookModal":f[0]||(f[0]=C=>m.value=C),onRentalSuccess:P},null,8,["is-open-rent-book-modal","book-id","book-title","daily-rent-price","security-deposit","rental-exists","current-wallet-balance","reserved-amount","owner-user-id"]),p(G,{"is-open-purchase-book-modal":d(h),"book-id":d(n)??"","book-title":d(k)?.title,"book-author":d(k)?.author,"purchase-price":d(k)?.purchase_price,"current-wallet-balance":d(b),"purchase-exists":d(u),reserved_amount:d(I),"onUpdate:openPurchaseBookModal":f[1]||(f[1]=C=>h.value=C),onPurchaseSuccess:O},null,8,["is-open-purchase-book-modal","book-id","book-title","book-author","purchase-price","current-wallet-balance","purchase-exists","reserved_amount"])])}}});export{Hi as default};
