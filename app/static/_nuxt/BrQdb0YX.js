import{x as w,p as C,e as R,f as q,o as i,w as v,a as e,b as a,d as u,Z as I,c as l,E as g,t as c,D as y,$ as S,a0 as G,I as M,k as s,g as X,_ as Y,X as j,Y as D}from"#entry";import{_ as Z}from"./C-Fr4X5q.js";import{_ as O}from"./DJSAEPoY.js";const H="http://127.0.0.1:8080",J=()=>{const n=w(null),x=w(!1),m=w(null),f=async t=>{x.value=!0,m.value=null;try{const r=await $fetch(`${H}/api/books/${t}`,{credentials:"include"});n.value=r}catch(r){throw m.value=r?.message||"Failed to fetch book details",r}finally{x.value=!1}},o=C(()=>{if(!n.value)return[];const t=[];return(n.value.availability==="rent"||n.value.availability==="both")&&t.push({label:"For Rent",color:"blue"}),(n.value.availability==="purchase"||n.value.availability==="both")&&t.push({label:"For Sale",color:"red"}),t}),k=C(()=>{if(!n.value)return{text:"Unknown",color:"bg-zinc-500"};const t=n.value.owner_trust_score;return t>=951?{text:"Perfect",color:"bg-[#15803D]"}:t>=751?{text:"Exceptional",color:"bg-[#22C55E]"}:t>=500?{text:"Good",color:"bg-[#84CC16]"}:t>=251?{text:"Decent",color:"bg-[#FACC15]"}:t>=51?{text:"Bad",color:"bg-[#CA8A04]"}:{text:"Poor",color:"bg-[#000000]"}});return{book:n,loading:x,error:m,fetchBookDetails:f,availabilityBadges:o,ownerTrustBadge:k}},K={class:"font-semibold text-lg mb-4 flex items-center gap-2 text-base"},Q={key:0,class:"bg-blue-100 dark:bg-blue-900/30 rounded-lg p-4 border-2 border-blue-200 dark:border-blue-700"},W={class:"text-blue-700 dark:text-blue-400 font-semibold mb-3 flex items-center gap-2"},ee={class:"space-y-2 text-sm mb-3"},te={class:"flex justify-between items-center"},se={class:"flex items-center gap-1 text-base"},oe={class:"flex font-bold text-accent items-center"},ne={class:"flex justify-between items-center"},ae={class:"flex items-center gap-1 text-base"},re={class:"flex items-center font-bold text-accent"},ie={class:"text-xs text-muted bg-surface/50 rounded p-2 flex items-start gap-2"},le={key:1,class:"bg-green-100 dark:bg-green-900/30 rounded-lg p-4 border-2 border-green-200 dark:border-green-700"},ce={class:"text-green-700 dark:text-green-400 font-semibold mb-3 flex items-center gap-2"},de={class:"space-y-2 text-sm mb-3"},ue={class:"flex justify-between items-center"},be={class:"flex items-center gap-1 text-base"},me={class:"flex items-center font-bold text-accent"},xe={class:"text-xs text-muted bg-surface/50 rounded p-2 flex items-start gap-2"},fe=R({__name:"BookPricing",props:{availability:{},dailyRentPrice:{},securityDeposit:{},purchasePrice:{}},emits:["rent","purchase"],setup(n,{emit:x}){const m=x,f=()=>{m("rent")},o=()=>{m("purchase")};return(k,t)=>{const r=I,_=O;return i(),q(_,{class:"bg-blue-50 dark:bg-blue-950/20 border-blue-200 dark:border-blue-800"},{default:v(()=>[e("h2",K,[a(r,{name:"fluent:book-coins-20-regular",class:"text-xl w-7 h-7"}),t[0]||(t[0]=u(" Pricing Options ",-1))]),e("div",{class:y(["grid gap-4",n.availability==="both"?"md:grid-cols-2":"grid-cols-1"])},[n.availability==="rent"||n.availability==="both"?(i(),l("div",Q,[e("h3",W,[a(r,{name:"i-heroicons-book-open",class:"text-xl"}),t[1]||(t[1]=u(" Rental Option ",-1))]),e("div",ee,[e("div",te,[e("span",se,[a(r,{name:"i-heroicons-calendar",class:"text-base w-5 h-5"}),t[2]||(t[2]=u(" Daily Rate ",-1))]),e("span",oe,[a(r,{name:"fluent:book-coins-20-regular",class:"w-5 h-5"}),u(" "+c(n.dailyRentPrice),1)])]),e("div",ne,[e("span",ae,[a(r,{name:"i-heroicons-shield-check",class:"text-base w-5 h-5"}),t[3]||(t[3]=u(" Deposit ",-1))]),e("span",re,[a(r,{name:"fluent:book-coins-20-regular",class:"w-5 h-5"}),u(" "+c(n.securityDeposit),1)])])]),e("div",ie,[a(r,{name:"i-heroicons-shield-check",class:"text-sm flex-shrink-0 mt-0.5 w-4 h-4"}),t[4]||(t[4]=e("span",null,"Deposit refunded upon safe return",-1))])])):g("",!0),n.availability==="purchase"||n.availability==="both"?(i(),l("div",le,[e("h3",ce,[a(r,{name:"i-heroicons-shopping-cart",class:"text-xl"}),t[5]||(t[5]=u(" Purchase Option ",-1))]),e("div",de,[e("div",ue,[e("span",be,[a(r,{name:"i-heroicons-currency-dollar",class:"text-base w-5 h-5"}),t[6]||(t[6]=u(" One-time Price ",-1))]),e("span",me,[a(r,{name:"fluent:book-coins-20-regular",class:"w-5 h-5"}),u(" "+c(n.purchasePrice),1)])]),t[7]||(t[7]=e("div",{class:"flex justify-between items-center"},[e("span",{class:"text-base"},"Ownership"),e("span",{class:"font-bold text-accent"},"Forever")],-1))]),e("div",xe,[a(r,{name:"i-heroicons-shopping-cart",class:"text-sm flex-shrink-0 mt-0.5"}),t[8]||(t[8]=e("span",null,"Own the book permanently - no returns needed",-1))])])):g("",!0)],2),e("div",{class:y(["grid gap-3 mt-6",n.availability==="both"?"md:grid-cols-2":"grid-cols-1"])},[n.availability==="rent"||n.availability==="both"?(i(),l("button",{key:0,onClick:f,class:"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg transition flex items-center justify-center gap-2 cursor-pointer"},[a(r,{name:"i-heroicons-book-open",class:"text-xl"}),t[9]||(t[9]=u(" Rent This Book ",-1))])):g("",!0),n.availability==="purchase"||n.availability==="both"?(i(),l("button",{key:1,onClick:o,class:"bg-green-700 hover:bg-green-800 dark:bg-green-500 dark:hover:bg-green-600 text-white font-semibold py-3 px-6 rounded-lg transition flex items-center justify-center gap-2 cursor-pointer"},[a(r,{name:"i-heroicons-shopping-cart",class:"text-xl"}),t[10]||(t[10]=u(" Buy This Book ",-1))])):g("",!0)],2)]),_:1})}}}),he=Object.assign(fe,{__name:"BookPricing"}),pe={class:"min-h-screen w-full bg-background pt-4 pb-6 px-4 md:px-8 lg:px-15"},ge={key:0,class:"flex items-center justify-center h-screen"},_e={class:"text-center"},ve={key:1,class:"max-w-7xl pt-3 mx-auto"},ye={class:"font-medium"},ke={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},we={class:"relative bg-zinc-200 dark:bg-zinc-800 rounded-lg overflow-hidden mb-4 aspect-[3/4]"},$e=["src","alt"],Be={key:1,class:"w-full h-full flex items-center justify-center text-muted"},Ce={key:0,class:"px-[9%] mb-6"},Pe=["onClick"],je=["src","alt"],De={class:"space-y-4"},Re={class:"flex justify-between items-center py-3 px-3 border-y border-base"},Ie={class:"font-bold text-base"},Oe={class:"flex items-center justify-between"},Fe={class:"flex items-center gap-3"},Te={class:"relative"},Ue=["src","alt"],ze={key:1,class:"w-10 h-10 rounded-full bg-surface flex items-center justify-center"},Ne={class:"flex flex-col items-end"},Ae={class:"text-2xl font-bold text-base"},Ee={class:"flex flex-col"},Le={class:"flex-grow"},Ve={class:"text-[42px] font-bold text-base mb-2"},qe={class:"text-muted mb-4"},Se={class:"flex flex-wrap gap-2 mb-6"},Ge={class:"px-3 py-1 bg-yellow-400 text-zinc-900 rounded-full text-sm font-medium capitalize"},Me={class:"mb-6"},Xe={class:"text-base text-justify leading-relaxed"},Ye={class:"mt-auto"},Qe=R({__name:"[bookId]",setup(n){const x=S(),m=G(),f=x.params.bookId,{book:o,loading:k,fetchBookDetails:t,availabilityBadges:r,ownerTrustBadge:_}=J(),$=w(0);M(async()=>{try{await t(f)}catch(d){console.error("Failed to fetch book details:",d)}});const F=d=>{$.value=d},T=()=>{console.log("Rent book:",f)},U=()=>{console.log("Purchase book:",f)},z=()=>{const d=x.query.from;d==="browse"?m.push("/browse"):d==="user-collection"?m.push(`/users/${o.value?.owner_user_id}/collection`):m.push("/browse")},N=C(()=>{const d=x.query.from;return d==="browse"?"Back to Browse":d==="user-collection"?"Back to Collection":"Back to Browse"}),A=d=>{const b={blue:"bg-blue-600 text-white dark:bg-blue-500",red:"bg-red-600 text-white dark:bg-red-500"};return b[d]||b.gray};return(d,b)=>{const B=I,E=Z,L=X,V=Y,P=O;return i(),l("div",pe,[s(k)?(i(),l("div",ge,[e("div",_e,[a(B,{name:"i-heroicons-arrow-path",class:"w-8 h-8 animate-spin text-accent"}),b[0]||(b[0]=e("p",{class:"text-muted mt-2"},"Loading book details...",-1))])])):s(o)?(i(),l("div",ve,[e("button",{class:"flex items-center gap-2 mb-6 text-base hover:text-accent transition cursor-pointer",onClick:z},[a(B,{name:"i-heroicons-arrow-left",class:"text-xl"}),e("span",ye,c(s(N)),1)]),a(P,{class:"bg-surface border-base"},{default:v(()=>[e("div",ke,[e("div",null,[e("div",we,[s(o).images.length>0?(i(),l("img",{key:0,src:s(o).images[s($)],alt:s(o).title,class:"w-full h-full object-cover"},null,8,$e)):(i(),l("div",Be,[a(B,{name:"i-heroicons-book-open",class:"text-8xl"})]))]),s(o).images.length>1?(i(),l("div",Ce,[a(E,{items:s(o).images,ui:{item:"basis-[85px]",container:"gap-2"},arrows:""},{default:v(({item:p,index:h})=>[e("button",{onClick:Ze=>F(h),class:y(["w-[85px] h-[115px] rounded-lg overflow-hidden border-2 transition",h===s($)?"border-accent":"border-base hover:border-accent/50"])},[e("img",{src:p,alt:`${s(o).title} ${h+1}`,class:"w-full h-full object-cover"},null,8,je)],10,Pe)]),_:1},8,["items"])])):g("",!0),e("div",De,[e("div",Re,[b[1]||(b[1]=e("span",{class:"font-semibold text-base"},"Times rented:",-1)),e("span",Ie,c(s(o).times_rented||0),1)]),a(P,{class:"bg-background border-base"},{default:v(()=>[b[2]||(b[2]=e("h3",{class:"font-semibold mb-3 text-base"},"Owner Information",-1)),e("div",Oe,[e("div",Fe,[e("div",Te,[s(o).owner_profile_picture?(i(),l("img",{key:0,src:s(o).owner_profile_picture,alt:s(o).owner_username,class:"w-10 h-10 rounded-full object-cover"},null,8,Ue)):(i(),l("div",ze,[a(L,{name:"heroicons:user-solid",class:"w-7 h-7 text-muted"})]))]),e("div",null,[a(V,{to:`/users/${s(o).owner_user_id}`,class:"font-medium text-base px-1 py-1 hover:text-accent rounded-md hover:bg-surface-hover transition cursor-pointer"},{default:v(()=>[u(c(s(o).owner_username),1)]),_:1},8,["to"])])]),e("div",Ne,[e("span",Ae,c(s(o).owner_trust_score),1),e("span",{class:y(["text-xs px-2 py-1 rounded-full font-medium text-white",[s(_).color,s(_).text==="Poor"?"border border-white":""]])},c(s(_).text),3)])])]),_:1})])]),e("div",Ee,[e("div",Le,[e("h1",Ve,c(s(o).title.length>130?s(o).title.substring(0,130)+"...":s(o).title),1),e("p",qe,"by "+c(s(o).author),1),e("div",Se,[(i(!0),l(j,null,D(s(o).genres,(p,h)=>(i(),l("span",{key:h,class:"px-3 py-1 bg-surface border border-base rounded-full text-sm text-base"},c(p),1))),128)),e("span",Ge,c(s(o).condition),1),(i(!0),l(j,null,D(s(r),(p,h)=>(i(),l("span",{key:`avail-${h}`,class:y(["px-3 py-1 rounded-full text-sm font-medium",A(p.color)])},c(p.label),3))),128))]),e("div",Me,[b[3]||(b[3]=e("h2",{class:"font-semibold text-lg mb-2 text-base"},"Description",-1)),e("p",Xe,c(s(o).description),1)])]),e("div",Ye,[a(he,{availability:s(o).availability,"daily-rent-price":s(o).daily_rent_price,"security-deposit":s(o).security_deposit,"purchase-price":s(o).purchase_price,onRent:T,onPurchase:U},null,8,["availability","daily-rent-price","security-deposit","purchase-price"])])])])]),_:1})])):g("",!0)])}}});export{Qe as default};
