import{j as _,f,c as g,B as x,o as h,a as n,aR as P,n as a,i as c,t as v,F as C,J as S,b as u,k as p}from"#entry";const A=()=>{const s=(e,t,l)=>{const r=[];if(e.length<8&&r.push("Password must be at least 8 characters long"),/[A-Z]/.test(e)||r.push("Must contain at least one uppercase letter"),/[a-z]/.test(e)||r.push("Must contain at least one lowercase letter"),/\d/.test(e)||r.push("Must contain at least one number"),/[!@#$%^&*()_+\-=\[\]{}|;:,.<>?/\\~`]/.test(e)||r.push("Must contain at least one special character"),["password","123456","password123","12345678","qwerty","abc123","monkey","letmein","password1","admin123"].includes(e.toLowerCase())&&r.push("Password is too common. Please choose a stronger password"),t&&t.length>=3&&e.toLowerCase().includes(t.toLowerCase())&&r.push("Password cannot contain your username"),l){const k=l.split("@")[0];k.length>=3&&e.toLowerCase().includes(k.toLowerCase())&&r.push("Password cannot contain your email address")}const o=i(e),m=d(e);return{valid:r.length===0,errors:r,strength:o,percentage:m}},i=e=>{let t=0;return e.length>=8&&t++,e.length>=12&&t++,e.length>=16&&t++,/[A-Z]/.test(e)&&t++,/[a-z]/.test(e)&&t++,/\d/.test(e)&&t++,/[!@#$%^&*()_+\-=\[\]{}|;:,.<>?/\\~`]/.test(e)&&t++,(e.match(/[A-Z]/g)||[]).length>=2&&t++,(e.match(/\d/g)||[]).length>=2&&t++,(e.match(/[!@#$%^&*()_+\-=\[\]{}|;:,.<>?/\\~`]/g)||[]).length>=2&&t++,t<=3?"weak":t<=6?"medium":"strong"},d=e=>{let t=0;const l=10;return e.length>=8&&t++,e.length>=12&&t++,e.length>=16&&t++,/[A-Z]/.test(e)&&t++,/[a-z]/.test(e)&&t++,/\d/.test(e)&&t++,/[!@#$%^&*()_+\-=\[\]{}|;:,.<>?/\\~`]/.test(e)&&t++,(e.match(/[A-Z]/g)||[]).length>=2&&t++,(e.match(/\d/g)||[]).length>=2&&t++,(e.match(/[!@#$%^&*()_+\-=\[\]{}|;:,.<>?/\\~`]/g)||[]).length>=2&&t++,Math.round(t/l*100)};return{validatePassword:s,calculateStrength:i,calculatePercentage:d,getStrengthColor:e=>{switch(e){case"weak":return"red";case"medium":return"yellow";case"strong":return"green";default:return"gray"}},getStrengthText:e=>{switch(e){case"weak":return"Weak";case"medium":return"Medium";case"strong":return"Strong";default:return""}}}},$={key:0,class:"password-strength-meter mt-2"},M={class:"flex items-center gap-3 mb-2"},Z={class:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},L={key:0,class:"text-xs text-red-500 space-y-1 mt-2"},z={key:1,class:"text-xs space-y-1 mt-2"},B={class:"flex items-center gap-2"},E={class:"flex items-center gap-2"},O={class:"flex items-center gap-2"},T={class:"flex items-center gap-2"},V=_({__name:"PasswordStrengthMeter",props:{password:{},showErrors:{type:Boolean}},setup(s){const i=s,{validatePassword:d,getStrengthColor:w,getStrengthText:y}=A(),e=f(()=>i.password?d(i.password):{valid:!1,errors:[],strength:"weak",percentage:0});f(()=>w(e.value.strength));const t=f(()=>y(e.value.strength)),l=f(()=>{switch(e.value.strength){case"weak":return"bg-red-500";case"medium":return"bg-yellow-500";case"strong":return"bg-green-500";default:return"bg-gray-300"}});return(r,b)=>{const o=p;return s.password?(h(),g("div",$,[n("div",M,[n("div",Z,[n("div",{class:a([c(l),"h-full transition-all duration-300 ease-out"]),style:P({width:`${c(e).percentage}%`})},null,6)]),n("span",{class:a([{"text-red-500":c(e).strength==="weak","text-yellow-500":c(e).strength==="medium","text-green-500":c(e).strength==="strong"},"text-sm font-semibold min-w-[60px]"])},v(c(t)),3)]),s.showErrors&&c(e).errors.length>0?(h(),g("ul",L,[(h(!0),g(C,null,S(c(e).errors,m=>(h(),g("li",{key:m,class:"flex items-start gap-1"},[u(o,{name:"heroicons:x-circle-solid",class:"w-4 h-4 flex-shrink-0 mt-0.5"}),n("span",null,v(m),1)]))),128))])):x("",!0),s.showErrors?x("",!0):(h(),g("div",z,[n("div",B,[u(o,{name:s.password.length>=8?"heroicons:check-circle-solid":"heroicons:x-circle-solid",class:a([s.password.length>=8?"text-green-500":"text-gray-400","w-4 h-4"])},null,8,["name","class"]),n("span",{class:a(s.password.length>=8?"text-green-500":"text-gray-500")}," At least 8 characters ",2)]),n("div",E,[u(o,{name:/[A-Z]/.test(s.password)?"heroicons:check-circle-solid":"heroicons:x-circle-solid",class:a([/[A-Z]/.test(s.password)?"text-green-500":"text-gray-400","w-4 h-4"])},null,8,["name","class"]),n("span",{class:a(/[A-Z]/.test(s.password)?"text-green-500":"text-gray-500")}," One uppercase letter ",2)]),n("div",O,[u(o,{name:/\d/.test(s.password)?"heroicons:check-circle-solid":"heroicons:x-circle-solid",class:a([/\d/.test(s.password)?"text-green-500":"text-gray-400","w-4 h-4"])},null,8,["name","class"]),n("span",{class:a(/\d/.test(s.password)?"text-green-500":"text-gray-500")}," One number ",2)]),n("div",T,[u(o,{name:/[!@#$%^&*()_+\-=\[\]{}\|;:,.<>?/\\~`]/.test(s.password)?"heroicons:check-circle-solid":"heroicons:x-circle-solid",class:a([/[!@#$%^&*()_+\-=\[\]{}\|;:,.<>?/\\~`]/.test(s.password)?"text-green-500":"text-gray-400","w-4 h-4"])},null,8,["name","class"]),n("span",{class:a(/[!@#$%^&*()_+\-=\[\]{}\|;:,.<>?/\\~`]/.test(s.password)?"text-green-500":"text-gray-500")}," One special character ",2)])]))])):x("",!0)}}}),j=Object.assign(V,{__name:"PasswordStrengthMeter"});export{j as _,A as u};
