import{_ as j}from"./JhUiaiGg.js";import{f as v,c as b,o as u,a as e,h as k,m as L,B as N,t as d,n as C,b as o,k as w,ai as F,q as g,j as D,A as S,i as f,F as T,J as A,Q as I,w as y,C as U,S as O}from"#entry";import{_ as q}from"./5MqpBYnd.js";import{_ as E}from"./58jaPDDO.js";const V={class:"flex-shrink-0 border border-base rounded-lg overflow-hidden transition-all duration-300 hover:-translate-y-1 hover:shadow-lg bg-surface-hover cursor-pointer"},Y={class:"w-full h-72 overflow-hidden"},M={class:"p-4 text-base"},W={class:"font-semibold mb-1"},z={class:"text-sm text-muted mb-2.5"},H={key:0,class:"flex items-center gap-1 text-xs mb-1"},J={class:"flex justify-between items-center"},P={class:"flex items-center gap-1 text-xs"},Q={class:"flex items-center"},G={class:"text-sm font-bold text-accent"},K={__name:"DashboardBookCard",props:{book:{type:Object,required:!0},type:{type:String,required:!0,validator:i=>["renting","bought","rented-by-others","bought-by-others"].includes(i)}},setup(i){const t=i,n=v(()=>{switch(t.type){case"renting":return`Renting from ${t.book.from}`;case"bought":return`Bought from ${t.book.from}`;case"rented-by-others":return`Rented by ${t.book.by}`;case"bought-by-others":return`Bought by ${t.book.by}`;default:return""}}),c=v(()=>{const x="inline-block text-xs font-medium px-2.5 py-1 rounded mb-2.5 text-white",a={renting:"bg-blue-600",bought:"bg-green-600","rented-by-others":"bg-purple-600","bought-by-others":"bg-orange-600"}[t.type];return`${x} ${a}`}),r=v(()=>t.type==="renting"&&t.book.returnDate?`Return on ${t.book.returnDate}`:t.type==="rented-by-others"&&t.book.returnDate?`Will be returned on ${t.book.returnDate}`:null),h=v(()=>{switch(t.type){case"renting":case"rented-by-others":return"Total rent cost";case"bought":case"bought-by-others":return"Total cost";default:return"Total cost"}});return(x,a)=>{const l=L,s=w;return u(),b("div",V,[e("div",Y,[t.book?.image?(u(),k(l,{key:0,src:t.book?.image,class:"w-full h-full object-cover",alt:"Auth image"},null,8,["src"])):(u(),k(l,{key:1,src:"/images/noImageImage.jpg",class:"w-full h-full object-cover",alt:"Auth image"}))]),e("div",M,[e("h3",W,d(i.book.title),1),e("p",z,"by "+d(i.book.author),1),e("span",{class:C(c.value)},d(n.value),3),r.value?(u(),b("div",H,[o(s,{name:"mingcute:time-line",class:"w-4 h-4"}),e("span",null,d(r.value),1)])):N("",!0),e("div",J,[e("div",P,[o(s,{name:"material-symbols:shopping-cart-outline-rounded",class:"w-3 h-3"}),e("span",null,d(h.value),1)]),e("div",Q,[o(s,{name:"fluent:book-coins-20-regular",class:"w-5 h-5 text-accent"}),e("span",G,d(i.book.cost),1)])])])])}}},X=()=>{const{$apiFetch:i}=F(),t=g({renting:[],bought:[],"rented-by-others":[],"bought-by-others":[]}),n=g(!1),c=g(null);return{booksData:t,loading:n,error:c,fetchBooksData:async()=>{n.value=!0,c.value=null;try{const s=await i("/api/books/my-books",{credentials:"include"});t.value=s}catch(s){c.value=s?.message||"Failed to fetch books data"}finally{n.value=!1}},fetchRentingBooks:async()=>{n.value=!0,c.value=null;try{const s=await i("/api/books/my-books/renting",{credentials:"include"});t.value.renting=s.renting}catch(s){c.value=s?.message||"Failed to fetch renting books"}finally{n.value=!1}},fetchBoughtBooks:async()=>{n.value=!0,c.value=null;try{const s=await i("/api/books/my-books/bought",{credentials:"include"});t.value.bought=s.bought}catch(s){c.value=s?.message||"Failed to fetch bought books"}finally{n.value=!1}},fetchRentedByOthers:async()=>{n.value=!0,c.value=null;try{const s=await i("/api/books/my-books/lent",{credentials:"include"});t.value["rented-by-others"]=s["rented-by-others"]}catch(s){c.value=s?.message||"Failed to fetch rented by others books"}finally{n.value=!1}},fetchBoughtByOthers:async()=>{n.value=!0,c.value=null;try{const s=await i("/api/books/my-books/sold",{credentials:"include"});t.value["bought-by-others"]=s["bought-by-others"]}catch(s){c.value=s?.message||"Failed to fetch bought by others books"}finally{n.value=!1}}}},Z={class:"w-full bg-background"},ee={class:"mx-auto"},te={key:0,class:"grid grid-cols-4 gap-3"},se={key:1,class:"grid grid-cols-4 gap-3"},oe=["disabled","onClick"],ne={class:"flex items-center gap-1"},ae={class:"text-sm leading-tight"},le={key:0,class:"flex justify-center items-center py-12 h-87"},ce={key:1,class:"w-full"},re={class:"mx-auto py-7"},ie={class:"bg-surface rounded-lg p-6 w-full border border-base"},ue={class:"flex justify-between items-center mb-6"},de={class:"text-2xl font-semibold flex items-center gap-3"},be={class:"text-3xl"},he={key:0,class:"text-center py-12"},me={class:"text-sm text-muted mt-2"},fe=D({__name:"DashboardBookSection",setup(i){const{booksData:t,loading:n,fetchBooksData:c}=X(),r=g("renting"),h=[{id:"renting",label:"Books I'm Renting",icon:"lucide:book-open"},{id:"bought",label:"Books I Bought",icon:"ph:magnifying-glass-bold"},{id:"rented-by-others",label:"Books I'm Lending",icon:"ci-calendar"},{id:"bought-by-others",label:"Books I've Sold",icon:"ci-calendar"}],x=v(()=>h.find(s=>s.id===r.value)||h[0]),a=v(()=>t.value[r.value]||[]),l=s=>({renting:"You haven't rented any books yet. Start exploring available books!",bought:"You haven't purchased any books yet. Check out our collection!","rented-by-others":"No one is renting your books yet. List more books to get started!","bought-by-others":"You haven't sold any books yet. List your books for sale!"})[s]||"No books found in this section";return S(()=>{c()}),(s,m)=>{const p=j,B=w,$=I,R=E;return u(),b("div",Z,[e("div",ee,[f(n)?(u(),b("div",te,[o(p,{class:"h-10 w-full"}),o(p,{class:"h-10 w-full"}),o(p,{class:"h-10 w-full"}),o(p,{class:"h-10 w-full"})])):(u(),b("div",se,[(u(),b(T,null,A(h,_=>e("button",{key:_.id,disabled:f(n),class:C(["px-4 py-3 rounded-lg font-medium transition-all text-center cursor-pointer",r.value===_.id?"bg-accent text-white":"bg-surface text-foreground hover:bg-surface-hover"]),onClick:Ie=>r.value=_.id},[e("div",ne,[o(B,{name:_.icon},null,8,["name"]),e("span",ae,d(_.label),1)])],10,oe)),64))]))]),f(n)?(u(),b("div",le,[o($,{name:"i-heroicons-arrow-path",class:"w-8 h-8 animate-spin text-accent"}),m[0]||(m[0]=e("span",{class:"ml-2 text-muted"},"Loading books...",-1))])):(u(),b("div",ce,[e("div",re,[e("div",ie,[e("div",ue,[e("h2",de,[o(B,{name:x.value.icon},null,8,["name"]),e("span",be,d(x.value.label),1)])]),a.value.length===0?(u(),b("div",he,[o($,{name:"i-heroicons-book-open",class:"w-16 h-16 text-muted mx-auto"}),m[1]||(m[1]=e("p",{class:"text-muted mt-4 text-lg"},"No books found in this section",-1)),e("p",me,d(l(r.value)),1)])):(u(),k(R,{key:1,items:a.value,ui:{item:"basis-full sm:basis-1/2 md:basis-1/3 lg:basis-1/4 xl:basis-1/5 2xl:basis-1/6"},arrows:"",class:"w-full"},{default:y(({item:_})=>[o(K,{book:_,type:r.value,class:"mx-2"},null,8,["book","type"])]),_:1},8,["items"]))])])]))])}}}),xe=Object.assign(fe,{__name:"DashboardBookSection"}),ge=()=>{const{$apiFetch:i}=F(),t=g({books_borrowed:0,currently_lending:0,currently_renting:0,books_sold:0,books_bought:0,total_earnings:0}),n=g(!0),c=g(null),r=g(null),h=async()=>{n.value=!0,r.value=null;try{const l=await i("/api/dashboard/summary",{credentials:"include"});t.value=l}catch(l){r.value=l?.message||"Failed to fetch dashboard summary"}finally{n.value=!1}},x=async()=>{n.value=!0,r.value=null;try{const l=await i("/api/users/me",{credentials:"include"});c.value=l.username}catch(l){r.value=l?.message||"Failed to fetch username"}finally{n.value=!1}};return{summary:t,username:c,loading:n,error:r,fetchAll:async()=>{await Promise.all([h(),x()])}}},_e={class:"flex flex-col min-h-screen w-full pt-4 px-4 md:px-8 lg:px-15"},ye={key:0,class:"flex flex-col gap-2 pt-1"},pe={key:1},ve={class:"text-[42px] font-bold text-base"},ke={class:"w-full mt-4"},we={key:0,class:"flex flex-wrap justify-center gap-6"},Be={key:1,class:"flex flex-wrap justify-center gap-6"},$e={class:"text-2xl font-bold mt-2"},je={class:"text-2xl font-bold mt-2"},Ce={class:"text-2xl font-bold mt-2"},Fe={class:"text-2xl font-bold mt-2"},De={class:"text-2xl font-bold mt-2"},Se={class:"text-2xl font-bold mt-2"},Ae=D({__name:"dashboard",setup(i){const{summary:t,username:n,fetchAll:c,loading:r}=ge();S(()=>{c()});const h=g(!0);return U(()=>r.value,async x=>{x||(await O(),h.value=!1)}),(x,a)=>{const l=j,s=I,m=q,p=w;return u(),b("div",_e,[f(h)?(u(),b("div",ye,[o(l,{class:"h-13 w-150"}),o(l,{class:"h-5 w-50"})])):(u(),b("div",pe,[e("div",ve,"Welcome back, "+d(f(n))+"!",1),a[0]||(a[0]=e("div",{class:"text-sm text-muted ml-1"},"Hereâ€™s your activity overview.",-1))])),e("div",ke,[f(h)?(u(),b("div",we,[o(l,{class:"flex-1 h-[170px]"}),o(l,{class:"flex-1 h-[170px]"}),o(l,{class:"flex-1 h-[170px]"}),o(l,{class:"flex-1 h-[170px]"}),o(l,{class:"flex-1 h-[170px]"}),o(l,{class:"flex-1 h-[170px]"})])):(u(),b("div",Be,[o(m,{class:"flex-1 h-[170px] text-center flex flex-col items-center justify-center bg-surface border-base"},{default:y(()=>[o(s,{name:"i-heroicons-book-open",class:"text-5xl text-[#3B82F6]"}),e("div",$e,d(f(t).books_borrowed),1),a[1]||(a[1]=e("div",{class:"text-sm text-neutral mt-1"},"Books Borrowed",-1))]),_:1}),o(m,{class:"flex-1 h-[170px] text-center flex flex-col items-center justify-center bg-surface border-base"},{default:y(()=>[o(s,{name:"i-heroicons-book-open",class:"text-5xl text-[#3B82F6]"}),e("div",je,d(f(t).currently_lending),1),a[2]||(a[2]=e("div",{class:"text-sm text-neutral mt-1"},"Currently Lending",-1))]),_:1}),o(m,{class:"flex-1 h-[170px] text-center flex flex-col items-center justify-center bg-surface border-base"},{default:y(()=>[o(s,{name:"i-heroicons-book-open",class:"text-5xl text-[#3B82F6]"}),e("div",Ce,d(f(t).currently_renting),1),a[3]||(a[3]=e("div",{class:"text-sm text-neutral mt-1"},"Currently Renting",-1))]),_:1}),o(m,{class:"flex-1 h-[170px] text-center flex flex-col items-center justify-center bg-surface border-base"},{default:y(()=>[o(s,{name:"i-heroicons-book-open",class:"text-5xl text-[#3B82F6]"}),e("div",Fe,d(f(t).books_sold),1),a[4]||(a[4]=e("div",{class:"text-sm text-neutral mt-1"},"Books Sold",-1))]),_:1}),o(m,{class:"flex-1 h-[170px] text-center flex flex-col items-center justify-center bg-surface border-base"},{default:y(()=>[o(s,{name:"i-heroicons-book-open",class:"text-5xl text-[#3B82F6]"}),e("div",De,d(f(t).books_bought),1),a[5]||(a[5]=e("div",{class:"text-sm text-neutral mt-1"},"Books Bought",-1))]),_:1}),o(m,{class:"flex-1 h-[170px] text-center flex flex-col items-center justify-center bg-surface border-base"},{default:y(()=>[o(p,{name:"fluent:book-coins-20-regular",class:"text-5xl text-accent"}),e("div",Se,d(f(t).total_earnings),1),a[6]||(a[6]=e("div",{class:"text-sm text-neutral mt-1"},"Total Earnings",-1))]),_:1})])),o(xe,{class:"pt-10"})])])}}});export{Ae as default};
