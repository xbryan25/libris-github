import{p as y,c as f,o as m,a as e,f as p,U as R,E as $,t as i,D,b as a,g as k,W as j,x,e as C,I as F,X as N,Y as L,k as h,Z as I,w as _}from"#entry";import{_ as T}from"./DJSAEPoY.js";import{_ as A}from"./C-Fr4X5q.js";const O={class:"flex-shrink-0 border border-base rounded-lg overflow-hidden transition-all duration-300 hover:-translate-y-1 hover:shadow-lg bg-surface-hover cursor-pointer"},U={class:"w-full h-72 overflow-hidden"},E={class:"p-4 text-base"},Y={class:"font-semibold mb-1"},V={class:"text-sm text-muted mb-2.5"},W={key:0,class:"flex items-center gap-1 text-xs mb-1"},q={class:"flex justify-between items-center"},M={class:"flex items-center gap-1 text-xs"},z={class:"flex items-center"},H={class:"text-sm font-bold text-accent"},P={__name:"DashboardBookCard",props:{book:{type:Object,required:!0},type:{type:String,required:!0,validator:r=>["renting","bought","rented-by-others","bought-by-others"].includes(r)}},setup(r){const t=r,o=y(()=>{switch(t.type){case"renting":return`Renting from ${t.book.from}`;case"bought":return`Bought from ${t.book.from}`;case"rented-by-others":return`Rented by ${t.book.by}`;case"bought-by-others":return`Bought by ${t.book.by}`;default:return""}}),l=y(()=>{const b="inline-block text-xs font-medium px-2.5 py-1 rounded mb-2.5 text-white",u={renting:"bg-blue-600",bought:"bg-green-600","rented-by-others":"bg-purple-600","bought-by-others":"bg-orange-600"}[t.type];return`${b} ${u}`}),c=y(()=>t.type==="renting"&&t.book.returnDate?`Return on ${t.book.returnDate}`:t.type==="rented-by-others"&&t.book.returnDate?`Will be returned on ${t.book.returnDate}`:null),n=y(()=>{switch(t.type){case"renting":case"rented-by-others":return"Total rent cost";case"bought":case"bought-by-others":return"Total cost";default:return"Total cost"}});return(b,u)=>{const d=R,s=k;return m(),f("div",O,[e("div",U,[t.book?.image?(m(),p(d,{key:0,src:t.book?.image,class:"w-full h-full object-cover",alt:"Auth image"},null,8,["src"])):(m(),p(d,{key:1,src:"/images/noImageImage.jpg",class:"w-full h-full object-cover",alt:"Auth image"}))]),e("div",E,[e("h3",Y,i(r.book.title),1),e("p",V,"by "+i(r.book.author),1),e("span",{class:D(l.value)},i(o.value),3),c.value?(m(),f("div",W,[a(s,{name:"mingcute:time-line",class:"w-4 h-4"}),e("span",null,i(c.value),1)])):$("",!0),e("div",q,[e("div",M,[a(s,{name:"material-symbols:shopping-cart-outline-rounded",class:"w-3 h-3"}),e("span",null,i(n.value),1)]),e("div",z,[a(s,{name:"fluent:book-coins-20-regular",class:"w-5 h-5 text-accent"}),e("span",H,i(r.book.cost),1)])])])])}}},X=()=>{const{$apiFetch:r}=j(),t=x({renting:[],bought:[],"rented-by-others":[],"bought-by-others":[]}),o=x(!1),l=x(null);return{booksData:t,loading:o,error:l,fetchBooksData:async()=>{o.value=!0,l.value=null;try{const s=await r("/api/books/my-books",{credentials:"include"});t.value=s}catch(s){l.value=s?.message||"Failed to fetch books data"}finally{o.value=!1}},fetchRentingBooks:async()=>{o.value=!0,l.value=null;try{const s=await r("/api/books/my-books/renting",{credentials:"include"});t.value.renting=s.renting}catch(s){l.value=s?.message||"Failed to fetch renting books"}finally{o.value=!1}},fetchBoughtBooks:async()=>{o.value=!0,l.value=null;try{const s=await r("/api/books/my-books/bought",{credentials:"include"});t.value.bought=s.bought}catch(s){l.value=s?.message||"Failed to fetch bought books"}finally{o.value=!1}},fetchRentedByOthers:async()=>{o.value=!0,l.value=null;try{const s=await r("/api/books/my-books/lent",{credentials:"include"});t.value["rented-by-others"]=s["rented-by-others"]}catch(s){l.value=s?.message||"Failed to fetch rented by others books"}finally{o.value=!1}},fetchBoughtByOthers:async()=>{o.value=!0,l.value=null;try{const s=await r("/api/books/my-books/sold",{credentials:"include"});t.value["bought-by-others"]=s["bought-by-others"]}catch(s){l.value=s?.message||"Failed to fetch bought by others books"}finally{o.value=!1}}}},Z={class:"w-full bg-background"},G={class:"mx-auto"},J={class:"grid grid-cols-4 gap-3"},K=["onClick","disabled"],Q={class:"flex items-center gap-1"},ee={class:"text-sm leading-tight"},te={key:0,class:"flex justify-center items-center py-12"},se={key:1,class:"w-full"},oe={class:"mx-auto py-7"},ne={class:"bg-surface rounded-lg p-6 w-full border border-base"},ae={class:"flex justify-between items-center mb-6"},le={class:"text-2xl font-semibold flex items-center gap-3"},re={class:"text-3xl"},ce={key:0,class:"px-4 py-2 bg-surface-hover hover:bg-accent hover:text-white rounded-md font-medium cursor-pointer transition-colors"},ie={key:0,class:"text-center py-12"},ue={class:"text-sm text-muted mt-2"},de=C({__name:"DashboardBookSection",setup(r){const{booksData:t,loading:o,fetchBooksData:l}=X(),c=x("renting"),n=[{id:"renting",label:"Books I'm Renting",icon:"lucide:book-open"},{id:"bought",label:"Books I Bought",icon:"ph:magnifying-glass-bold"},{id:"rented-by-others",label:"Books I'm Lending",icon:"ci-calendar"},{id:"bought-by-others",label:"Books I've Sold",icon:"ci-calendar"}],b=y(()=>n.find(s=>s.id===c.value)||n[0]),u=y(()=>t.value[c.value]||[]),d=s=>({renting:"You haven't rented any books yet. Start exploring available books!",bought:"You haven't purchased any books yet. Check out our collection!","rented-by-others":"No one is renting your books yet. List more books to get started!","bought-by-others":"You haven't sold any books yet. List your books for sale!"})[s]||"No books found in this section";return F(()=>{l()}),(s,v)=>{const B=k,w=I,S=A;return m(),f("div",Z,[e("div",G,[e("div",J,[(m(),f(N,null,L(n,g=>e("button",{key:g.id,onClick:we=>c.value=g.id,class:D(["px-4 py-3 rounded-lg font-medium transition-all text-center cursor-pointer",c.value===g.id?"bg-accent text-white":"bg-surface text-foreground hover:bg-surface-hover"]),disabled:h(o)},[e("div",Q,[a(B,{name:g.icon},null,8,["name"]),e("span",ee,i(g.label),1)])],10,K)),64))])]),h(o)?(m(),f("div",te,[a(w,{name:"i-heroicons-arrow-path",class:"w-8 h-8 animate-spin text-accent"}),v[0]||(v[0]=e("span",{class:"ml-2 text-muted"},"Loading books...",-1))])):(m(),f("div",se,[e("div",oe,[e("div",ne,[e("div",ae,[e("h2",le,[a(B,{name:b.value.icon},null,8,["name"]),e("span",re,i(b.value.label),1)]),u.value.length>0?(m(),f("button",ce," See more ")):$("",!0)]),u.value.length===0?(m(),f("div",ie,[a(w,{name:"i-heroicons-book-open",class:"w-16 h-16 text-muted mx-auto"}),v[1]||(v[1]=e("p",{class:"text-muted mt-4 text-lg"},"No books found in this section",-1)),e("p",ue,i(d(c.value)),1)])):(m(),p(S,{key:1,items:u.value,ui:{item:"basis-full sm:basis-1/2 md:basis-1/3 lg:basis-1/4 xl:basis-1/5 2xl:basis-1/6"},arrows:"",class:"w-full"},{default:_(({item:g})=>[a(P,{book:g,type:c.value,class:"mx-2"},null,8,["book","type"])]),_:1},8,["items"]))])])]))])}}}),be=Object.assign(de,{__name:"DashboardBookSection"}),me=()=>{const{$apiFetch:r}=j(),t=x({books_borrowed:0,currently_lending:0,currently_renting:0,books_sold:0,books_bought:0,total_earnings:0}),o=x(!1),l=x(null),c=x(null),n=async()=>{o.value=!0,c.value=null;try{const d=await r("/api/dashboard/summary",{credentials:"include"});t.value=d}catch(d){c.value=d?.message||"Failed to fetch dashboard summary"}finally{o.value=!1}},b=async()=>{o.value=!0,c.value=null;try{const d=await r("/api/users/me",{credentials:"include"});l.value=d.username}catch(d){c.value=d?.message||"Failed to fetch username"}finally{o.value=!1}};return{summary:t,username:l,loading:o,error:c,fetchAll:async()=>{await Promise.all([n(),b()])}}},he={class:"flex flex-col min-h-screen w-full pt-4 px-4 md:px-8 lg:px-15"},fe={class:"text-[42px] font-bold text-base"},xe={class:"w-full mt-4"},ge={class:"flex flex-wrap justify-center gap-6"},_e={class:"text-2xl font-bold mt-2"},ye={class:"text-2xl font-bold mt-2"},ve={class:"text-2xl font-bold mt-2"},pe={class:"text-2xl font-bold mt-2"},ke={class:"text-2xl font-bold mt-2"},Be={class:"text-2xl font-bold mt-2"},Ce=C({__name:"dashboard",setup(r){const{summary:t,username:o,fetchAll:l}=me();return F(()=>{l()}),(c,n)=>{const b=I,u=T,d=k;return m(),f("div",he,[e("div",fe,"Welcome back, "+i(h(o))+"!",1),n[6]||(n[6]=e("div",{class:"text-sm text-muted ml-1"},"Hereâ€™s your activity overview.",-1)),e("div",xe,[e("div",ge,[a(u,{class:"flex-1 h-[170px] text-center flex flex-col items-center justify-center bg-surface border-base"},{default:_(()=>[a(b,{name:"i-heroicons-book-open",class:"text-5xl text-[#3B82F6]"}),e("div",_e,i(h(t).books_borrowed),1),n[0]||(n[0]=e("div",{class:"text-sm text-neutral mt-1"},"Books Borrowed",-1))]),_:1}),a(u,{class:"flex-1 h-[170px] text-center flex flex-col items-center justify-center bg-surface border-base"},{default:_(()=>[a(b,{name:"i-heroicons-book-open",class:"text-5xl text-[#3B82F6]"}),e("div",ye,i(h(t).currently_lending),1),n[1]||(n[1]=e("div",{class:"text-sm text-neutral mt-1"},"Currently Lending",-1))]),_:1}),a(u,{class:"flex-1 h-[170px] text-center flex flex-col items-center justify-center bg-surface border-base"},{default:_(()=>[a(b,{name:"i-heroicons-book-open",class:"text-5xl text-[#3B82F6]"}),e("div",ve,i(h(t).currently_renting),1),n[2]||(n[2]=e("div",{class:"text-sm text-neutral mt-1"},"Currently Renting",-1))]),_:1}),a(u,{class:"flex-1 h-[170px] text-center flex flex-col items-center justify-center bg-surface border-base"},{default:_(()=>[a(b,{name:"i-heroicons-book-open",class:"text-5xl text-[#3B82F6]"}),e("div",pe,i(h(t).books_sold),1),n[3]||(n[3]=e("div",{class:"text-sm text-neutral mt-1"},"Books Sold",-1))]),_:1}),a(u,{class:"flex-1 h-[170px] text-center flex flex-col items-center justify-center bg-surface border-base"},{default:_(()=>[a(b,{name:"i-heroicons-book-open",class:"text-5xl text-[#3B82F6]"}),e("div",ke,i(h(t).books_bought),1),n[4]||(n[4]=e("div",{class:"text-sm text-neutral mt-1"},"Books Bought",-1))]),_:1}),a(u,{class:"flex-1 h-[170px] text-center flex flex-col items-center justify-center bg-surface border-base"},{default:_(()=>[a(d,{name:"fluent:book-coins-20-regular",class:"text-5xl text-accent"}),e("div",Be,i(h(t).total_earnings),1),n[5]||(n[5]=e("div",{class:"text-sm text-neutral mt-1"},"Total Earnings",-1))]),_:1})]),a(be,{class:"pt-10"})])])}}});export{Ce as default};
