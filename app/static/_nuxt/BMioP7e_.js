import{H as ze,e as je,aT as Ke,aQ as We,f as q,g as Ie,h as y,o as u,w as C,b as c,a as o,i as r,n as $,B as k,l as ue,L as pe,r as de,d as G,t as g,c as w,F as B,J as N,q as A,v as _e,ai as we,S as re,aB as Je,O as R,M as I,aU as Ye,j as be,aN as De,C as oe,k as Te,x as Re,A as ge,Q as Be,az as Ge,aA as Qe,_ as Xe}from"#entry";import{_ as Ve}from"./5MqpBYnd.js";import{_ as Ze}from"./58jaPDDO.js";import{_ as Ae}from"./CoCDlcmg.js";import{_ as et}from"./DVL47Mpl.js";import{_ as He}from"./CBf3hF8c.js";import{R as tt,C as st,$ as Me,a as Oe,b as ke,_ as Ee}from"./B1FJlU1A.js";import{_ as Le}from"./BdGgjiO2.js";import{u as Pe}from"./DFFHip2M.js";import{u as nt}from"./CJg1BRzH.js";import{u as it}from"./Qdc9UZxI.js";import"./DJUnOCSR.js";import"./BYnHXhte.js";import"./BX4pJY_y.js";import"./C7gYzAMW.js";import"./CxmxAOEW.js";import"./DNBF-Q6I.js";import"./QkSgYxCE.js";import"./DGycg10u.js";import"./kRIii9yh.js";import"./B8ufzAAH.js";const at={slots:{root:"",header:"flex items-center justify-between",body:"flex flex-col space-y-4 pt-4 sm:flex-row sm:space-x-4 sm:space-y-0",heading:"text-center font-medium truncate mx-auto",grid:"w-full border-collapse select-none space-y-1 focus:outline-none",gridRow:"grid grid-cols-7 place-items-center",gridWeekDaysRow:"mb-1 grid w-full grid-cols-7",gridBody:"grid",headCell:"rounded-md",cell:"relative text-center",cellTrigger:["m-0.5 relative flex items-center justify-center rounded-full whitespace-nowrap focus-visible:ring-2 focus:outline-none data-disabled:text-muted data-unavailable:line-through data-unavailable:text-muted data-unavailable:pointer-events-none data-[selected]:text-inverted data-today:font-semibold data-[outside-view]:text-muted","transition"]},variants:{color:{primary:{headCell:"text-primary",cellTrigger:"focus-visible:ring-primary data-[selected]:bg-primary data-today:not-data-[selected]:text-primary data-[highlighted]:bg-primary/20 hover:not-data-[selected]:bg-primary/20"},secondary:{headCell:"text-secondary",cellTrigger:"focus-visible:ring-secondary data-[selected]:bg-secondary data-today:not-data-[selected]:text-secondary data-[highlighted]:bg-secondary/20 hover:not-data-[selected]:bg-secondary/20"},success:{headCell:"text-success",cellTrigger:"focus-visible:ring-success data-[selected]:bg-success data-today:not-data-[selected]:text-success data-[highlighted]:bg-success/20 hover:not-data-[selected]:bg-success/20"},info:{headCell:"text-info",cellTrigger:"focus-visible:ring-info data-[selected]:bg-info data-today:not-data-[selected]:text-info data-[highlighted]:bg-info/20 hover:not-data-[selected]:bg-info/20"},warning:{headCell:"text-warning",cellTrigger:"focus-visible:ring-warning data-[selected]:bg-warning data-today:not-data-[selected]:text-warning data-[highlighted]:bg-warning/20 hover:not-data-[selected]:bg-warning/20"},error:{headCell:"text-error",cellTrigger:"focus-visible:ring-error data-[selected]:bg-error data-today:not-data-[selected]:text-error data-[highlighted]:bg-error/20 hover:not-data-[selected]:bg-error/20"},neutral:{headCell:"text-highlighted",cellTrigger:"focus-visible:ring-inverted data-[selected]:bg-inverted data-today:not-data-[selected]:text-highlighted data-[highlighted]:bg-inverted/20 hover:not-data-[selected]:bg-inverted/10"}},size:{xs:{heading:"text-xs",cell:"text-xs",headCell:"text-[10px]",cellTrigger:"size-7",body:"space-y-2 pt-2"},sm:{heading:"text-xs",headCell:"text-xs",cell:"text-xs",cellTrigger:"size-7"},md:{heading:"text-sm",headCell:"text-xs",cell:"text-sm",cellTrigger:"size-8"},lg:{heading:"text-md",headCell:"text-md",cellTrigger:"size-9 text-md"},xl:{heading:"text-lg",headCell:"text-lg",cellTrigger:"size-10 text-lg"}}},defaultVariants:{size:"md",color:"primary"}},$e={__name:"UCalendar",props:{as:{type:null,required:!1},nextYearIcon:{type:[String,Object],required:!1},nextYear:{type:Object,required:!1},nextMonthIcon:{type:[String,Object],required:!1},nextMonth:{type:Object,required:!1},prevYearIcon:{type:[String,Object],required:!1},prevYear:{type:Object,required:!1},prevMonthIcon:{type:[String,Object],required:!1},prevMonth:{type:Object,required:!1},color:{type:null,required:!1},size:{type:null,required:!1},range:{type:Boolean,required:!1},multiple:{type:Boolean,required:!1},monthControls:{type:Boolean,required:!1,default:!0},yearControls:{type:Boolean,required:!1,default:!0},defaultValue:{type:null,required:!1},modelValue:{type:null,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1},defaultPlaceholder:{type:null,required:!1},placeholder:{type:null,required:!1},allowNonContiguousRanges:{type:Boolean,required:!1},pagedNavigation:{type:Boolean,required:!1},preventDeselect:{type:Boolean,required:!1},maximumDays:{type:Number,required:!1},weekStartsOn:{type:Number,required:!1},weekdayFormat:{type:String,required:!1},fixedWeeks:{type:Boolean,required:!1,default:!0},maxValue:{type:null,required:!1},minValue:{type:null,required:!1},numberOfMonths:{type:Number,required:!1},disabled:{type:Boolean,required:!1},readonly:{type:Boolean,required:!1},initialFocus:{type:Boolean,required:!1},isDateDisabled:{type:Function,required:!1},isDateUnavailable:{type:Function,required:!1},isDateHighlightable:{type:Function,required:!1},nextPage:{type:Function,required:!1},prevPage:{type:Function,required:!1},disableDaysOutsideCurrentView:{type:Boolean,required:!1},fixedDate:{type:String,required:!1}},emits:["update:modelValue","update:placeholder","update:validModelValue","update:startValue"],setup(e,{emit:t}){const s=e,a=t,{code:l,dir:n,t:h}=ze(),i=je(),m=Ke(We(s,"range","modelValue","defaultValue","color","size","monthControls","yearControls","class","ui"),a),d=q(()=>s.nextYearIcon||(n.value==="rtl"?i.ui.icons.chevronDoubleLeft:i.ui.icons.chevronDoubleRight)),T=q(()=>s.nextMonthIcon||(n.value==="rtl"?i.ui.icons.chevronLeft:i.ui.icons.chevronRight)),M=q(()=>s.prevYearIcon||(n.value==="rtl"?i.ui.icons.chevronDoubleRight:i.ui.icons.chevronDoubleLeft)),O=q(()=>s.prevMonthIcon||(n.value==="rtl"?i.ui.icons.chevronRight:i.ui.icons.chevronLeft)),V=q(()=>Ie({extend:Ie(at),...i.ui?.calendar||{}})({color:s.color,size:s.size}));function Q(D,b){return b===-1?D.subtract({years:1}):D.add({years:1})}const E=q(()=>s.range?tt:st);return(D,b)=>(u(),y(r(E).Root,pe(r(m),{"model-value":e.modelValue,"default-value":e.defaultValue,locale:r(l),dir:r(n),class:V.value.root({class:[s.ui?.root,s.class]})}),{default:C(({weekDays:K,grid:J})=>[c(r(E).Header,{class:$(V.value.header({class:s.ui?.header}))},{default:C(()=>[s.yearControls?(u(),y(r(E).Prev,{key:0,"prev-page":S=>Q(S,-1),"aria-label":r(h)("calendar.prevYear"),"as-child":""},{default:C(()=>[c(ue,pe({icon:M.value,size:s.size,color:"neutral",variant:"ghost"},s.prevYear),null,16,["icon","size"])]),_:1},8,["prev-page","aria-label"])):k("",!0),s.monthControls?(u(),y(r(E).Prev,{key:1,"aria-label":r(h)("calendar.prevMonth"),"as-child":""},{default:C(()=>[c(ue,pe({icon:O.value,size:s.size,color:"neutral",variant:"ghost"},s.prevMonth),null,16,["icon","size"])]),_:1},8,["aria-label"])):k("",!0),c(r(E).Heading,{class:$(V.value.heading({class:s.ui?.heading}))},{default:C(({headingValue:S})=>[de(D.$slots,"heading",{value:S},()=>[G(g(S),1)])]),_:3},8,["class"]),s.monthControls?(u(),y(r(E).Next,{key:2,"aria-label":r(h)("calendar.nextMonth"),"as-child":""},{default:C(()=>[c(ue,pe({icon:T.value,size:s.size,color:"neutral",variant:"ghost"},s.nextMonth),null,16,["icon","size"])]),_:1},8,["aria-label"])):k("",!0),s.yearControls?(u(),y(r(E).Next,{key:3,"next-page":S=>Q(S,1),"aria-label":r(h)("calendar.nextYear"),"as-child":""},{default:C(()=>[c(ue,pe({icon:d.value,size:s.size,color:"neutral",variant:"ghost"},s.nextYear),null,16,["icon","size"])]),_:1},8,["next-page","aria-label"])):k("",!0)]),_:3},8,["class"]),o("div",{class:$(V.value.body({class:s.ui?.body}))},[(u(!0),w(B,null,N(J,S=>(u(),y(r(E).Grid,{key:S.value.toString(),class:$(V.value.grid({class:s.ui?.grid}))},{default:C(()=>[c(r(E).GridHead,null,{default:C(()=>[c(r(E).GridRow,{class:$(V.value.gridWeekDaysRow({class:s.ui?.gridWeekDaysRow}))},{default:C(()=>[(u(!0),w(B,null,N(K,F=>(u(),y(r(E).HeadCell,{key:F,class:$(V.value.headCell({class:s.ui?.headCell}))},{default:C(()=>[de(D.$slots,"week-day",{day:F},()=>[G(g(F),1)])]),_:2},1032,["class"]))),128))]),_:2},1032,["class"])]),_:2},1024),c(r(E).GridBody,{class:$(V.value.gridBody({class:s.ui?.gridBody}))},{default:C(()=>[(u(!0),w(B,null,N(S.rows,(F,U)=>(u(),y(r(E).GridRow,{key:`weekDate-${U}`,class:$(V.value.gridRow({class:s.ui?.gridRow}))},{default:C(()=>[(u(!0),w(B,null,N(F,X=>(u(),y(r(E).Cell,{key:X.toString(),date:X,class:$(V.value.cell({class:s.ui?.cell}))},{default:C(()=>[c(r(E).CellTrigger,{day:X,month:S.value,class:$(V.value.cellTrigger({class:s.ui?.cellTrigger}))},{default:C(()=>[de(D.$slots,"day",{day:X},()=>[G(g(X.day),1)])]),_:2},1032,["day","month","class"])]),_:2},1032,["date","class"]))),128))]),_:2},1032,["class"]))),128))]),_:2},1032,["class"])]),_:2},1032,["class"]))),128))],2)]),_:3},16,["model-value","default-value","locale","dir","class"]))}},ve="http://127.0.0.1:8080",Ce=()=>{const e=A(!1),t=A(!1),s=A(null),a=_e(),{$apiFetch:l}=we();return{loading:t,error:s,createRental:async i=>{t.value=!0,s.value=null;try{await l(`${ve}/api/wallets/update-reserved-amount`,{method:"PATCH",body:{amount_to_reserve:i.totalRentCost},credentials:"include"});const m=await l(`${ve}/api/rentals/create`,{method:"POST",body:i,credentials:"include"});return a.add({title:"Success",description:"Rental request sent successfully",color:"success"}),m}catch(m){throw s.value=m?.data?.message||m?.data?.error||m?.message||"Failed to process rental",a.add({title:"Error",description:s.value??"Failed to process rental",color:"error"}),m}finally{t.value=!1}},checkRentalExists:async i=>{try{const m=await l(`${ve}/api/rentals/check/${i}`,{method:"GET",credentials:"include"});e.value=m.exists}catch(m){console.error(m)}},rentalExists:e}},ae={HOUR_TOKENS:["HH","H","hh","h","kk","k"],MINUTE_TOKENS:["mm","m"],SECOND_TOKENS:["ss","s"],APM_TOKENS:["A","a"],BASIC_TYPES:["hour","minute","second","apm"]},fe={format:"HH:mm",minuteInterval:1,secondInterval:1,hourRange:null,minuteRange:null,secondRange:null,hideDisabledHours:!1,hideDisabledMinutes:!1,hideDisabledSeconds:!1,hideDisabledItems:!1,advancedKeyboard:!1,hideDropdown:!1,blurDelay:300,manualInputTimeout:1e3,dropOffsetHeight:160};var ce={name:"VueTimepicker",props:{modelValue:{type:[Object,String]},format:{type:String},minuteInterval:{type:[Number,String]},secondInterval:{type:[Number,String]},hourRange:{type:Array},minuteRange:{type:Array},secondRange:{type:Array},hideDisabledHours:{type:Boolean,default:!1},hideDisabledMinutes:{type:Boolean,default:!1},hideDisabledSeconds:{type:Boolean,default:!1},hideDisabledItems:{type:Boolean,default:!1},hideClearButton:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},closeOnComplete:{type:Boolean,default:!1},id:{type:String},name:{type:String},inputClass:{type:[String,Object,Array]},placeholder:{type:String},tabindex:{type:[Number,String],default:0},inputWidth:{type:String},autocomplete:{type:String,default:"off"},hourLabel:{type:String},minuteLabel:{type:String},secondLabel:{type:String},apmLabel:{type:String},amText:{type:String},pmText:{type:String},blurDelay:{type:[Number,String]},advancedKeyboard:{type:Boolean,default:!1},lazy:{type:Boolean,default:!1},autoScroll:{type:Boolean,default:!1},dropDirection:{type:String,default:"down"},dropOffsetHeight:{type:[Number,String]},containerId:{type:String},manualInput:{type:Boolean,default:!1},manualInputTimeout:{type:[Number,String]},hideDropdown:{type:Boolean,default:!1},fixedDropdownButton:{type:Boolean,default:!1},debugMode:{type:Boolean,default:!1}},data(){return{timeValue:{},hours:[],minutes:[],seconds:[],apms:[],isActive:!1,showDropdown:!1,isFocusing:!1,debounceTimer:void 0,hourType:"HH",minuteType:"mm",secondType:"",apmType:"",hour:"",minute:"",second:"",apm:"",fullValues:void 0,bakDisplayTime:void 0,doClearApmChecking:!1,selectionTimer:void 0,kbInputTimer:void 0,kbInputLog:"",bakCurrentPos:void 0,forceDropOnTop:!1}},emits:["update:modelValue","change","open","close","focus","blur","error"],computed:{opts(){const e=Object.assign({},fe);return this.format&&this.format.length&&(e.format=String(this.format)),this.isNumber(this.minuteInterval)&&(e.minuteInterval=+this.minuteInterval),(!e.minuteInterval||e.minuteInterval<1||e.minuteInterval>60)&&(this.debugMode&&(e.minuteInterval>60?this.debugLog(`"minute-interval" should be less than 60. Current value is ${this.minuteInterval}`):(e.minuteInterval===0||e.minuteInterval<1)&&this.debugLog(`"minute-interval" should be NO less than 1. Current value is ${this.minuteInterval}`)),e.minuteInterval===0?e.minuteInterval=60:e.minuteInterval=1),this.isNumber(this.secondInterval)&&(e.secondInterval=+this.secondInterval),(!e.secondInterval||e.secondInterval<1||e.secondInterval>60)&&(this.debugMode&&(e.secondInterval>60?this.debugLog(`"second-interval" should be less than 60. Current value is ${this.secondInterval}`):(e.secondInterval===0||e.secondInterval<1)&&this.debugLog(`"second-interval" should be NO less than 1. Current value is ${this.secondInterval}`)),e.secondInterval===0?e.secondInterval=60:e.secondInterval=1),this.hourRange&&Array.isArray(this.hourRange)&&(e.hourRange=JSON.parse(JSON.stringify(this.hourRange)),!this.hourRange.length&&this.debugMode&&this.debugLog('The "hour-range" array is empty (length === 0)')),this.minuteRange&&Array.isArray(this.minuteRange)&&(e.minuteRange=JSON.parse(JSON.stringify(this.minuteRange)),!this.minuteRange.length&&this.debugMode&&this.debugLog('The "minute-range" array is empty (length === 0)')),this.secondRange&&Array.isArray(this.secondRange)&&(e.secondRange=JSON.parse(JSON.stringify(this.secondRange)),!this.secondRange.length&&this.debugMode&&this.debugLog('The "second-range" array is empty (length === 0)')),this.hideDisabledItems&&(e.hideDisabledItems=!0),(this.hideDisabledHours||this.hideDisabledItems)&&(e.hideDisabledHours=!0),(this.hideDisabledMinutes||this.hideDisabledItems)&&(e.hideDisabledMinutes=!0),(this.hideDisabledSeconds||this.hideDisabledItems)&&(e.hideDisabledSeconds=!0),this.hideDropdown&&(this.manualInput?e.hideDropdown=!0:this.debugMode&&this.debugLog('"hide-dropdown" only works with "manual-input" mode')),this.blurDelay&&+this.blurDelay>0&&(e.blurDelay=+this.blurDelay),this.manualInputTimeout&&+this.manualInputTimeout>0&&(e.manualInputTimeout=+this.manualInputTimeout),this.dropOffsetHeight&&+this.dropOffsetHeight>0&&(e.dropOffsetHeight=+this.dropOffsetHeight),e},useStringValue(){return typeof this.modelValue=="string"},formatString(){return this.opts.format||fe.format},inUse(){const e=ae.BASIC_TYPES.filter(s=>this.getTokenByType(s));e.sort((s,a)=>this.formatString.indexOf(this.getTokenByType(s)||null)-this.formatString.indexOf(this.getTokenByType(a)||null));const t=e.map(s=>this.getTokenByType(s));return{hour:!!this.hourType,minute:!!this.minuteType,second:!!this.secondType,apm:!!this.apmType,types:e||[],tokens:t||[]}},displayTime(){let e=String(this.formatString);return this.hour&&(e=e.replace(new RegExp(this.hourType,"g"),this.hour)),this.minute&&(e=e.replace(new RegExp(this.minuteType,"g"),this.minute)),this.second&&this.secondType&&(e=e.replace(new RegExp(this.secondType,"g"),this.second)),this.apm&&this.apmType&&(e=e.replace(new RegExp(this.apmType,"g"),this.apm)),e},customDisplayTime(){return!this.amText&&!this.pmText?this.displayTime:this.displayTime.replace(new RegExp(this.apm,"g"),this.apmDisplayText(this.apm))},inputIsEmpty(){return this.formatString===this.displayTime},allValueSelected(){return!(this.inUse.hour&&!this.hour||this.inUse.minute&&!this.minute||this.inUse.second&&!this.second||this.inUse.apm&&!this.apm)},columnsSequence(){return this.inUse.types.map(e=>e)||[]},showClearBtn(){return this.hideClearButton||this.disabled?!1:!this.inputIsEmpty},showDropdownBtn(){return!!(this.fixedDropdownButton||this.opts.hideDropdown&&this.isActive&&!this.showDropdown)},baseOn12Hours(){return this.hourType==="h"||this.hourType==="hh"},hourRangeIn24HrFormat(){if(!this.hourType||!this.opts.hourRange)return!1;if(!this.opts.hourRange.length)return[];const e=[];return this.opts.hourRange.forEach(t=>{if(t instanceof Array){t.length>2&&this.debugMode&&this.debugLog(`Nested array within "hour-range" must contain no more than two items. Only the first two items of ${JSON.stringify(t)} will be taken into account.`);let s=t[0],a=t[1]||t[0];this.is12hRange(s)&&(s=this.translate12hRange(s)),this.is12hRange(a)&&(a=this.translate12hRange(a));for(let l=+s;l<=+a;l++)l<0||l>24||e.includes(l)||e.push(l)}else{if(this.is12hRange(t)?t=this.translate12hRange(t):t=+t,t<0||t>24)return;e.includes(t)||e.push(t)}}),e.sort((t,s)=>t-s),e},restrictedHourRange(){return this.hourRangeIn24HrFormat?this.baseOn12Hours?this.hourRangeIn24HrFormat.map(t=>t===12?"12p":t===24||t===0?"12a":t>12?`${t%12}p`:`${t}a`):this.hourRangeIn24HrFormat:!1},validHoursList(){if(!this.manualInput)return!1;if(this.restrictedHourRange){let e=[];if(this.baseOn12Hours){e=this.restrictedHourRange.map(s=>{const a=s.substr(0,s.length-1),l=s.substr(-1);return`${this.formatValue(this.hourType,a)}${l}`});const t=e.indexOf("12a");return t>0&&e.unshift(e.splice(t,1)[0]),e}return e=this.restrictedHourRange.map(t=>this.formatValue(this.hourType,t)),e.length>1&&e[0]&&e[0]==="24"&&e.push(e.shift()),e}return this.baseOn12Hours?[].concat([],this.hours.map(e=>`${e}a`),this.hours.map(e=>`${e}p`)):this.hours},has(){const e={customApmText:!1},t=!!this.apmType;if(t&&this.hourRangeIn24HrFormat&&this.hourRangeIn24HrFormat.length){const s=[].concat([],this.hourRangeIn24HrFormat);e.am=s.some(a=>a<12||a===24),e.pm=s.some(a=>a>=12&&a<24)}else e.am=t,e.pm=t;return(this.amText&&this.amText.length||this.pmText&&this.pmText.length)&&(e.customApmText=!0),e},minuteRangeList(){return!this.minuteType||!this.opts.minuteRange?!1:this.opts.minuteRange.length?this.renderRangeList(this.opts.minuteRange,"minute"):[]},secondRangeList(){return!this.secondType||!this.opts.secondRange?!1:this.opts.secondRange.length?this.renderRangeList(this.opts.secondRange,"second"):[]},hourLabelText(){return this.hourLabel||this.hourType},minuteLabelText(){return this.minuteLabel||this.minuteType},secondLabelText(){return this.secondLabel||this.secondType},apmLabelText(){return this.apmLabel||this.apmType},inputWidthStyle(){if(!(!this.inputWidth||!this.inputWidth.length))return{width:this.inputWidth}},tokenRegexBase(){return this.inUse.tokens.join("|")},tokenChunks(){if(!this.manualInput&&!this.useStringValue)return!1;const e=String(this.formatString),t=`(${this.tokenRegexBase})+?`,s=this.getMatchAllByRegex(e,t),a=[];for(let l of s){const n=l[0],h={index:l.index,token:n,type:this.getTokenType(n),needsCalibrate:n.length<2,len:(n||"").length};a.push(h)}return a},needsPosCalibrate(){return this.manualInput?this.tokenChunks.some(e=>e.needsCalibrate):!1},tokenChunksPos(){if(!this.manualInput)return!1;if(!this.needsPosCalibrate)return this.tokenChunks.map(s=>({token:s.token,type:s.type,start:s.index,end:s.index+s.len}));const e=[];let t=0;return this.tokenChunks.forEach(s=>{let a;if(s.type==="apm"&&this.has.customApmText)if(this.apm&&this.apm.length){const l=this.apm.toLowerCase()==="am"?this.amText:this.pmText;a=l&&l.length?l.length:s.len}else a=s.len;else a=this[s.type]&&this[s.type].length?this[s.type].length:s.len;e.push({token:s.token,type:s.type,start:s.index+t,end:s.index+t+a}),s.needsCalibrate&&a>s.len&&(t+=a-s.len)}),e},invalidValues(){if(this.inputIsEmpty)return[];if(!this.restrictedHourRange&&!this.minuteRangeList&&!this.secondRangeList&&this.opts.minuteInterval===1&&this.opts.secondInterval===1)return[];const e=[];return this.inUse.hour&&!this.isEmptyValue(this.hourType,this.hour)&&(!this.isValidValue(this.hourType,this.hour)||this.isDisabled("hour",this.hour))&&e.push("hour"),this.inUse.minute&&!this.isEmptyValue(this.minuteType,this.minute)&&(!this.isValidValue(this.minuteType,this.minute)||this.isDisabled("minute",this.minute)||this.notInInterval("minute",this.minute))&&e.push("minute"),this.inUse.second&&!this.isEmptyValue(this.secondType,this.second)&&(!this.isValidValue(this.secondType,this.second)||this.isDisabled("second",this.second)||this.notInInterval("second",this.second))&&e.push("second"),this.inUse.apm&&!this.isEmptyValue(this.apmType,this.apm)&&(!this.isValidValue(this.apmType,this.apm)||this.isDisabled("apm",this.apm))&&e.push("apm"),e.length?e:[]},hasInvalidInput(){return!!(this.invalidValues&&this.invalidValues.length)},autoDirectionEnabled(){return this.dropDirection==="auto"},dropdownDirClass(){return this.autoDirectionEnabled?this.forceDropOnTop?"drop-up":"drop-down":this.dropDirection==="up"?"drop-up":"drop-down"}},watch:{"opts.format"(e){this.renderFormat(e)},"opts.minuteInterval"(e){this.renderList("minute",e)},"opts.secondInterval"(e){this.renderList("second",e)},value:{deep:!0,handler(){this.readValues()}},displayTime(){this.fillValues()},disabled(e){e&&(this.isActive&&(this.isActive=!1),this.showDropdown&&(this.showDropdown=!1))},"invalidValues.length"(e,t){e&&e>=1?this.$emit("error",this.invalidValues):t&&t>=1&&this.$emit("error",[])}},methods:{formatValue(e,t){if(!this.isNumber(t))return"";switch(t=+t,e){case"H":case"h":case"k":case"m":case"s":return["h","k"].includes(e)&&t===0?e==="k"?"24":"12":String(t);case"HH":case"mm":case"ss":case"hh":case"kk":return["hh","kk"].includes(e)&&t===0?e==="kk"?"24":"12":t<10?`0${t}`:String(t);default:return""}},checkAcceptingType(e,t){if(!e||!t||!t.length)return"";for(let s=0;s<e.length;s++)if(t.indexOf(e[s])>-1)return e[s];return""},renderFormat(e){e=e||this.opts.format||fe.format;let t=this.checkAcceptingType(ae.HOUR_TOKENS,e),s=this.checkAcceptingType(ae.MINUTE_TOKENS,e);this.secondType=this.checkAcceptingType(ae.SECOND_TOKENS,e),this.apmType=this.checkAcceptingType(ae.APM_TOKENS,e),!t&&!s&&!this.secondType&&!this.apmType&&(this.debugMode&&this.format&&this.debugLog(`No valid tokens found in your defined "format" string "${this.format}". Fallback to the default "HH:mm" format.`),t="HH",s="mm"),this.hourType=t,this.minuteType=s,this.hourType?this.renderHoursList():this.hours=[],this.minuteType?this.renderList("minute"):this.minutes=[],this.secondType?this.renderList("second"):this.seconds=[],this.apmType?this.renderApmList():this.apms=[],re(()=>{this.readValues()})},renderHoursList(){const e=this.baseOn12Hours?12:24,t=[];for(let s=0;s<e;s++)this.hourType==="k"||this.hourType==="kk"?t.push(this.formatValue(this.hourType,s+1)):t.push(this.formatValue(this.hourType,s));this.hours=t},renderList(e,t){if(!this.isMinuteOrSecond(e))return;const s=e==="minute";t=t||(s?this.opts.minuteInterval||fe.minuteInterval:this.opts.secondInterval||fe.secondInterval);const a=[];for(let l=0;l<60;l+=t)a.push(this.formatValue(s?this.minuteType:this.secondType,l));s?this.minutes=a:this.seconds=a},renderApmList(){this.apms=this.apmType==="A"?["AM","PM"]:["am","pm"]},readValues(){this.useStringValue?(this.debugMode&&this.debugLog(`Received a string value: "${this.modelValue}"`),this.readStringValues(this.modelValue)):(this.debugMode&&this.debugLog(`Received an object value: "${JSON.stringify(this.modelValue||{})}"`),this.readObjectValues(this.modelValue))},readObjectValues(e){const t=JSON.parse(JSON.stringify(e||{})),s=Object.keys(t);if(s.length===0){this.addFallbackValues();return}ae.BASIC_TYPES.forEach(a=>{const l=this.getTokenByType(a);if(s.indexOf(l)>-1){const n=this.sanitizedValue(l,t[l]);this[a]=n,t[l]=n}else this[a]=""}),this.timeValue=t},getMatchAllByRegex(e,t){const s="polyfillTest";return!s.matchAll||typeof s.matchAll!="function"?this.polyfillMatchAll(e,t):e.matchAll(new RegExp(t,"g"))},readStringValues(e){if(!e||!e.length){this.addFallbackValues();return}const t=String(this.formatString),s=`(${this.tokenRegexBase})+?`,a=`[^(${this.tokenRegexBase})]+`,l=this.getMatchAllByRegex(t,s),n=this.getMatchAllByRegex(t,a),h=[],i=[];for(let T of l){const M={index:T.index,token:T[0],isValueToken:!0};h.push(M),i.push(M)}for(let T of n)h.push({index:T.index,token:T[0]});h.sort((T,M)=>T.index<M.index?-1:1);let m="";if(h.forEach(T=>{if(T.isValueToken){const M=this.getTokenRegex(T.token)||"";m+=M}else{const M=T.token.replace(/\\{0}(\*|\?|\.|\+)/g,"\\$1");m+=`(?:${M})`}}),new RegExp(m).test(e)){const M=e.match(new RegExp(m)).slice(1,i.length+1),O={};if(M.forEach((V,Q)=>{if(i[Q]){const E=i[Q].token;O[E]=this.setValueFromString(V,E)}}),this.timeValue=O,this.debugMode){const V=i.map(Q=>Q&&Q.token);this.debugLog(`Successfully parsed values ${JSON.stringify(M)}
for ${JSON.stringify(V)}
in format pattern '${this.formatString}'`)}}else this.debugMode&&this.debugLog(`The input string in "v-model" does NOT match the "format" pattern
format: ${this.formatString}
v-model: ${e}`)},polyfillMatchAll(e,t){const s=e.match(new RegExp(t,"g")),a=[],l=[];return s&&s.length&&s.forEach(n=>{const h=l.findIndex(m=>m.str===n);let i;if(h>=0)l[h]&&l[h].regex&&(i=l[h].regex.exec(e).index);else{const m=new RegExp(n,"g");i=m.exec(e).index,l.push({str:String(n),regex:m})}a.push({0:String(n),index:i})}),a},addFallbackValues(){const e={};this.inUse.types.forEach(t=>{e[this.getTokenByType(t)]=""}),this.timeValue=e},setValueFromString(e,t){if(!t||!e)return"";const s=this.getTokenType(t);if(!s||!s.length)return"";const a=e!==this.getTokenByType(s)?e:"";return this[s]=a,a},fillValues(e){const t={},s=this.hour,a=this.hourType;let l;if(!a||!this.isNumber(s))ae.HOUR_TOKENS.forEach(n=>t[n]=""),l=this.lowerCasedApm(this.apm||""),t.a=l,t.A=l.toUpperCase();else{const n=+s,h=this.baseOn12Hours&&this.apm?this.lowerCasedApm(this.apm):!1;ae.HOUR_TOKENS.forEach(i=>{if(i===a){t[i]=s;return}let m,d;switch(i){case"H":case"HH":case"k":case"kk":this.baseOn12Hours?h==="pm"?m=n<12?n+12:n:["k","kk"].includes(i)?m=n===12?24:n:m=n%12:["k","kk"].includes(i)?m=n===0?24:n:m=n%24,t[i]=this.formatValue(i,m);break;case"h":case"hh":this.baseOn12Hours?(m=n,d=h||""):n>11&&n<24?(d="pm",m=n===12?12:n%12):(d="am",m=n%12===0?12:n),t[i]=this.formatValue(i,m),t.a=d,t.A=d.toUpperCase();break}})}t.m=this.formatValue("m",this.minute),t.mm=this.formatValue("mm",this.minute),t.s=this.formatValue("s",this.second),t.ss=this.formatValue("ss",this.second),this.fullValues=t,(!this.lazy||e)&&this.emitTimeValue(),this.closeOnComplete&&this.allValueSelected&&this.showDropdown&&this.toggleActive()},emitTimeValue(){if(!this.fullValues)return;if(this.lazy&&this.bakDisplayTime===this.displayTime){this.debugMode&&this.debugLog("The value does not change on `lazy` mode. Skip the emitting `input` and `change` event.");return}const e=JSON.parse(JSON.stringify(this.fullValues));if(this.useStringValue)this.$emit("update:modelValue",this.inputIsEmpty?"":String(this.displayTime));else{const t=this.inUse.tokens||[],s={};t.forEach(a=>{s[a]=e[a]||""}),this.$emit("update:modelValue",JSON.parse(JSON.stringify(s)))}this.$emit("change",{data:e,displayTime:this.inputIsEmpty?"":String(this.displayTime)})},translate12hRange(e){const t=this.match12hRange(e);return+t[1]==12?+t[1]+(t[2].toLowerCase()==="p"?0:12):+t[1]+(t[2].toLowerCase()==="p"?12:0)},isDisabled(e,t){if(!this.isBasicType(e)||!this.inUse[e])return!0;switch(e){case"hour":return this.isDisabledHour(t);case"minute":case"second":return this[`${e}RangeList`]?!this[`${e}RangeList`].includes(t):!1;case"apm":return this.restrictedHourRange?!this.has[this.lowerCasedApm(t)]:!1;default:return!0}},isDisabledHour(e){if(!this.restrictedHourRange)return!1;if(this.baseOn12Hours){if(!this.apm||!this.apm.length)return!1;{const t=this.apm.toLowerCase()==="am"?"a":"p";return!this.restrictedHourRange.includes(`${+e}${t}`)}}return(this.hourType==="HH"||this.hourType==="H")&&+e==0&&this.restrictedHourRange.includes(24)?!1:!this.restrictedHourRange.includes(+e)},notInInterval(e,t){if(!(!e||!this.isMinuteOrSecond(e)))return this.opts[`${e}Interval`]===1?!1:+t%this.opts[`${e}Interval`]!==0},renderRangeList(e,t){if(!e||!t||!this.isMinuteOrSecond(t))return[];const s=[];let a;if(e.forEach(l=>{if(l instanceof Array){l.length>2&&this.debugMode&&this.debugLog(`Nested array within "${t}-range" must contain no more than two items. Only the first two items of ${JSON.stringify(l)} will be taken into account.`);const n=l[0],h=l[1]||l[0];for(let i=+n;i<=+h;i++)i<0||i>59||(a=this.formatValue(this.getTokenByType(t),i),s.includes(a)||s.push(a))}else{if(+l<0||+l>59)return;a=this.formatValue(this.getTokenByType(t),l),s.includes(a)||s.push(a)}}),s.sort((l,n)=>l-n),this.debugMode){const n=((t==="minute"?this.minutes:this.seconds)||[]).filter(h=>s.includes(h));(!n||!n.length)&&(t==="minute"?this.debugLog(`The minute list is empty due to the "minute-range" config
minute-range: ${JSON.stringify(this.minuteRange)}
minute-interval: ${this.opts.minuteInterval}`):this.debugLog(`The second list is empty due to the "second-range" config
second-range: ${JSON.stringify(this.secondRange)}
second-interval: ${this.opts.secondInterval}`))}return s},forceApmSelection(){if(!this.manualInput&&this.apmType&&!this.apm&&(this.has.am||this.has.pm)){this.doClearApmChecking=!0;const e=this.has.am?"am":"pm";this.apm=this.apmType==="A"?e.toUpperCase():e}},emptyApmSelection(){this.doClearApmChecking&&this.hour===""&&this.minute===""&&this.second===""&&(this.apm=""),this.doClearApmChecking=!1},apmDisplayText(e){return this.amText&&this.lowerCasedApm(e)==="am"?this.amText:this.pmText&&this.lowerCasedApm(e)==="pm"?this.pmText:e},toggleActive(){this.disabled||(this.isActive=!this.isActive,this.isActive?(this.isFocusing=!0,this.manualInput&&this.$emit("focus"),this.opts.hideDropdown||this.setDropdownState(!0),this.lazy&&(this.bakDisplayTime=String(this.displayTime||"")),this.manualInput&&!this.inputIsEmpty&&re(()=>{this.$refs.input&&this.$refs.input.selectionStart===0&&this.$refs.input.selectionEnd===this.displayTime.length&&this.selectFirstSlot()})):(this.showDropdown?this.setDropdownState(!1):this.manualInput&&this.$emit("blur"),this.isFocusing=!1,this.lazy&&(this.fillValues(!0),this.bakDisplayTime=void 0)),this.restrictedHourRange&&this.baseOn12Hours&&(this.showDropdown?this.forceApmSelection():this.emptyApmSelection()),this.showDropdown&&this.checkForAutoScroll())},setDropdownState(e,t=!1){e?(this.keepFocusing(),this.autoDirectionEnabled&&this.checkDropDirection(),this.showDropdown=!0,this.$emit("open"),t&&(this.fixedDropdownButton&&(this.isActive=!0),this.$emit("blur"),this.checkForAutoScroll())):(this.showDropdown=!1,this.$emit("close"))},blurEvent(){this.manualInput&&!this.opts.hideDropdown&&this.$emit("blur")},select(e,t){this.isBasicType(e)&&!this.isDisabled(e,t)&&(this[e]=t,this.doClearApmChecking&&(this.doClearApmChecking=!1))},clearTime(){this.disabled||(this.hour="",this.minute="",this.second="",this.apm="",this.manualInput&&this.$refs&&this.$refs.input&&this.$refs.input.value.length&&(this.$refs.input.value=""),this.lazy&&this.fillValues(!0))},checkForAutoScroll(){this.inputIsEmpty||(this.autoScroll?re(()=>{this.scrollToSelectedValues()}):this.advancedKeyboard&&re(()=>{const e=this.inUse.types[0];this.scrollToSelected(e,!0)}))},scrollToSelected(e,t=!1){if(!this.timeValue||this.inputIsEmpty)return;const s=this.$el.querySelectorAll(`ul.${e}s`)[0];let a=this.activeItemInCol(e)[0];!a&&t&&(a=this.validItemsInCol(e)[0]),s&&a&&(s.scrollTop=a.offsetTop||0,this.advancedKeyboard&&a.focus())},scrollToSelectedValues(){!this.timeValue||this.inputIsEmpty||this.inUse.types.forEach(e=>{this.scrollToSelected(e)})},onFocus(){this.disabled||(this.isFocusing||(this.isFocusing=!0),this.isActive||this.toggleActive())},escBlur(){if(this.disabled)return;window.clearTimeout(this.debounceTimer),this.isFocusing=!1;const e=this.$el.querySelectorAll("input.vue__time-picker-input")[0];e&&e.blur()},debounceBlur(){this.disabled||(this.isFocusing=!1,window.clearTimeout(this.debounceTimer),this.debounceTimer=window.setTimeout(()=>{window.clearTimeout(this.debounceTimer),this.onBlur()},this.opts.blurDelay))},onBlur(){!this.disabled&&!this.isFocusing&&this.isActive&&this.toggleActive()},keepFocusing(){this.disabled||(window.clearTimeout(this.debounceTimer),this.isFocusing||(this.isFocusing=!0))},validItemsInCol(e){const t=`${e}s`;return this.$el.querySelectorAll(`ul.${t} > li:not(.hint):not([disabled])`)},activeItemInCol(e){const t=`${e}s`;return this.$el.querySelectorAll(`ul.${t} > li.active:not(.hint)`)},getClosestSibling(e,t,s=!1){const a=this.validItemsInCol(e),l=Array.prototype.findIndex.call(a,n=>n.getAttribute("data-key")===t);return s&&l===0?a[a.length-1]:!s&&l===a.length-1||l<0?a[0]:s?a[l-1]:a[l+1]},prevItem(e,t,s=!1){const a=this.getClosestSibling(e,t,!0);if(a)return s?a:a.focus()},nextItem(e,t,s=!1){const a=this.getClosestSibling(e,t,!1);if(a)return s?a:a.focus()},getSideColumnName(e,t=!1){const s=this.inUse.types.indexOf(e);if(t&&s<=0){this.debugMode&&this.debugLog("You're in the leftmost list already");return}else if(!t&&s===this.inUse.types.length-1){this.debugMode&&this.debugLog("You're in the rightmost list already");return}return this.inUse.types[t?s-1:s+1]},getFirstItemInSideColumn(e,t=!1){const s=this.getSideColumnName(e,t);if(!s)return;const a=this.validItemsInCol(s);if(a&&a[0])return a[0]},getActiveItemInSideColumn(e,t=!1){const s=this.getSideColumnName(e,t);if(!s)return;const a=this.activeItemInCol(s);if(a&&a[0])return a[0]},toLeftColumn(e){const t=this.getActiveItemInSideColumn(e,!0)||this.getFirstItemInSideColumn(e,!0);t&&t.focus()},toRightColumn(e){const t=this.getActiveItemInSideColumn(e,!1)||this.getFirstItemInSideColumn(e,!1);t&&t.focus()},onMouseDown(){this.manualInput&&(window.clearTimeout(this.selectionTimer),this.selectionTimer=window.setTimeout(()=>{if(window.clearTimeout(this.selectionTimer),this.$refs&&this.$refs.input){const e=this.getNearestChunkByPos(this.$refs.input.selectionStart||0);this.debounceSetInputSelection(e)}},50))},keyDownHandler(e){if(e.isComposing||e.keyCode===229)return e.preventDefault(),e.stopPropagation(),!1;e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105?(e.preventDefault(),this.keyboardInput(e.key)):[65,80,77].includes(e.keyCode)?(e.preventDefault(),this.keyboardInput(e.key,!0)):e.keyCode>=37&&e.keyCode<=40?(e.preventDefault(),this.clearKbInputLog(),this.arrowHandler(e)):e.keyCode===8||e.keyCode===46?(e.preventDefault(),this.clearKbInputLog(),this.clearTime()):e.keyCode===9?(this.clearKbInputLog(),this.tabHandler(e)):e.keyCode!==27&&!(e.metaKey||e.ctrlKey)&&e.preventDefault()},onCompostionStart(e){return e.preventDefault(),e.stopPropagation(),this.bakCurrentPos=this.getCurrentTokenChunk(),!1},onCompostionEnd(e){e.preventDefault(),e.stopPropagation();const t=e.data;let s=!1;return this.has.customApmText&&(s=this.isCustomApmText(t)),s&&this.setSanitizedValueToSection("apm",s),this.$refs.input.value=this.has.customApmText?this.customDisplayTime:this.displayTime,re(()=>{if(this.bakCurrentPos){const a=JSON.parse(JSON.stringify(this.bakCurrentPos));s&&(a.end=a.start+t.length),this.debounceSetInputSelection(a),this.bakCurrentPos=null}}),!1},pasteHandler(e){e.preventDefault();let t=(e.clipboardData||window.clipboardData).getData("text");this.debugMode&&this.debugLog(`Pasting value "${t}" from clipboard`),!(!t||!t.length)&&(this.has.customApmText&&(t=this.replaceCustomApmText(t)),this.inputIsEmpty?this.readStringValues(t):(this.kbInputLog=t.substr(-2,2),this.setKbInput(),this.debounceClearKbLog()))},arrowHandler(e){const t={37:"L",38:"U",39:"R",40:"D"}[e.keyCode];if(t==="U"||t==="D")if(this.inputIsEmpty)this.selectFirstValidValue();else{const s=this.getCurrentTokenChunk();if(!s){this.selectFirstValidValue();return}const a=s.type;this.getClosestValidItemInCol(a,this[a],t);const l=this.getCurrentTokenChunk();this.debounceSetInputSelection(l)}else t==="R"?this.toLateralToken(!1):t==="L"&&this.toLateralToken(!0)},tabHandler(e){if(!this.inputIsEmpty&&this.tokenChunksPos&&this.tokenChunksPos.length){const t=this.getCurrentTokenChunk();if(!t)return;const s=this.tokenChunksPos[0],a=this.tokenChunksPos[this.tokenChunksPos.length-1];(e.shiftKey&&t.token!==s.token||!e.shiftKey&&t.token!==a.token)&&(e.preventDefault(),this.toLateralToken(e.shiftKey))}},keyboardInput(e,t=!1){const s=this.getCurrentTokenChunk();!s||s.type!=="apm"&&t||s.type==="apm"&&!t||(this.kbInputLog=`${this.kbInputLog.substr(-1)}${e}`,this.setKbInput(),this.debounceClearKbLog())},clearKbInputLog(){window.clearTimeout(this.kbInputTimer),this.kbInputLog=""},debounceClearKbLog(){window.clearTimeout(this.kbInputTimer),this.kbInputTimer=window.setTimeout(()=>{this.clearKbInputLog()},this.opts.manualInputTimeout)},setKbInput(e){e=e||this.kbInputLog;const t=this.getCurrentTokenChunk();if(!t||!e||!e.length)return;const s=t.type,a=t.token;let l;if(s==="apm")this.lowerCasedApm(e).includes("a")?l="am":this.lowerCasedApm(e).includes("p")&&(l="pm"),l&&(l=a==="A"?l.toUpperCase():l);else if(this.isValidValue(a,e))l=e;else{const n=this.formatValue(a,e.substr(-1));this.isValidValue(a,n)&&(l=n)}if(l){this.setSanitizedValueToSection(s,l);const n=this.getCurrentTokenChunk();this.debounceSetInputSelection(n)}this.debugMode&&(l?this.debugLog(`Successfully set value "${l}" from latest input "${e}" for the "${s}" slot`):this.debugLog(`Value "${e}" is invalid in the "${s}" slot`))},onChange(){if(!this.manualInput||!this.$refs||!this.$refs.input)return;const e=this.$refs.input.value||"";e&&e.length&&this.readStringValues(e)},getNearestChunkByPos(e){if(!this.tokenChunksPos||!this.tokenChunksPos.length)return;let t,s=-1;for(let a=0;a<this.tokenChunksPos.length;a++){const l=JSON.parse(JSON.stringify(this.tokenChunksPos[a]));if(l.start===e)return l;const n=Math.abs(l.start-e);if(s<0)t=l,s=n;else{if(s<=n)return t;s=n,t=l}}return t},selectFirstValidValue(){if(!this.tokenChunksPos||!this.tokenChunksPos.length)return;const e=this.tokenChunksPos[0].type;e==="hour"?this.getClosestHourItem():this.getClosestValidItemInCol(e,this[e]),this.selectFirstSlot()},getClosestHourItem(e,t="U"){if(!this.validHoursList||!this.validHoursList.length){this.debugMode&&this.debugLog(`No valid hour values found, please check your "hour-range" config
hour-range: ${JSON.stringify(this.hourRange)}`);return}if(!e){this.setManualHour(this.validHoursList[0]);return}const s=this.validHoursList.findIndex(n=>{if(this.baseOn12Hours){const h=`${e}${this.lowerCasedApm(this.apm)==="pm"?"p":"a"}`;return n===h}else return n===e});let a;s===-1?a=0:t==="D"?a=s===0?this.validHoursList.length-1:s-1:a=(s+1)%this.validHoursList.length;const l=this.validHoursList[a];this.setManualHour(l)},getClosestValidItemInCol(e,t,s="U"){if(e==="hour")this.getClosestHourItem(t,s);else{const a=s==="D"?this.prevItem(e,this[e],!0):this.nextItem(e,this[e],!0);a&&this.select(e,a.getAttribute("data-key"))}},setSanitizedValueToSection(e,t){if(!e||!this.getTokenByType(e))return;const s=this.sanitizedValue(this.getTokenByType(e),t);this[e]=s},setManualHour(e){if(this.is12hRange(e)){const t=this.match12hRange(e),s=t[2]==="a"?"AM":"PM";this.setSanitizedValueToSection("apm",this.apmType==="a"?s.toLowerCase():s),this.setSanitizedValueToSection("hour",t[1])}else this.setSanitizedValueToSection("hour",e)},debounceSetInputSelection({start:e=0,end:t=0}){re(()=>{this.setInputSelectionRange(e,t)}),window.clearTimeout(this.selectionTimer),this.selectionTimer=window.setTimeout(()=>{window.clearTimeout(this.selectionTimer),this.$refs.input&&(this.$refs.input.selectionStart!==e||this.$refs.input.selectionEnd!==t)&&this.setInputSelectionRange(e,t)},30)},setInputSelectionRange(e,t){this.$refs&&this.$refs.input&&this.$refs.input.setSelectionRange(e,t)},getCurrentTokenChunk(){return this.getNearestChunkByPos(this.$refs.input&&this.$refs.input.selectionStart||0)},selectFirstSlot(){const e=this.getNearestChunkByPos(0);this.debounceSetInputSelection(e)},toLateralToken(e){const t=this.getCurrentTokenChunk();if(!t){this.selectFirstValidValue();return}const s=this.tokenChunksPos.findIndex(l=>l.token===t.token);if(!e&&s>=this.tokenChunksPos.length-1||e&&s===0){this.debugMode&&(e?this.debugLog("You're in the leftmost slot already"):this.debugLog("You're in the rightmost slot already"));return}const a=e?this.tokenChunksPos[s-1]:this.tokenChunksPos[s+1];this.debounceSetInputSelection(a)},isCustomApmText(e){return!e||!e.length?!1:this.amText&&this.amText===e?this.apmType==="A"?"AM":"am":this.pmText&&this.pmText===e?this.apmType==="A"?"PM":"pm":!1},replaceCustomApmText(e){return this.amText&&this.amText.length&&e.includes(this.amText)?e.replace(new RegExp(this.amText,"g"),this.apmType==="A"?"AM":"am"):this.pmText&&this.pmText.length&&e.includes(this.pmText)?e.replace(new RegExp(this.pmText,"g"),this.apmType==="A"?"PM":"pm"):e},checkDropDirection(){if(!this.$el)return;let e;this.containerId&&this.containerId.length&&(e=document.getElementById(this.containerId),!e&&this.debugMode&&this.debugLog(`Container with id "${this.containerId}" not found. Fallback to document body.`));const t=this.$el;let s;e&&e.offsetHeight?s=e.offsetTop+e.offsetHeight-(t.offsetTop+t.offsetHeight):s=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)-(t.offsetTop+t.offsetHeight),this.forceDropOnTop=this.opts.dropOffsetHeight>s},is12hRange(e){return/^\d{1,2}(a|p|A|P)$/.test(e)},match12hRange(e){return e.match(/^(\d{1,2})(a|p|A|P)$/)},isNumber(e){return!isNaN(parseFloat(e))&&isFinite(e)},isBasicType(e){return ae.BASIC_TYPES.includes(e)},lowerCasedApm(e){return(e||"").toLowerCase()},getTokenRegex(e){switch(e){case"HH":return"([01][0-9]|2[0-3]|H{2})";case"H":return"([0-9]{1}|1[0-9]|2[0-3]|H{1})";case"hh":return"(0[1-9]|1[0-2]|h{2})";case"h":return"([1-9]{1}|1[0-2]|h{1})";case"kk":return"(0[1-9]|1[0-9]|2[0-4]|k{2})";case"k":return"([1-9]{1}|1[0-9]|2[0-4]|k{1})";case"mm":return"([0-5][0-9]|m{2})";case"ss":return"([0-5][0-9]|s{2})";case"m":return"([0-9]{1}|[1-5][0-9]|m{1})";case"s":return"([0-9]{1}|[1-5][0-9]|s{1})";case"A":return"(AM|PM|A{1})";case"a":return"(am|pm|a{1})";default:return""}},isEmptyValue(e,t){return!t||!t.length||t&&t===e},isValidValue(e,t){if(!e||this.isEmptyValue(e,t))return!1;const s=this.getTokenRegex(e);return!s||!s.length?!1:new RegExp(`^${s}$`).test(t)},sanitizedValue(e,t){return this.isValidValue(e,t)?t:""},getTokenType(e){return this.inUse.types[this.inUse.tokens.indexOf(e)]||""},getTokenByType(e){return this[`${e}Type`]||""},isMinuteOrSecond(e){return["minute","second"].includes(e)},booleanAttr(e=!1){return e?!0:null},debugLog(e){if(!e||!e.length)return;let t="";if(this.id&&(t+=`#${this.id}`),this.name&&(t+=`[name=${this.name}]`),this.inputClass){let a=[];typeof this.inputClass=="string"?a=this.inputClass.split(/\s/g):Array.isArray(this.inputClass)?a=[].concat([],this.inputClass):typeof this.inputClass=="object"&&Object.keys(this.inputClass).forEach(l=>{this.inputClass[l]&&a.push(l)});for(let l of a)l&&l.trim().length&&(t+=`.${l.trim()}`)}const s=`DEBUG: ${e}${t?`
	(${t})`:""}`;window.console.debug&&typeof window.console.debug=="function"?window.console.debug(s):window.console.log(s)}},mounted(){window.clearTimeout(this.debounceTimer),window.clearTimeout(this.selectionTimer),window.clearTimeout(this.kbInputTimer),this.renderFormat()},beforeUnmount(){window.clearTimeout(this.debounceTimer),window.clearTimeout(this.selectionTimer),window.clearTimeout(this.kbInputTimer)}};const lt={key:0,class:"controls",tabindex:"-1"},ot=c("span",{class:"char"},"×",-1),rt=c("span",{class:"char"},"▾",-1),ut={key:1,class:"custom-icon"};function dt(e,t,s,a,l,n){return u(),y("span",{class:"vue__time-picker",style:n.inputWidthStyle},[c("input",{type:"text",class:["vue__time-picker-input",[s.inputClass,{"is-empty":n.inputIsEmpty,invalid:n.hasInvalidInput,"all-selected":n.allValueSelected,disabled:s.disabled,"has-custom-icon":e.$slots&&e.$slots.icon}]],ref:"input",style:n.inputWidthStyle,id:s.id,name:s.name,value:n.inputIsEmpty?null:n.customDisplayTime,placeholder:s.placeholder?s.placeholder:n.formatString,tabindex:s.disabled?-1:s.tabindex,disabled:n.booleanAttr(s.disabled),readonly:n.booleanAttr(!s.manualInput),autocomplete:s.autocomplete,onFocus:t[1]||(t[1]=(...h)=>n.onFocus(...h)),onChange:t[2]||(t[2]=(...h)=>n.onChange(...h)),onBlur:t[3]||(t[3]=h=>{n.debounceBlur(),n.blurEvent()}),onMousedown:t[4]||(t[4]=(...h)=>n.onMouseDown(...h)),onKeydown:[t[5]||(t[5]=(...h)=>n.keyDownHandler(...h)),t[9]||(t[9]=R(I((...h)=>n.escBlur(...h),["exact"]),["esc"]))],onCompositionstart:t[6]||(t[6]=(...h)=>n.onCompostionStart(...h)),onCompositionend:t[7]||(t[7]=(...h)=>n.onCompostionEnd(...h)),onPaste:t[8]||(t[8]=(...h)=>n.pasteHandler(...h))},null,46,["id","name","value","placeholder","tabindex","disabled","readonly","autocomplete"]),n.showClearBtn||n.showDropdownBtn?(u(),y("div",lt,[!l.isActive&&n.showClearBtn?(u(),y("span",{key:0,class:["clear-btn",{"has-custom-btn":e.$slots&&e.$slots.clearButton}],tabindex:"-1",onClick:t[10]||(t[10]=(...h)=>n.clearTime(...h))},[de(e.$slots,"clearButton",{},()=>[ot])],2)):k("v-if",!0),n.showDropdownBtn?(u(),y("span",{key:1,class:["dropdown-btn",{"has-custom-btn":e.$slots&&e.$slots.dropdownButton}],tabindex:"-1",onClick:t[11]||(t[11]=h=>n.setDropdownState(s.fixedDropdownButton?!l.showDropdown:!0,!0)),onMousedown:t[12]||(t[12]=(...h)=>n.keepFocusing(...h))},[de(e.$slots,"dropdownButton",{},()=>[rt])],34)):k("v-if",!0)])):k("v-if",!0),e.$slots&&e.$slots.icon?(u(),y("div",ut,[de(e.$slots,"icon")])):k("v-if",!0),l.showDropdown?(u(),y("div",{key:2,class:"time-picker-overlay",onClick:t[13]||(t[13]=(...h)=>n.toggleActive(...h)),tabindex:"-1"})):k("v-if",!0),Je(c("div",{class:["dropdown",[n.dropdownDirClass]],tabindex:"-1",style:n.inputWidthStyle,onMouseup:t[42]||(t[42]=(...h)=>n.keepFocusing(...h)),onClick:t[43]||(t[43]=I(()=>{},["stop"]))},[c("div",{class:"select-list",style:n.inputWidthStyle,tabindex:"-1"},[k(" Common Keyboard Support: less event listeners "),s.advancedKeyboard?k("v-if",!0):(u(!0),y(B,{key:0},N(n.columnsSequence,h=>(u(),y(B,{key:h},[h==="hour"?(u(),y("ul",{key:0,class:"hours",onScroll:t[14]||(t[14]=(...i)=>n.keepFocusing(...i))},[c("li",{class:"hint",textContent:g(n.hourLabelText)},null,8,["textContent"]),(u(!0),y(B,null,N(l.hours,(i,m)=>(u(),y(B,{key:m},[!n.opts.hideDisabledHours||n.opts.hideDisabledHours&&!n.isDisabled("hour",i)?(u(),y("li",{key:0,class:{active:l.hour===i},disabled:n.booleanAttr(n.isDisabled("hour",i)),"data-key":i,textContent:g(i),onClick:d=>n.select("hour",i)},null,10,["disabled","data-key","textContent","onClick"])):k("v-if",!0)],64))),128))],32)):k("v-if",!0),h==="minute"?(u(),y("ul",{key:1,class:"minutes",onScroll:t[15]||(t[15]=(...i)=>n.keepFocusing(...i))},[c("li",{class:"hint",textContent:g(n.minuteLabelText)},null,8,["textContent"]),(u(!0),y(B,null,N(l.minutes,(i,m)=>(u(),y(B,{key:m},[!n.opts.hideDisabledMinutes||n.opts.hideDisabledMinutes&&!n.isDisabled("minute",i)?(u(),y("li",{key:0,class:{active:l.minute===i},disabled:n.booleanAttr(n.isDisabled("minute",i)),"data-key":i,textContent:g(i),onClick:d=>n.select("minute",i)},null,10,["disabled","data-key","textContent","onClick"])):k("v-if",!0)],64))),128))],32)):k("v-if",!0),h==="second"?(u(),y("ul",{key:2,class:"seconds",onScroll:t[16]||(t[16]=(...i)=>n.keepFocusing(...i))},[c("li",{class:"hint",textContent:g(n.secondLabelText)},null,8,["textContent"]),(u(!0),y(B,null,N(l.seconds,(i,m)=>(u(),y(B,{key:m},[!n.opts.hideDisabledSeconds||n.opts.hideDisabledSeconds&&!n.isDisabled("second",i)?(u(),y("li",{key:0,class:{active:l.second===i},disabled:n.booleanAttr(n.isDisabled("second",i)),"data-key":i,textContent:g(i),onClick:d=>n.select("second",i)},null,10,["disabled","data-key","textContent","onClick"])):k("v-if",!0)],64))),128))],32)):k("v-if",!0),h==="apm"?(u(),y("ul",{key:3,class:"apms",onScroll:t[17]||(t[17]=(...i)=>n.keepFocusing(...i))},[c("li",{class:"hint",textContent:g(n.apmLabelText)},null,8,["textContent"]),(u(!0),y(B,null,N(l.apms,(i,m)=>(u(),y(B,{key:m},[!n.opts.hideDisabledHours||n.opts.hideDisabledHours&&!n.isDisabled("apm",i)?(u(),y("li",{key:0,class:{active:l.apm===i},disabled:n.booleanAttr(n.isDisabled("apm",i)),"data-key":i,textContent:g(n.apmDisplayText(i)),onClick:d=>n.select("apm",i)},null,10,["disabled","data-key","textContent","onClick"])):k("v-if",!0)],64))),128))],32)):k("v-if",!0)],64))),128)),k(" / Common Keyboard Support "),k(`
        Advanced Keyboard Support
        Addeds hundreds of additional event lisenters
      `),s.advancedKeyboard?(u(!0),y(B,{key:1},N(n.columnsSequence,h=>(u(),y(B,{key:h},[h==="hour"?(u(),y("ul",{key:0,class:"hours",tabindex:"-1",onScroll:t[23]||(t[23]=(...i)=>n.keepFocusing(...i))},[c("li",{class:"hint",textContent:g(n.hourLabelText),tabindex:"-1"},null,8,["textContent"]),(u(!0),y(B,null,N(l.hours,(i,m)=>(u(),y(B,{key:m},[!n.opts.hideDisabledHours||n.opts.hideDisabledHours&&!n.isDisabled("hour",i)?(u(),y("li",{key:0,class:{active:l.hour===i},tabindex:n.isDisabled("hour",i)?-1:s.tabindex,"data-key":i,disabled:n.booleanAttr(n.isDisabled("hour",i)),textContent:g(i),onClick:d=>n.select("hour",i),onKeydown:[R(I(d=>n.select("hour",i),["prevent"]),["space"]),R(I(d=>n.select("hour",i),["prevent"]),["enter"]),R(I(d=>n.prevItem("hour",i),["prevent"]),["up"]),R(I(d=>n.nextItem("hour",i),["prevent"]),["down"]),t[18]||(t[18]=R(I(d=>n.toLeftColumn("hour"),["prevent"]),["left"])),t[19]||(t[19]=R(I(d=>n.toRightColumn("hour"),["prevent"]),["right"])),t[20]||(t[20]=R(I((...d)=>n.debounceBlur(...d),["exact"]),["esc"]))],onBlur:t[21]||(t[21]=(...d)=>n.debounceBlur(...d)),onFocus:t[22]||(t[22]=(...d)=>n.keepFocusing(...d))},null,42,["tabindex","data-key","disabled","textContent","onClick","onKeydown"])):k("v-if",!0)],64))),128))],32)):k("v-if",!0),h==="minute"?(u(),y("ul",{key:1,class:"minutes",tabindex:"-1",onScroll:t[29]||(t[29]=(...i)=>n.keepFocusing(...i))},[c("li",{class:"hint",textContent:g(n.minuteLabelText),tabindex:"-1"},null,8,["textContent"]),(u(!0),y(B,null,N(l.minutes,(i,m)=>(u(),y(B,{key:m},[!n.opts.hideDisabledMinutes||n.opts.hideDisabledMinutes&&!n.isDisabled("minute",i)?(u(),y("li",{key:0,class:{active:l.minute===i},tabindex:n.isDisabled("minute",i)?-1:s.tabindex,"data-key":i,disabled:n.booleanAttr(n.isDisabled("minute",i)),textContent:g(i),onClick:d=>n.select("minute",i),onKeydown:[R(I(d=>n.select("minute",i),["prevent"]),["space"]),R(I(d=>n.select("minute",i),["prevent"]),["enter"]),R(I(d=>n.prevItem("minute",i),["prevent"]),["up"]),R(I(d=>n.nextItem("minute",i),["prevent"]),["down"]),t[24]||(t[24]=R(I(d=>n.toLeftColumn("minute"),["prevent"]),["left"])),t[25]||(t[25]=R(I(d=>n.toRightColumn("minute"),["prevent"]),["right"])),t[26]||(t[26]=R(I((...d)=>n.debounceBlur(...d),["exact"]),["esc"]))],onBlur:t[27]||(t[27]=(...d)=>n.debounceBlur(...d)),onFocus:t[28]||(t[28]=(...d)=>n.keepFocusing(...d))},null,42,["tabindex","data-key","disabled","textContent","onClick","onKeydown"])):k("v-if",!0)],64))),128))],32)):k("v-if",!0),h==="second"?(u(),y("ul",{key:2,class:"seconds",tabindex:"-1",onScroll:t[35]||(t[35]=(...i)=>n.keepFocusing(...i))},[c("li",{class:"hint",textContent:g(n.secondLabelText),tabindex:"-1"},null,8,["textContent"]),(u(!0),y(B,null,N(l.seconds,(i,m)=>(u(),y(B,{key:m},[!n.opts.hideDisabledSeconds||n.opts.hideDisabledSeconds&&!n.isDisabled("second",i)?(u(),y("li",{key:0,class:{active:l.second===i},tabindex:n.isDisabled("second",i)?-1:s.tabindex,"data-key":i,disabled:n.booleanAttr(n.isDisabled("second",i)),textContent:g(i),onClick:d=>n.select("second",i),onKeydown:[R(I(d=>n.select("second",i),["prevent"]),["space"]),R(I(d=>n.select("second",i),["prevent"]),["enter"]),R(I(d=>n.prevItem("second",i),["prevent"]),["up"]),R(I(d=>n.nextItem("second",i),["prevent"]),["down"]),t[30]||(t[30]=R(I(d=>n.toLeftColumn("second"),["prevent"]),["left"])),t[31]||(t[31]=R(I(d=>n.toRightColumn("second"),["prevent"]),["right"])),t[32]||(t[32]=R(I((...d)=>n.debounceBlur(...d),["exact"]),["esc"]))],onBlur:t[33]||(t[33]=(...d)=>n.debounceBlur(...d)),onFocus:t[34]||(t[34]=(...d)=>n.keepFocusing(...d))},null,42,["tabindex","data-key","disabled","textContent","onClick","onKeydown"])):k("v-if",!0)],64))),128))],32)):k("v-if",!0),h==="apm"?(u(),y("ul",{key:3,class:"apms",tabindex:"-1",onScroll:t[41]||(t[41]=(...i)=>n.keepFocusing(...i))},[c("li",{class:"hint",textContent:g(n.apmLabelText),tabindex:"-1"},null,8,["textContent"]),(u(!0),y(B,null,N(l.apms,(i,m)=>(u(),y(B,{key:m},[!n.opts.hideDisabledHours||n.opts.hideDisabledHours&&!n.isDisabled("apm",i)?(u(),y("li",{key:0,class:{active:l.apm===i},tabindex:n.isDisabled("apm",i)?-1:s.tabindex,"data-key":i,disabled:n.booleanAttr(n.isDisabled("apm",i)),textContent:g(n.apmDisplayText(i)),onClick:d=>n.select("apm",i),onKeydown:[R(I(d=>n.select("apm",i),["prevent"]),["space"]),R(I(d=>n.select("apm",i),["prevent"]),["enter"]),R(I(d=>n.prevItem("apm",i),["prevent"]),["up"]),R(I(d=>n.nextItem("apm",i),["prevent"]),["down"]),t[36]||(t[36]=R(I(d=>n.toLeftColumn("apm"),["prevent"]),["left"])),t[37]||(t[37]=R(I(d=>n.toRightColumn("apm"),["prevent"]),["right"])),t[38]||(t[38]=R(I((...d)=>n.debounceBlur(...d),["exact"]),["esc"]))],onBlur:t[39]||(t[39]=(...d)=>n.debounceBlur(...d)),onFocus:t[40]||(t[40]=(...d)=>n.keepFocusing(...d))},null,42,["tabindex","data-key","disabled","textContent","onClick","onKeydown"])):k("v-if",!0)],64))),128))],32)):k("v-if",!0)],64))),128)):k("v-if",!0),k(" / Advanced Keyboard Support ")],4)],38),[[Ye,l.showDropdown]])],4)}ce.render=dt;ce.__file="src/VueTimepicker.vue";const ct={class:"text-2xl font-semibold"},ht={class:"p-4 bg-surface-hover space-y-3 rounded-sm"},mt={class:"flex items-center justify-between text-sm text-base"},pt={class:"flex items-center gap-1"},ft={class:"flex items-center justify-between text-sm text-base"},gt={class:"flex items-center gap-1"},bt={class:"flex items-center justify-between text-sm text-base"},yt={class:"flex items-center justify-between font-semibold text-base"},vt={class:"flex items-start justify-between font-semibold text-base mt-2"},xt={class:"flex flex-col items-end"},kt={class:"flex items-center gap-1"},wt={class:"text-xs text-gray-500 font-normal"},Tt={key:0,class:"flex items-center gap-2 mt-2 p-2 bg-red-50 dark:bg-red-900/20 rounded border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 text-sm"},Ct={key:0,class:"mt-2"},St={class:"mt-4"},It={class:"relative w-full"},_t={key:0,class:"absolute z-50 bg-white dark:bg-zinc-800 border border-gray-300 dark:border-zinc-700 rounded w-full max-h-60 overflow-auto shadow-lg"},Dt=["onClick"],Rt={class:"mt-4"},Bt={class:"mt-4"},Vt={class:"flex gap-2"},At={key:0,class:"text-red-500 text-sm mt-1"},Ht={class:"flex justify-end gap-3 mt-6"},Mt={key:0},Ot={key:1},Et=be({__name:"RentBookModal",props:{isOpenRentBookModal:{type:Boolean},bookId:{},bookTitle:{},dailyRentPrice:{},securityDeposit:{},rentalExists:{type:Boolean},currentWalletBalance:{},reservedAmount:{},ownerUserId:{}},emits:["update:openRentBookModal","rental-success","update:rentalExists"],setup(e,{emit:t}){const{createRental:s,loading:a}=Ce(),l=new Me("en-US",{dateStyle:"medium"}),n=De(null),h=new Date,i=new Date(h.getTime()+1440*60*1e3),m=new Oe(i.getFullYear(),i.getMonth()+1,i.getDate()),d=q(()=>n.value?l.format(n.value.toDate(ke())):""),T="pk.8766fa6ab4b87b62cae79f213146bdc0",M=A(""),{addressQuery:O,suggestions:V,fetchSuggestions:Q,selectSuggestion:E}=Pe(T),D=e,b=t,K=q({get:()=>D.isOpenRentBookModal,set:f=>b("update:openRentBookModal",f)}),J=["1 day","3 days","5 days","7 days","14 days","Custom"],S=A(""),F=A(null),U=A(null),X=A(null),Y=A(null),ne=A(null),Z=A("");function te(f){return f?typeof f=="string"?f:typeof f=="object"&&f.HH&&f.mm?`${f.HH}:${f.mm}`:"":""}function se(){const f=te(Y.value),p=te(ne.value);if(!f||!p)return;const W=new Date(`1970-01-01T${f}:00`);new Date(`1970-01-01T${p}:00`)<=W?Z.value="End time must be later than start time":Z.value=""}oe([Y,ne],()=>{se()});function L(f){E(f,M),O.value=f.display_name,M.value=f.display_name,V.value=[]}oe(S,f=>{f!=="Custom"&&(F.value=null,U.value=Number(f.split(" ")[0]))});function _(f){[".","e","-","+"].includes(f.key)&&f.preventDefault()}oe(F,f=>{S.value==="Custom"&&f&&(U.value=Math.floor(f))}),oe(n,f=>{f&&f<m&&(n.value=m),X.value=f?l.format(f.toDate(ke())):null});function le(f){if(!f.target.value){V.value=[];return}Q()}const x=q(()=>{if(!U.value)return 0;const f=D.dailyRentPrice??0,p=D.securityDeposit??0;return f*U.value+p}),v=q(()=>{const f=D.currentWalletBalance??0,p=D.reservedAmount??0;return f-p}),z=q(()=>x.value>v.value);function P(f){if(!f)return"";const[p,W]=f.split(":");if(!p||!W)return"";let H=parseInt(p);const he=parseInt(W),me=H>=12?"PM":"AM";return H===0&&(H=12),H>12&&(H-=12),`${H}:${he.toString().padStart(2,"0")} ${me}`}const ee=A(!1);oe(()=>D.isOpenRentBookModal,f=>{f&&(ee.value=!1,Z.value="")});async function ie(){if(se(),!(ee.value||Z.value||z.value)){ee.value=!0;try{const f=te(Y.value),p=te(ne.value),W=P(f),H=P(p);if(!W||!H){Z.value="Please select valid start and end times",ee.value=!1;return}await s({bookId:D.bookId,totalRentCost:x.value,rentalDurationDays:U.value,meetupTimeWindow:`${W} - ${H}`,meetupLocation:O.value,meetupDate:X.value,actualRate:D.dailyRentPrice??0,actualDeposit:D.securityDeposit??0,ownerUserId:D.ownerUserId}),b("update:rentalExists",!0),b("rental-success"),K.value=!1}catch(f){console.error(f),ee.value=!1}}}return(f,p)=>{const W=Te,H=Ae,he=et,me=He,ye=ue,Fe=$e,Ue=Ee,Ne=Le;return u(),y(Ne,{open:K.value,"onUpdate:open":p[7]||(p[7]=j=>K.value=j),ui:{content:"max-w-lg"},dismissible:!0},{header:C(()=>[o("h2",ct,"Rent "+g(D.bookTitle),1)]),body:C(()=>[o("div",ht,[p[14]||(p[14]=o("p",{class:"font-semibold text-base"},"Rental Details",-1)),o("div",mt,[p[8]||(p[8]=o("span",null,"Daily Rate:",-1)),o("div",pt,[c(W,{name:"fluent:book-coins-20-regular",class:"w-5 h-5 text-accent"}),o("span",null,g(D.dailyRentPrice)+"/day",1)])]),o("div",ft,[p[9]||(p[9]=o("span",null,"Security Deposit:",-1)),o("div",gt,[c(W,{name:"fluent:book-coins-20-regular",class:"w-5 h-5 text-accent"}),o("span",null,g(D.securityDeposit),1)])]),o("div",bt,[p[10]||(p[10]=o("span",null,"Rental Period:",-1)),o("span",null,g(U.value??"-"),1)]),c(H,{orientation:"horizontal",class:"my-2 bg-slate-400"}),o("div",yt,[p[11]||(p[11]=o("span",null,"Total Cost:",-1)),o("div",{class:$(["flex items-center gap-1",{"text-red-500":z.value}])},[c(W,{name:"fluent:book-coins-20-regular",class:$(["w-5 h-5 text-accent",z.value?"text-red-500":"text-accent"])},null,8,["class"]),o("span",null,g(x.value),1)],2)]),o("div",vt,[p[12]||(p[12]=o("span",{class:"mt-0.5"},"Available Balance:",-1)),o("div",xt,[o("div",kt,[c(W,{name:"fluent:book-coins-20-regular",class:"w-5 h-5 text-accent"}),o("span",null,g(v.value),1)]),o("span",wt," ("+g(D.currentWalletBalance)+" current balance - "+g(D.reservedAmount)+" reserved) ",1)])]),z.value?(u(),w("div",Tt,[c(W,{name:"i-heroicons-exclamation-circle",class:"w-5 h-5 shrink-0"}),p[13]||(p[13]=o("span",null,"Insufficient wallet balance for this rental duration.",-1))])):k("",!0)]),p[20]||(p[20]=o("p",{class:"font-semibold text-base mt-4"},"Rental Duration",-1)),c(he,{modelValue:S.value,"onUpdate:modelValue":p[0]||(p[0]=j=>S.value=j),items:J,class:"w-full mt-2"},null,8,["modelValue"]),S.value==="Custom"?(u(),w("div",Ct,[p[15]||(p[15]=o("p",{class:"text-sm text-gray-600"},"Enter custom number of days:",-1)),c(me,{type:"number",modelValue:F.value,"onUpdate:modelValue":p[1]||(p[1]=j=>F.value=j),min:"1",placeholder:"e.g., 12",class:"mt-1 w-full",onKeydown:_},null,8,["modelValue"])])):k("",!0),o("div",St,[p[16]||(p[16]=o("p",{class:"font-semibold text-base mt-4"},"Meetup Location",-1)),o("div",It,[c(me,{modelValue:r(O),"onUpdate:modelValue":p[2]||(p[2]=j=>Re(O)?O.value=j:null),placeholder:"Enter meetup location...",class:"mt-1 w-full",onInput:le},null,8,["modelValue"]),r(V).length?(u(),w("ul",_t,[(u(!0),w(B,null,N(r(V),(j,qe)=>(u(),w("li",{key:qe,onClick:gn=>L(j),class:"p-2 cursor-pointer hover:bg-gray-200 dark:hover:bg-zinc-700"},g(j.display_name),9,Dt))),128))])):k("",!0)])]),o("div",Rt,[p[17]||(p[17]=o("p",{class:"font-semibold text-base"},"Meetup Date",-1)),c(Ue,null,{content:C(()=>[c(Fe,{modelValue:n.value,"onUpdate:modelValue":p[3]||(p[3]=j=>n.value=j),class:"p-2",minValue:r(m)},null,8,["modelValue","minValue"])]),default:C(()=>[c(ye,{color:"neutral",variant:"subtle",icon:"i-lucide-calendar"},{default:C(()=>[G(g(d.value||"Select a date"),1)]),_:1})]),_:1})]),o("div",Bt,[p[18]||(p[18]=o("p",{class:"font-semibold text-base"},"Meetup Time Window",-1)),o("div",Vt,[c(r(ce),{modelValue:Y.value,"onUpdate:modelValue":p[4]||(p[4]=j=>Y.value=j),onChange:se,format:"HH:mm","use12-hour":!1,placeholder:"Start Time"},null,8,["modelValue"]),c(r(ce),{modelValue:ne.value,"onUpdate:modelValue":p[5]||(p[5]=j=>ne.value=j),onChange:se,format:"HH:mm","use12-hour":!1,placeholder:"End Time"},null,8,["modelValue"])]),Z.value?(u(),w("p",At,g(Z.value),1)):k("",!0)]),o("div",Ht,[c(ye,{onClick:p[6]||(p[6]=j=>K.value=!1),class:"bg-slate-300 hover:bg-slate-400 text-black dark:bg-slate-400 dark:hover:bg-slate-500 px-4 py-2 rounded"},{default:C(()=>[...p[19]||(p[19]=[o("p",null,"Cancel",-1)])]),_:1}),c(ye,{onClick:I(ie,["stop","prevent"]),disabled:!!Z.value||!Y.value||!ne.value||!U.value||!X.value||!r(O)||r(a)||z.value||ee.value,class:"bg-slate-800 hover:bg-slate-700 text-white dark:bg-slate-700 dark:hover:bg-slate-600 px-4 py-2 rounded disabled:bg-slate-600 disabled:dark:bg-slate-500 disabled:cursor-not-allowed"},{default:C(()=>[!r(a)&&!ee.value?(u(),w("p",Mt,"Send Rental Request")):(u(),w("p",Ot,"Sending..."))]),_:1},8,["disabled"])])]),_:1},8,["open"])}}}),Lt=Object.assign(Et,{__name:"RentBookModal"}),xe="http://127.0.0.1:8080",Se=()=>{const e=A(!1),t=A(!1),s=A(null),a=_e(),{$apiFetch:l}=we();return{loading:t,error:s,createPurchase:async i=>{t.value=!0,s.value=null;try{await l(`${xe}/api/wallets/update-reserved-amount`,{method:"PATCH",body:{amount_to_reserve:i.total_buy_cost},credentials:"include"});const m=await l(`${xe}/api/purchases/create`,{method:"POST",body:i,credentials:"include"});return a.add({title:"Success",description:"Purchase request sent successfully",color:"success"}),m}catch(m){throw s.value=m?.data?.message||m?.data?.error||m?.message||"Failed to process purchase",a.add({title:"Error",description:s.value??"Failed to process purchase",color:"error"}),m}finally{t.value=!1}},checkPurchaseExists:async i=>{try{const m=await l(`${xe}/api/purchases/check/${i}`,{method:"GET",credentials:"include"});e.value=m.exists}catch(m){console.error(m)}},purchaseExists:e}},Pt={class:"text-2xl font-semibold"},$t={class:"p-4 bg-surface-hover space-y-3 rounded-sm"},Ft={class:"flex items-center justify-between text-sm text-base"},Ut={class:"flex items-center justify-between text-sm text-base"},Nt={class:"flex items-center gap-1"},qt={class:"flex items-start justify-between font-semibold text-base mt-2"},zt={class:"flex flex-col items-end"},jt={class:"flex items-center gap-1"},Kt={class:"text-xs text-gray-500 font-normal"},Wt={key:0,class:"flex items-center gap-2 mt-2 p-2 bg-red-50 dark:bg-red-900/20 rounded border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 text-sm"},Jt={class:"mt-4"},Yt={class:"relative w-full"},Gt={key:0,class:"absolute z-50 bg-white dark:bg-zinc-800 border border-gray-300 dark:border-zinc-700 rounded w-full max-h-60 overflow-auto shadow-lg"},Qt=["onClick"],Xt={class:"mt-4"},Zt={class:"mt-4"},es={class:"flex gap-2 mt-1"},ts={key:0,class:"text-red-500 text-sm mt-1"},ss={class:"flex justify-end gap-3 mt-6"},ns={key:0},is={key:1},as=be({__name:"PurchaseBookModal",props:{isOpenPurchaseBookModal:{type:Boolean},bookId:{},bookTitle:{},bookAuthor:{},purchasePrice:{},currentWalletBalance:{},purchaseExists:{type:Boolean},reserved_amount:{}},emits:["update:openPurchaseBookModal","purchase-success","update:purchaseExists"],setup(e,{emit:t}){const{createPurchase:s,loading:a}=Se(),l=new Me("en-US",{dateStyle:"medium"}),n=De(null),h=new Date,i=new Date(h.getTime()+1440*60*1e3),m=new Oe(i.getFullYear(),i.getMonth()+1,i.getDate()),d=q(()=>n.value?l.format(n.value.toDate(ke())):"");oe(n,x=>{x&&x<m&&(n.value=m),D.value=x?x.toString():null});const T="pk.8766fa6ab4b87b62cae79f213146bdc0",M=A(""),{addressQuery:O,suggestions:V,fetchSuggestions:Q,selectSuggestion:E}=Pe(T),D=A(null),b=A(null),K=A(null),J=A(""),S=e,F=t,U=q({get:()=>S.isOpenPurchaseBookModal,set:x=>F("update:openPurchaseBookModal",x)}),X=q(()=>{const x=S.currentWalletBalance??0,v=S.reserved_amount??0;return x-v}),Y=q(()=>(S.purchasePrice??0)>X.value);function ne(x){if(!x.target.value){V.value=[];return}Q()}function Z(x){E(x,M),O.value=x.display_name,M.value=x.display_name,V.value=[],document.querySelector('input[v-model="meetupAddressQuery"]')?.blur()}function te(x){return x?typeof x=="string"?x:typeof x=="object"&&x.HH&&x.mm?`${x.HH}:${x.mm}`:"":""}function se(){const x=te(b.value),v=te(K.value);if(!x||!v){J.value="";return}const z=new Date(`1970-01-01T${x}:00`);new Date(`1970-01-01T${v}:00`)<=z?J.value="End time must be later than start time":J.value=""}function L(x){if(!x)return"";const[v,z]=x.split(":");if(!v||!z)return"";let P=parseInt(v);const ee=parseInt(z),ie=P>=12?"PM":"AM";return P===0&&(P=12),P>12&&(P-=12),`${P}:${ee.toString().padStart(2,"0")} ${ie}`}oe([b,K],se),oe(()=>S.isOpenPurchaseBookModal,x=>{x&&(_.value=!1,J.value="")});const _=A(!1);async function le(){if(se(),!(_.value||J.value||Y.value)&&!(!D.value||!O.value||!b.value||!K.value)){_.value=!0;try{const x=te(b.value),v=te(K.value),z=L(x),P=L(v);if(!z||!P){J.value="Please select valid start and end times",_.value=!1;return}await s({book_id:S.bookId,total_buy_cost:S.purchasePrice,meetup_location:O.value,meetup_date:D.value,meetup_time_window:`${z} - ${P}`}),F("update:purchaseExists",!0),F("purchase-success"),U.value=!1}catch(x){console.error(x),_.value=!1}}}return(x,v)=>{const z=Ae,P=Te,ee=He,ie=ue,f=$e,p=Ee,W=Le;return u(),y(W,{open:U.value,"onUpdate:open":v[5]||(v[5]=H=>U.value=H),ui:{content:"max-w-lg"},dismissible:!0},{header:C(()=>[o("h2",Pt,"Buy "+g(S.bookTitle),1)]),body:C(()=>[o("div",$t,[v[10]||(v[10]=o("p",{class:"font-semibold text-base"},"Purchase Details",-1)),o("div",Ft,[v[6]||(v[6]=o("span",null,"Book:",-1)),o("span",null,g(S.bookTitle),1)]),o("div",Ut,[v[7]||(v[7]=o("span",null,"Author:",-1)),o("span",null,g(S.bookAuthor),1)]),c(z,{orientation:"horizontal",class:"my-2 bg-slate-400"}),o("div",{class:$(["flex items-center justify-between font-semibold text-base",{"text-red-500":Y.value}])},[v[8]||(v[8]=o("span",null,"Total Cost:",-1)),o("div",Nt,[c(P,{name:"fluent:book-coins-20-regular",class:$(["w-5 h-5",Y.value?"text-red-500":"text-accent"])},null,8,["class"]),o("span",null,g(S.purchasePrice),1)])],2),o("div",qt,[v[9]||(v[9]=o("span",{class:"mt-0.5"},"Available Balance:",-1)),o("div",zt,[o("div",jt,[c(P,{name:"fluent:book-coins-20-regular",class:"w-5 h-5 text-accent"}),o("span",null,g(X.value),1)]),o("span",Kt," ("+g(S.currentWalletBalance)+" total - "+g(S.reserved_amount)+" reserved) ",1)])])]),Y.value?(u(),w("div",Wt,[c(P,{name:"i-heroicons-exclamation-circle",class:"w-5 h-5 shrink-0"}),v[11]||(v[11]=o("span",null," Insufficient available funds. ",-1))])):k("",!0),o("div",Jt,[v[12]||(v[12]=o("p",{class:"font-semibold text-base"},"Meetup Location",-1)),o("div",Yt,[c(ee,{modelValue:r(O),"onUpdate:modelValue":v[0]||(v[0]=H=>Re(O)?O.value=H:null),placeholder:"Enter meetup location...",class:"mt-1 w-full",onInput:ne},null,8,["modelValue"]),r(V).length?(u(),w("ul",Gt,[(u(!0),w(B,null,N(r(V),(H,he)=>(u(),w("li",{key:he,onClick:me=>Z(H),class:"p-2 cursor-pointer hover:bg-gray-200 dark:hover:bg-zinc-700"},g(H.display_name),9,Qt))),128))])):k("",!0)])]),o("div",Xt,[v[13]||(v[13]=o("p",{class:"font-semibold text-base"},"Meetup Date",-1)),c(p,null,{content:C(()=>[c(f,{modelValue:n.value,"onUpdate:modelValue":v[1]||(v[1]=H=>n.value=H),class:"p-2",minValue:r(m)},null,8,["modelValue","minValue"])]),default:C(()=>[c(ie,{color:"neutral",variant:"subtle",icon:"i-lucide-calendar"},{default:C(()=>[G(g(d.value||"Select a date"),1)]),_:1})]),_:1})]),o("div",Zt,[v[14]||(v[14]=o("p",{class:"font-semibold text-base"},"Meetup Time Window",-1)),o("div",es,[c(r(ce),{modelValue:b.value,"onUpdate:modelValue":v[2]||(v[2]=H=>b.value=H),onChange:se,format:"HH:mm","use12-hour":!1,placeholder:"Start Time"},null,8,["modelValue"]),c(r(ce),{modelValue:K.value,"onUpdate:modelValue":v[3]||(v[3]=H=>K.value=H),onChange:se,format:"HH:mm","use12-hour":!1,placeholder:"End Time"},null,8,["modelValue"])]),J.value?(u(),w("p",ts,g(J.value),1)):k("",!0)]),o("div",ss,[c(ie,{onClick:v[4]||(v[4]=H=>U.value=!1),class:"bg-slate-300 hover:bg-slate-400 text-black dark:bg-slate-400 dark:hover:bg-slate-500 px-4 py-2 rounded"},{default:C(()=>[...v[15]||(v[15]=[o("p",null,"Cancel",-1)])]),_:1}),c(ie,{onClick:I(le,["stop","prevent"]),class:"bg-slate-800 hover:bg-slate-700 text-white dark:bg-slate-700 dark:hover:bg-slate-600 px-4 py-2 rounded disabled:bg-slate-600 disabled:dark:bg-slate-500 disabled:cursor-not-allowed",disabled:!!J.value||!b.value||!K.value||!D.value||!r(O)||r(a)||Y.value||_.value},{default:C(()=>[!r(a)&&!_.value?(u(),w("p",ns,"Confirm Purchase")):(u(),w("p",is,"Processing..."))]),_:1},8,["disabled"])])]),_:1},8,["open"])}}}),ls=Object.assign(as,{__name:"PurchaseBookModal"}),os={class:"font-semibold text-lg mb-4 flex items-center gap-2 text-base"},rs={key:0,class:"bg-blue-100 dark:bg-blue-900/30 rounded-lg p-4 border-2 border-blue-200 dark:border-blue-700"},us={class:"text-blue-700 dark:text-blue-400 font-semibold mb-3 flex items-center gap-2"},ds={class:"space-y-2 text-sm mb-3"},cs={class:"flex justify-between items-center"},hs={class:"flex items-center gap-1 text-base"},ms={class:"flex font-bold text-accent items-center"},ps={class:"flex justify-between items-center"},fs={class:"flex items-center gap-1 text-base"},gs={class:"flex items-center font-bold text-accent"},bs={class:"text-xs text-muted bg-surface/50 rounded p-2 flex items-start gap-2"},ys={key:1,class:"bg-green-100 dark:bg-green-900/30 rounded-lg p-4 border-2 border-green-200 dark:border-green-700"},vs={class:"text-green-700 dark:text-green-400 font-semibold mb-3 flex items-center gap-2"},xs={class:"space-y-2 text-sm mb-3"},ks={class:"flex justify-between items-center"},ws={class:"flex items-center gap-1 text-base"},Ts={class:"flex items-center font-bold text-accent"},Cs={class:"text-xs text-muted bg-surface/50 rounded p-2 flex items-start gap-2"},Ss=["disabled"],Is={key:0},_s={key:1},Ds=["disabled"],Rs={key:0},Bs={key:1},Vs=be({__name:"BookPricing",props:{availability:{},dailyRentPrice:{},securityDeposit:{},purchasePrice:{},bookId:{},rentalExists:{type:Boolean},purchaseExists:{type:Boolean}},emits:["rent","purchase"],setup(e,{emit:t}){const s=e,a=t,{checkRentalExists:l}=Ce(),{checkPurchaseExists:n}=Se();ge(async()=>{s.bookId&&(await l(s.bookId),await n(s.bookId))});const h=()=>{a("rent")},i=()=>{a("purchase")};return(m,d)=>{const T=Be,M=Ve;return u(),y(M,{class:"bg-blue-50 dark:bg-blue-950/20 border-blue-200 dark:border-blue-800"},{default:C(()=>[o("h2",os,[c(T,{name:"fluent:book-coins-20-regular",class:"text-xl w-7 h-7"}),d[0]||(d[0]=G(" Pricing Options ",-1))]),o("div",{class:$(["grid gap-4",e.availability==="both"?"md:grid-cols-2":"grid-cols-1"])},[e.availability==="rent"||e.availability==="both"?(u(),w("div",rs,[o("h3",us,[c(T,{name:"i-heroicons-book-open",class:"text-xl"}),d[1]||(d[1]=G(" Rental Option ",-1))]),o("div",ds,[o("div",cs,[o("span",hs,[c(T,{name:"i-heroicons-calendar",class:"text-base w-5 h-5"}),d[2]||(d[2]=G(" Daily Rate ",-1))]),o("span",ms,[c(T,{name:"fluent:book-coins-20-regular",class:"w-5 h-5"}),G(" "+g(e.dailyRentPrice),1)])]),o("div",ps,[o("span",fs,[c(T,{name:"i-heroicons-shield-check",class:"text-base w-5 h-5"}),d[3]||(d[3]=G(" Deposit ",-1))]),o("span",gs,[c(T,{name:"fluent:book-coins-20-regular",class:"w-5 h-5"}),G(" "+g(e.securityDeposit),1)])])]),o("div",bs,[c(T,{name:"i-heroicons-shield-check",class:"text-sm flex-shrink-0 mt-0.5 w-4 h-4"}),d[4]||(d[4]=o("span",null,"Deposit refunded upon safe return",-1))])])):k("",!0),e.availability==="purchase"||e.availability==="both"?(u(),w("div",ys,[o("h3",vs,[c(T,{name:"i-heroicons-shopping-cart",class:"text-xl"}),d[5]||(d[5]=G(" Purchase Option ",-1))]),o("div",xs,[o("div",ks,[o("span",ws,[c(T,{name:"i-heroicons-currency-dollar",class:"text-base w-5 h-5"}),d[6]||(d[6]=G(" One-time Price ",-1))]),o("span",Ts,[c(T,{name:"fluent:book-coins-20-regular",class:"w-5 h-5"}),G(" "+g(e.purchasePrice),1)])]),d[7]||(d[7]=o("div",{class:"flex justify-between items-center"},[o("span",{class:"text-base"},"Ownership"),o("span",{class:"font-bold text-accent"},"Forever")],-1))]),o("div",Cs,[c(T,{name:"i-heroicons-shopping-cart",class:"text-sm flex-shrink-0 mt-0.5"}),d[8]||(d[8]=o("span",null,"Own the book permanently - no returns needed",-1))])])):k("",!0)],2),o("div",{class:$(["grid gap-3 mt-6",e.availability==="both"?"md:grid-cols-2":"grid-cols-1"])},[e.availability==="rent"||e.availability==="both"?(u(),w("button",{key:0,onClick:h,disabled:s.rentalExists,class:"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg transition flex items-center justify-center gap-2 cursor-pointer disabled:bg-blue-400 disabled:dark:bg-blue-600 disabled:text-white disabled:cursor-not-allowed"},[c(T,{name:"i-heroicons-book-open",class:"text-xl"}),s.rentalExists?(u(),w("span",Is,"Request Already Sent")):(u(),w("span",_s,"Rent This Book"))],8,Ss)):k("",!0),e.availability==="purchase"||e.availability==="both"?(u(),w("button",{key:1,onClick:i,disabled:s.purchaseExists,class:"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg transition flex items-center justify-center gap-2 cursor-pointer disabled:bg-blue-400 disabled:dark:bg-blue-600 disabled:text-white disabled:cursor-not-allowed"},[c(T,{name:"i-heroicons-shopping-cart",class:"text-xl"}),s.purchaseExists?(u(),w("span",Rs,"Request Already Sent")):(u(),w("span",Bs,"Buy This Book"))],8,Ds)):k("",!0)],2)]),_:1})}}}),As=Object.assign(Vs,{__name:"BookPricing"});function Hs(){const{$apiFetch:e}=we();return e("/api/wallets/get-reserved-amount",{method:"GET",credentials:"include"})}const Ms={class:"min-h-screen w-full bg-background pt-4 pb-6 px-4 md:px-8 lg:px-15"},Os={key:0,class:"flex items-center justify-center h-screen"},Es={class:"text-center"},Ls={key:1,class:"flex items-center justify-center h-screen"},Ps={class:"text-center p-6"},$s={key:0,class:"text-muted mb-4"},Fs={key:1,class:"text-muted mb-4"},Us={key:2,class:"max-w-7xl pt-3 mx-auto"},Ns={class:"font-medium"},qs={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},zs={class:"relative bg-zinc-200 dark:bg-zinc-800 rounded-lg overflow-hidden mb-4 aspect-[3/4]"},js=["src","alt"],Ks={key:1,class:"w-full h-full flex items-center justify-center text-muted"},Ws={key:0,class:"px-[9%] mb-6"},Js=["onClick"],Ys=["src","alt"],Gs={class:"space-y-4"},Qs={class:"flex justify-between items-center py-3 px-3 border-y border-base"},Xs={class:"font-bold text-base"},Zs={class:"flex items-center justify-between"},en={class:"flex items-center gap-3"},tn={class:"relative"},sn=["src","alt"],nn={key:1,class:"w-10 h-10 rounded-full bg-surface flex items-center justify-center"},an={class:"flex flex-col items-end"},ln={class:"text-2xl font-bold text-base"},on={class:"flex flex-col"},rn={class:"flex-grow"},un={class:"text-[42px] font-bold text-base mb-2"},dn={class:"text-muted mb-4"},cn={class:"flex flex-wrap gap-2 mb-6"},hn={class:"px-3 py-1 bg-yellow-400 text-zinc-900 rounded-full text-sm font-medium capitalize"},mn={class:"mb-6"},pn={class:"text-base text-justify leading-relaxed"},fn={class:"mt-auto"},Pn=be({__name:"[bookId]",setup(e){const t=Ge(),s=Qe(),a=t.params.bookId,{rentalExists:l,checkRentalExists:n}=Ce(),{purchaseExists:h,checkPurchaseExists:i}=Se(),m=A(!1),d=A(!1),T=A(0),M=A(0),O=A(!0);ge(async()=>{O.value=!0;const L=await it();T.value=L.currentWalletBalance??0,O.value=!1}),ge(async()=>{O.value=!0;const L=await Hs();M.value=L.reserved_amount??0,O.value=!1});const V=()=>{m.value=!0},Q=()=>{l.value=!0,m.value=!1},E=()=>{d.value=!0},D=()=>{h.value=!0,m.value=!1},{book:b,loading:K,fetchBookDetails:J,availabilityBadges:S,ownerTrustBadge:F}=nt(),U=A(0),X=q(()=>b.value?b.value.is_rented||b.value.is_purchased:!1),Y=q(()=>{if(!b.value)return!1;const L=t.query.from,_=t.query.collectionOwnerId;return L==="user-collection"&&_?b.value.owner_user_id!==_:!1});ge(async()=>{try{await J(a)}catch(L){console.error("Failed to fetch book details:",L)}});const ne=L=>{U.value=L},Z=()=>{const L=t.query.from;L==="browse"?s.push("/browse"):L==="user-collection"?s.push(`/users/${b.value?.owner_user_id}/collection`):s.push("/browse")},te=q(()=>{const L=t.query.from;return L==="browse"?"Back to Browse":L==="user-collection"?"Back to Collection":"Back to Browse"}),se=L=>{const _={blue:"bg-blue-600 text-white dark:bg-blue-500",red:"bg-red-600 text-white dark:bg-red-500"};return _[L]||_.gray};return ge(async()=>{a&&await Promise.all([n(a),i(a)])}),(L,_)=>{const le=Be,x=Ve,v=Ze,z=Te,P=Xe,ee=Lt,ie=ls;return u(),w("div",Ms,[r(K)?(u(),w("div",Os,[o("div",Es,[c(le,{name:"i-heroicons-arrow-path",class:"w-8 h-8 animate-spin text-accent"}),_[2]||(_[2]=o("p",{class:"text-muted mt-2"},"Loading book details...",-1))])])):r(X)||r(Y)?(u(),w("div",Ls,[c(x,{class:"bg-surface border-base max-w-md"},{default:C(()=>[o("div",Ps,[c(le,{name:"i-heroicons-exclamation-triangle",class:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),_[3]||(_[3]=o("h2",{class:"text-2xl font-bold text-base mb-2"},"Book Currently Unavailable",-1)),r(Y)?(u(),w("p",$s," This book does not belong to this user's collection. ")):(u(),w("p",Fs," This book is "+g(r(b)?.is_rented?"currently rented":"purchased")+" and cannot be viewed at this time. ",1)),o("button",{onClick:Z,class:"px-6 py-2 bg-accent text-white rounded-lg hover:bg-accent/90 transition cursor-pointer"}," Go Back ")])]),_:1})])):r(b)?(u(),w("div",Us,[o("button",{class:"flex items-center gap-2 mb-6 text-base hover:text-accent transition cursor-pointer",onClick:Z},[c(le,{name:"i-heroicons-arrow-left",class:"text-xl"}),o("span",Ns,g(r(te)),1)]),c(x,{class:"bg-surface border-base"},{default:C(()=>[o("div",qs,[o("div",null,[o("div",zs,[r(b).images.length>0?(u(),w("img",{key:0,src:r(b).images[r(U)],alt:r(b).title,class:"w-full h-full object-cover"},null,8,js)):(u(),w("div",Ks,[c(le,{name:"i-heroicons-book-open",class:"text-8xl"})]))]),r(b).images.length>1?(u(),w("div",Ws,[c(v,{items:r(b).images,ui:{item:"basis-[85px]",container:"gap-2"},arrows:""},{default:C(({item:f,index:p})=>[o("button",{onClick:W=>ne(p),class:$(["w-[85px] h-[115px] rounded-lg overflow-hidden border-2 transition",p===r(U)?"border-accent":"border-base hover:border-accent/50"])},[o("img",{src:f,alt:`${r(b).title} ${p+1}`,class:"w-full h-full object-cover"},null,8,Ys)],10,Js)]),_:1},8,["items"])])):k("",!0),o("div",Gs,[o("div",Qs,[_[4]||(_[4]=o("span",{class:"font-semibold text-base"},"Times rented:",-1)),o("span",Xs,g(r(b).times_rented||0),1)]),c(x,{class:"bg-background border-base"},{default:C(()=>[_[5]||(_[5]=o("h3",{class:"font-semibold mb-3 text-base"},"Owner Information",-1)),o("div",Zs,[o("div",en,[o("div",tn,[r(b).owner_profile_picture?(u(),w("img",{key:0,src:r(b).owner_profile_picture,alt:r(b).owner_username,class:"w-10 h-10 rounded-full object-cover"},null,8,sn)):(u(),w("div",nn,[c(z,{name:"heroicons:user-solid",class:"w-7 h-7 text-muted"})]))]),o("div",null,[c(P,{to:`/users/${r(b).owner_user_id}`,class:"font-medium text-base px-1 py-1 hover:text-accent rounded-md hover:bg-surface-hover transition cursor-pointer"},{default:C(()=>[G(g(r(b).owner_username),1)]),_:1},8,["to"])])]),o("div",an,[o("span",ln,g(r(b).owner_trust_score),1),o("span",{class:$(["text-xs px-2 py-1 rounded-full font-medium text-white",[r(F).color,r(F).text==="Poor"?"border border-white":""]])},g(r(F).text),3)])])]),_:1})])]),o("div",on,[o("div",rn,[o("h1",un,g(r(b).title.length>130?r(b).title.substring(0,130)+"...":r(b).title),1),o("p",dn,"by "+g(r(b).author),1),o("div",cn,[(u(!0),w(B,null,N(r(b).genres,(f,p)=>(u(),w("span",{key:p,class:"px-3 py-1 bg-surface border border-base rounded-full text-sm text-base"},g(f),1))),128)),o("span",hn,g(r(b).condition),1),(u(!0),w(B,null,N(r(S),(f,p)=>(u(),w("span",{key:`avail-${p}`,class:$(["px-3 py-1 rounded-full text-sm font-medium",se(f.color)])},g(f.label),3))),128))]),o("div",mn,[_[6]||(_[6]=o("h2",{class:"font-semibold text-lg mb-2 text-base"},"Description",-1)),o("p",pn,g(r(b).description),1)])]),o("div",fn,[c(As,{availability:r(b).availability,"daily-rent-price":r(b).daily_rent_price,"security-deposit":r(b).security_deposit,"purchase-price":r(b).purchase_price,"book-id":r(a)??"","rental-exists":r(l),"purchase-exists":r(h),onRent:V,onPurchase:E},null,8,["availability","daily-rent-price","security-deposit","purchase-price","book-id","rental-exists","purchase-exists"])])])])]),_:1})])):k("",!0),c(ee,{"is-open-rent-book-modal":r(m),"book-id":r(a)??"","book-title":r(b)?.title,"daily-rent-price":r(b)?.daily_rent_price,"security-deposit":r(b)?.security_deposit,"rental-exists":r(l),"current-wallet-balance":r(T),"reserved-amount":r(M),"owner-user-id":r(b)?.owner_user_id,"onUpdate:openRentBookModal":_[0]||(_[0]=f=>m.value=f),onRentalSuccess:Q},null,8,["is-open-rent-book-modal","book-id","book-title","daily-rent-price","security-deposit","rental-exists","current-wallet-balance","reserved-amount","owner-user-id"]),c(ie,{"is-open-purchase-book-modal":r(d),"book-id":r(a)??"","book-title":r(b)?.title,"book-author":r(b)?.author,"purchase-price":r(b)?.purchase_price,"current-wallet-balance":r(T),"purchase-exists":r(h),reserved_amount:r(M),"onUpdate:openPurchaseBookModal":_[1]||(_[1]=f=>d.value=f),onPurchaseSuccess:D},null,8,["is-open-purchase-book-modal","book-id","book-title","book-author","purchase-price","current-wallet-balance","purchase-exists","reserved_amount"])])}}});export{Pn as default};
