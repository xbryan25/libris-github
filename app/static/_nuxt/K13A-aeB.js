import{e as D,f as H,o as a,w as p,a as e,b as n,d as b,ae as O,c as i,s as _,t as c,ad as v,b1 as M,b2 as S,m as W,D as B,p as A,q as t,g as J,_ as K,G as I,H as R}from"#entry";import{_ as T}from"./GmZGs_j5.js";import{_ as Q}from"./DDF3RqbE.js";import{u as X}from"./DeVDuZcp.js";const Y={class:"font-semibold text-lg mb-4 flex items-center gap-2 text-base"},Z={key:0,class:"bg-blue-100 dark:bg-blue-900/30 rounded-lg p-4 border-2 border-blue-200 dark:border-blue-700"},ee={class:"text-blue-700 dark:text-blue-400 font-semibold mb-3 flex items-center gap-2"},te={class:"space-y-2 text-sm mb-3"},se={class:"flex justify-between items-center"},oe={class:"flex items-center gap-1 text-base"},ne={class:"flex font-bold text-accent items-center"},ae={class:"flex justify-between items-center"},ie={class:"flex items-center gap-1 text-base"},re={class:"flex items-center font-bold text-accent"},le={class:"text-xs text-muted bg-surface/50 rounded p-2 flex items-start gap-2"},ce={key:1,class:"bg-green-100 dark:bg-green-900/30 rounded-lg p-4 border-2 border-green-200 dark:border-green-700"},de={class:"text-green-700 dark:text-green-400 font-semibold mb-3 flex items-center gap-2"},ue={class:"space-y-2 text-sm mb-3"},be={class:"flex justify-between items-center"},me={class:"flex items-center gap-1 text-base"},xe={class:"flex items-center font-bold text-accent"},fe={class:"text-xs text-muted bg-surface/50 rounded p-2 flex items-start gap-2"},he=D({__name:"BookPricing",props:{availability:{},dailyRentPrice:{},securityDeposit:{},purchasePrice:{}},emits:["rent","purchase"],setup(d,{emit:m}){const f=m,g=()=>{f("rent")},s=()=>{f("purchase")};return(C,o)=>{const l=O,y=T;return a(),H(y,{class:"bg-blue-50 dark:bg-blue-950/20 border-blue-200 dark:border-blue-800"},{default:p(()=>[e("h2",Y,[n(l,{name:"fluent:book-coins-20-regular",class:"text-xl w-7 h-7"}),o[0]||(o[0]=b(" Pricing Options ",-1))]),e("div",{class:v(["grid gap-4",d.availability==="both"?"md:grid-cols-2":"grid-cols-1"])},[d.availability==="rent"||d.availability==="both"?(a(),i("div",Z,[e("h3",ee,[n(l,{name:"i-heroicons-book-open",class:"text-xl"}),o[1]||(o[1]=b(" Rental Option ",-1))]),e("div",te,[e("div",se,[e("span",oe,[n(l,{name:"i-heroicons-calendar",class:"text-base w-5 h-5"}),o[2]||(o[2]=b(" Daily Rate ",-1))]),e("span",ne,[n(l,{name:"fluent:book-coins-20-regular",class:"w-5 h-5"}),b(" "+c(d.dailyRentPrice),1)])]),e("div",ae,[e("span",ie,[n(l,{name:"i-heroicons-shield-check",class:"text-base w-5 h-5"}),o[3]||(o[3]=b(" Deposit ",-1))]),e("span",re,[n(l,{name:"fluent:book-coins-20-regular",class:"w-5 h-5"}),b(" "+c(d.securityDeposit),1)])])]),e("div",le,[n(l,{name:"i-heroicons-shield-check",class:"text-sm flex-shrink-0 mt-0.5 w-4 h-4"}),o[4]||(o[4]=e("span",null,"Deposit refunded upon safe return",-1))])])):_("",!0),d.availability==="purchase"||d.availability==="both"?(a(),i("div",ce,[e("h3",de,[n(l,{name:"i-heroicons-shopping-cart",class:"text-xl"}),o[5]||(o[5]=b(" Purchase Option ",-1))]),e("div",ue,[e("div",be,[e("span",me,[n(l,{name:"i-heroicons-currency-dollar",class:"text-base w-5 h-5"}),o[6]||(o[6]=b(" One-time Price ",-1))]),e("span",xe,[n(l,{name:"fluent:book-coins-20-regular",class:"w-5 h-5"}),b(" "+c(d.purchasePrice),1)])]),o[7]||(o[7]=e("div",{class:"flex justify-between items-center"},[e("span",{class:"text-base"},"Ownership"),e("span",{class:"font-bold text-accent"},"Forever")],-1))]),e("div",fe,[n(l,{name:"i-heroicons-shopping-cart",class:"text-sm flex-shrink-0 mt-0.5"}),o[8]||(o[8]=e("span",null,"Own the book permanently - no returns needed",-1))])])):_("",!0)],2),e("div",{class:v(["grid gap-3 mt-6",d.availability==="both"?"md:grid-cols-2":"grid-cols-1"])},[d.availability==="rent"||d.availability==="both"?(a(),i("button",{key:0,onClick:g,class:"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg transition flex items-center justify-center gap-2 cursor-pointer"},[n(l,{name:"i-heroicons-book-open",class:"text-xl"}),o[9]||(o[9]=b(" Rent This Book ",-1))])):_("",!0),d.availability==="purchase"||d.availability==="both"?(a(),i("button",{key:1,onClick:s,class:"bg-green-700 hover:bg-green-800 dark:bg-green-500 dark:hover:bg-green-600 text-white font-semibold py-3 px-6 rounded-lg transition flex items-center justify-center gap-2 cursor-pointer"},[n(l,{name:"i-heroicons-shopping-cart",class:"text-xl"}),o[10]||(o[10]=b(" Buy This Book ",-1))])):_("",!0)],2)]),_:1})}}}),pe=Object.assign(he,{__name:"BookPricing"}),_e={class:"min-h-screen w-full bg-background pt-4 pb-6 px-4 md:px-8 lg:px-15"},ge={key:0,class:"flex items-center justify-center h-screen"},ye={class:"text-center"},ve={key:1,class:"flex items-center justify-center h-screen"},ke={class:"text-center p-6"},we={key:0,class:"text-muted mb-4"},$e={key:1,class:"text-muted mb-4"},Be={key:2,class:"max-w-7xl pt-3 mx-auto"},Ce={class:"font-medium"},je={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},Pe={class:"relative bg-zinc-200 dark:bg-zinc-800 rounded-lg overflow-hidden mb-4 aspect-[3/4]"},Ie=["src","alt"],Re={key:1,class:"w-full h-full flex items-center justify-center text-muted"},De={key:0,class:"px-[9%] mb-6"},Oe=["onClick"],Te=["src","alt"],Ue={class:"space-y-4"},qe={class:"flex justify-between items-center py-3 px-3 border-y border-base"},ze={class:"font-bold text-base"},Ne={class:"flex items-center justify-between"},Ve={class:"flex items-center gap-3"},Fe={class:"relative"},Le=["src","alt"],Ge={key:1,class:"w-10 h-10 rounded-full bg-surface flex items-center justify-center"},Ee={class:"flex flex-col items-end"},He={class:"text-2xl font-bold text-base"},Me={class:"flex flex-col"},Se={class:"flex-grow"},We={class:"text-[42px] font-bold text-base mb-2"},Ae={class:"text-muted mb-4"},Je={class:"flex flex-wrap gap-2 mb-6"},Ke={class:"px-3 py-1 bg-yellow-400 text-zinc-900 rounded-full text-sm font-medium capitalize"},Qe={class:"mb-6"},Xe={class:"text-base text-justify leading-relaxed"},Ye={class:"mt-auto"},nt=D({__name:"[bookId]",setup(d){const m=M(),f=S(),g=m.params.bookId,{book:s,loading:C,fetchBookDetails:o,availabilityBadges:l,ownerTrustBadge:y}=X(),w=W(0),U=B(()=>s.value?s.value.is_rented||s.value.is_purchased:!1),j=B(()=>{if(!s.value)return!1;const u=m.query.from,r=m.query.collectionOwnerId;return u==="user-collection"&&r?s.value.owner_user_id!==r:!1});A(async()=>{try{await o(g)}catch(u){console.error("Failed to fetch book details:",u)}});const q=u=>{w.value=u},z=()=>{console.log("Rent book:",g)},N=()=>{console.log("Purchase book:",g)},P=()=>{const u=m.query.from;u==="browse"?f.push("/browse"):u==="user-collection"?f.push(`/users/${s.value?.owner_user_id}/collection`):f.push("/browse")},V=B(()=>{const u=m.query.from;return u==="browse"?"Back to Browse":u==="user-collection"?"Back to Collection":"Back to Browse"}),F=u=>{const r={blue:"bg-blue-600 text-white dark:bg-blue-500",red:"bg-red-600 text-white dark:bg-red-500"};return r[u]||r.gray};return(u,r)=>{const k=O,$=T,L=Q,G=J,E=K;return a(),i("div",_e,[t(C)?(a(),i("div",ge,[e("div",ye,[n(k,{name:"i-heroicons-arrow-path",class:"w-8 h-8 animate-spin text-accent"}),r[0]||(r[0]=e("p",{class:"text-muted mt-2"},"Loading book details...",-1))])])):t(U)||t(j)?(a(),i("div",ve,[n($,{class:"bg-surface border-base max-w-md"},{default:p(()=>[e("div",ke,[n(k,{name:"i-heroicons-exclamation-triangle",class:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),r[1]||(r[1]=e("h2",{class:"text-2xl font-bold text-base mb-2"},"Book Currently Unavailable",-1)),t(j)?(a(),i("p",we," This book does not belong to this user's collection. ")):(a(),i("p",$e," This book is "+c(t(s)?.is_rented?"currently rented":"purchased")+" and cannot be viewed at this time. ",1)),e("button",{onClick:P,class:"px-6 py-2 bg-accent text-white rounded-lg hover:bg-accent/90 transition cursor-pointer"}," Go Back ")])]),_:1})])):t(s)?(a(),i("div",Be,[e("button",{class:"flex items-center gap-2 mb-6 text-base hover:text-accent transition cursor-pointer",onClick:P},[n(k,{name:"i-heroicons-arrow-left",class:"text-xl"}),e("span",Ce,c(t(V)),1)]),n($,{class:"bg-surface border-base"},{default:p(()=>[e("div",je,[e("div",null,[e("div",Pe,[t(s).images.length>0?(a(),i("img",{key:0,src:t(s).images[t(w)],alt:t(s).title,class:"w-full h-full object-cover"},null,8,Ie)):(a(),i("div",Re,[n(k,{name:"i-heroicons-book-open",class:"text-8xl"})]))]),t(s).images.length>1?(a(),i("div",De,[n(L,{items:t(s).images,ui:{item:"basis-[85px]",container:"gap-2"},arrows:""},{default:p(({item:h,index:x})=>[e("button",{onClick:Ze=>q(x),class:v(["w-[85px] h-[115px] rounded-lg overflow-hidden border-2 transition",x===t(w)?"border-accent":"border-base hover:border-accent/50"])},[e("img",{src:h,alt:`${t(s).title} ${x+1}`,class:"w-full h-full object-cover"},null,8,Te)],10,Oe)]),_:1},8,["items"])])):_("",!0),e("div",Ue,[e("div",qe,[r[2]||(r[2]=e("span",{class:"font-semibold text-base"},"Times rented:",-1)),e("span",ze,c(t(s).times_rented||0),1)]),n($,{class:"bg-background border-base"},{default:p(()=>[r[3]||(r[3]=e("h3",{class:"font-semibold mb-3 text-base"},"Owner Information",-1)),e("div",Ne,[e("div",Ve,[e("div",Fe,[t(s).owner_profile_picture?(a(),i("img",{key:0,src:t(s).owner_profile_picture,alt:t(s).owner_username,class:"w-10 h-10 rounded-full object-cover"},null,8,Le)):(a(),i("div",Ge,[n(G,{name:"heroicons:user-solid",class:"w-7 h-7 text-muted"})]))]),e("div",null,[n(E,{to:`/users/${t(s).owner_user_id}`,class:"font-medium text-base px-1 py-1 hover:text-accent rounded-md hover:bg-surface-hover transition cursor-pointer"},{default:p(()=>[b(c(t(s).owner_username),1)]),_:1},8,["to"])])]),e("div",Ee,[e("span",He,c(t(s).owner_trust_score),1),e("span",{class:v(["text-xs px-2 py-1 rounded-full font-medium text-white",[t(y).color,t(y).text==="Poor"?"border border-white":""]])},c(t(y).text),3)])])]),_:1})])]),e("div",Me,[e("div",Se,[e("h1",We,c(t(s).title.length>130?t(s).title.substring(0,130)+"...":t(s).title),1),e("p",Ae,"by "+c(t(s).author),1),e("div",Je,[(a(!0),i(I,null,R(t(s).genres,(h,x)=>(a(),i("span",{key:x,class:"px-3 py-1 bg-surface border border-base rounded-full text-sm text-base"},c(h),1))),128)),e("span",Ke,c(t(s).condition),1),(a(!0),i(I,null,R(t(l),(h,x)=>(a(),i("span",{key:`avail-${x}`,class:v(["px-3 py-1 rounded-full text-sm font-medium",F(h.color)])},c(h.label),3))),128))]),e("div",Qe,[r[4]||(r[4]=e("h2",{class:"font-semibold text-lg mb-2 text-base"},"Description",-1)),e("p",Xe,c(t(s).description),1)])]),e("div",Ye,[n(pe,{availability:t(s).availability,"daily-rent-price":t(s).daily_rent_price,"security-deposit":t(s).security_deposit,"purchase-price":t(s).purchase_price,onRent:z,onPurchase:N},null,8,["availability","daily-rent-price","security-deposit","purchase-price"])])])])]),_:1})])):_("",!0)])}}});export{nt as default};
